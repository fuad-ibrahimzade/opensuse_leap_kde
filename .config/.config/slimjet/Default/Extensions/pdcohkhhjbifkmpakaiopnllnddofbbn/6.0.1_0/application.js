function load_auth_token(){var e=$('head meta[name="csrf-token"]').attr("content");e!=undefined&&CSRF_TOKEN!=e&&(CSRF_TOKEN=e)}function clean_temp_state(){try_call("hide_tooltip"),try_call("search_dropdown_hide"),try_call("noticeHide"),clean_edit_state(),$("#main").removeClass("editing")}function clean_edit_state(){try_call("newitem_cancel");var e=$("#main").find(".card.category-editing");0<e.length&&save_category_edit(undefined,e)}function block_app(e){var t=$("#app-loading").show();t.find(".loading-message").hide(),0==(e=t.find("#app-loading-message-"+e)).size()&&(e=t.find("#app-loading-message-default")),e.show()}function release_block(){$("#app-loading").hide().find(".loading-message").hide()}function redirect_location(e,t){e.match(HOST_HTTPS)||(e=HOST_HTTPS+e),"_blank"==t?window.open(e,"_blank"):document.location=e}function redirect_401(){redirect_location("/login")}function networkerror_status0(){if(navigator&&!navigator.onLine)show_flash_notice("Internet unreachable","error");else{var e=new Image;e.onerror=function(){show_flash_notice("Papaly temporarily unreachable please retry","error")},e.src=HOST_HTTPS+"/st/ping?from=ajaxstatus0&_="+(new Date).getTime()}}function int2hex(e){return("0"+parseInt(e).toString(16)).slice(-2)}function rgb2hex(e){return e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/)?int2hex((e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))[1])+int2hex(e[2])+int2hex(e[3]):e.match(/#(\d+)/)?(e=e.match(/#(\d+)/))[1]:"444444"}function flash_color(e,t,i,n,o,r){e.css("background-color",i),setTimeout(function(){e.css("background-color",t),0<n?setTimeout(function(){flash_color(e,t,i,n-1,o,r)},o):(r&&r(),e.css("background-color",""))},o)}function stop_default_and_propagation(e){stop_propagation(e),prevent_default(e)}function stop_propagation(e){e&&(e.stopPropagation?e.stopPropagation():window.event.cancelBubble=!0)}function prevent_default(e){e&&(e.preventDefault?e.preventDefault():window.event.returnValue=!1)}function register_ahref_listeners(){}function try_call(e){"function"==typeof window[e]&&window[e]()}function register_all_listeners(){console.info("Register all listener here"),register_main_ui_listeners(),register_tooltips(),try_call("register_ahref_listeners"),try_call("register_flash_notice_listeners"),"function"==typeof log_time&&log_time("register_all_listener finished"),try_call("remove_papaly_upgrade_overlays"),try_call("check_link_bar")}function run_all_delayed_jobs(){}function run_all_once_jobs(e,t){send_browser_information(t),try_call("register_tutorial_listeners"),window.register_rand_notice_listeners&&window.register_rand_notice_listeners(e)}function run_all_really_once_jobs(){register_dialog_listeners(),"speeddial"===$("#main").attr("board-state")&&select_speed_dial(null,!0);var e=document.location.hash.substring(1);if(e)for(var t=e.split("&"),i=0;i<t.length;i++){var n=t[i].split("=");handle_position(decodeURIComponent(n[0]),n[1]?decodeURIComponent(n[1]):undefined)}$(window).resize($.debounce(50,adjust_category_mask)),$(window).resize(adjust_shortcuts_size),$(window).on("focus",refresh_update_weather_duration),$(window).resize(adjust_speed_dial_styles),register_notifications_poller(),register_speed_dial_observer(),register_sync()}function handle_position(e,t){switch(e){case"explore":select_explore();break;case"speeddial":select_speed_dial();break;case"social_favorites":select_social_favorites();break;case"board_id":select_and_refresh_board(t);break;case"dialog":load_dialog(null,t);break;default:$('.nav-section-item[board-id="'+e+'"]').length&&select_and_refresh_board(e)}}function load_papaly_version(){var e=$('head meta[name="papaly-version-server"]').attr("content");e!=undefined&&e!=PAPALY_VERSION_SERVER&&(PAPALY_VERSION_SERVER=e)}function check_and_reload_papaly(e){var t=new XMLHttpRequest;t.open("GET","/api/version?_="+(new Date).getTime(),!0),t.onreadystatechange=function(){4==t.readyState&&(new_version=JSON.parse(t.responseText).data.papaly_version_server,new_version!=(e||PAPALY_VERSION_SERVER)&&reload_papaly(e))};try{t.send()}catch(i){return undefined}}function reload_papaly(){redirect_location("/")}function send_browser_information(e){var t=$("#param-container").find('[name="last_browser_info_at"]').attr("value");if(!(new Date-new Date(Date.parse(t))<864e5)){e==undefined&&(e={}),navigator&&(e.user_agent=navigator.userAgent);var i=(new Date).getTime();$.ajax({type:"GET",cache:!1,url:"/browser_info",data:e,success:function(){if(i){var e=(new Date).getTime()-i;ga("send","timing","roundtrip","roundtrip",e,"roundtrip")}$.ajax({type:"GET",cache:!1,url:"/roundtrip",data:{millis:(new Date).getTime()-i},success:function(){$("#param-container").find('[name="last_browser_info_at"]').attr("value",(new Date).toISOString())},error:function(){}})}})}}function print_callstack(){var e=(new Error).stack;console.log("PRINTING CALL STACK"),console.log(e)}function check_mobile(){if(GLOBAL_MOBILE!=undefined)return GLOBAL_MOBILE;var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),GLOBAL_MOBILE=t}function cleanup_drag_and_drop_temp_states(){$("#bookmark-list").find(".ui-sortable-helper").remove(),$(".tab-placeholder").remove(),$(".category-placeholder").remove(),$(".bookmark-placeholder").remove(),$("#inbox-section").find(".item-bookmark:hidden").show(),$(".board:visible").find(".card:hidden, .item-bookmark:hidden").show(),try_call("hide_tooltip"),try_call("hide_flash_notice"),try_call("hide_rand_notice")}function adjust_board_slot_height(e){var t=e.find(".category-slot");if(0!=t.children().length)for(var i=Math.floor(e.width()/t.first().width()),n=0;n<Math.ceil(t.size()/i);n++){var o=t.slice(n*i,(n+1)*i),r=o.map(function(e,t){return $(t).height()}),a=Math.max.apply(Math,r)+50,s=parseInt(t.closest(".cards-container").css("min-height")||532);a=Math.max(s,a),o.each(function(e,t){t.style.paddingBottom=a-$(t).height()+"px"})}}function logout(){console.log("logout called"),$.ajax({type:"GET",url:"/logout",success:function(e){redirect_location("/",e)},error:function(){redirect_location("/")}})}function click_item(n,e){n&&n.preventDefault();var t=$(n&&n.target);if(!(t.hasClass("edit-icon")||0<t.closest(".item-editing").length))if(e.closest("#main").hasClass("editing-on"))select_item(n);else{var o=check_setting_openin();o&&check_mobile()&&(o=!1),o&&$(n&&n.target).hasClass("open-all-icon")&&(o=!1),e.each(function(){var e=send_item_click(n,$(this)),t=$(this).attr("href")||$(this).attr("url"),i=o=o&&t.match(/http/);return i?(e.always(function(){open_url(t,i)}),!0):open_url(t,i)})}}function check_setting_openin(){return"true"==$("#param-container").find('[name="user[open_in_current_tab]"]').attr("value")}function open_url(e,t){if(t)return window.location.href=e,!0;try{return window.open(e).focus(),!0}catch(i){return load_dialog(null,"/dialog/popup_blocker_warning"),!1}}function send_item_click(e,t){var i=t.closest(".item-bookmark, .shortcut-module, .social-link-module"),n="unknown";$(e&&e.target).hasClass("open-all-icon")?n="open_all":0<i.closest("#master-search-dropdown").size()?(n="search",$("#master-search").val(""),try_call("search_dropdown_hide")):i.hasClass("shortcut-module")?n="shortcuts":i.hasClass("social-link-module")?n="social_favorites":0<i.closest(".board[board-id]").size()?n="followed"==i.closest(".board[board-id]").attr("board-status")?"followed":"board":0<i.closest("#inbox-section").size()?n="inbox":0<i.closest(".app-board").size()?n=i.closest(".app-board").attr("app-name"):i.closest("#favorite-categories").length&&(n="smart-categories"),ga("send","event","item","click",n);var o=i.attr("item-index"),r=i.index(),a=i.closest(".card").attr("category-type");return $.ajax({type:"GET",url:"/items/click",cache:!1,data:{from:n,index:o,position:r,category_type:a},timeout:300})}function gas(e){window.ga&&(ga_user_id||(ga_user_id=(ga_user_id=ga_user_id||$("#param-container").find('param[name="user-ga-id"]').attr("value"))||$("#right-section").attr("user-ga-id"))&&(ga("set","&uid",ga_user_id),ga("set","dimension1",ga_user_id)),e?ga("send","pageview","/"+e):ga("send","pageview"),$(".ab-test").each(function(){var i=$(this),e=i.find(".ab-test-goal");e.length?e.each(function(){var t=$(this);t.each(function(){var e=parse_count_with_separator(t.attr("impression-count"));e&&ga("send",{hitType:"event",eventCategory:"ab-test:"+i.attr("experiment"),eventAction:i.attr("choice"),eventLabel:t.attr("ga-label"),eventValue:e})})}):ga("send",{hitType:"event",eventCategory:"ab-test:"+i.attr("experiment"),eventAction:i.attr("choice"),eventLabel:i.attr("choice"),eventValue:1})}))}function parse_count(e){return e||0===e?+e||$(e).length:1}function parse_count_with_separator(e){return(e||"").split(";").reduce(function(e,t){return e+parse_count(t)},0)}function register_click_listeners(){document.addEventListener("click",function(e){var t=$("body").attr("ga-screen")||"ScreenOther",i=$(e.target).closest("[ga-label]").attr("ga-label")||e.target.className,n=$(e.target).closest("[id]").attr("id");ga("send","event",t,"click","(#"+n+", "+i+")")})}function DropDown(e){this.dropdown=e,this.initEvents()}function register_feature_vote_listeners(){$("#main").on("click",".load-feature-vote",load_feature_vote_dialog).on("click",'[feature-new!=""][feature-new]',send_feature_new_used),$("#float-container").on("click","#fv-suggest, #fv-done, #fv-mask",close_feature_vote_dialog).on("click","#fv-change",change_vote).on("click","#fv-yes, #fv-no",send_feature_vote_response)}function change_vote(){$("#fv-card").attr("like","")}function load_feature_vote_dialog(){var h=$(this),f=h.offset();if(!h.hasClass("fv-now")){var e=$(this).attr("feature-dialog");$.ajax({url:e,success:function(e){var t=$("#feature-vote").show(),i=$("#fv-card");h.addClass("fv-now");var n=h.attr("point-to");i.attr("point-to",n),$("#fv-message").html(e),i.attr("like",i.find(".fv-name").attr("like"));var o=f.left,r=f.top,a=h.outerWidth(),s=h.outerHeight(),l=i.outerWidth(),c=i.outerHeight();switch(n){case"left":i.css("left",o+a+32);break;case"bottom":i.css("left",o);break;default:i.css("left",o-l-32)}var d=0,u=document.all?iebody.scrollTop:pageYOffset;switch(n){case"left":case"right":r-48<(d=(t.outerHeight()-i.outerHeight())/3)&&(d=r-49),i.find("#fv-tip").attr("style","").css("top",r-d+s/2-12);break;default:d=r-c-32,i.find("#fv-tip").attr("style","")}(d-=u)<0&&(d=0),i.css("top",d)}})}}function close_feature_vote_dialog(){$("#feature-vote").hide(),$(".fv-now").removeClass("fv-now")}function send_feature_vote_response(){close_feature_vote_dialog(),noticeOK("Thanks you for the feedback");var e=$(this).closest("#fv-card").find(".fv-name").attr("fv-name"),t=0<$(this).filter("#fv-yes").size();$.ajax({url:"/features/vote",data:{name:e,vote:t},method:"GET"})}function send_feature_new_used(){var e=$(this).attr("feature-new");$(this).removeAttr("feature-new"),$.ajax({url:"/features/got_it",data:{feature_name:e},method:"GET"})}function reset_tooltip(){(TOOLTIP=$("#tooltip")).leave_t=0,TOOLTIP.wait_t=TOOLTIP_WAIT,TOOLTIP.count=0}function register_tooltips(){register_tooltip_items($("#main, #float-container, #dialog-container"))}function register_tooltip_items(e){reset_tooltip(),e.on({mouseenter:show_tooltip,mouseleave:hide_tooltip,mousedown:function(){TOOLTIP.hide(),TOOLTIP.is_clicked=!0,TOOLTIP.wait_t=TOOLTIP_WAIT}},".tooltip-enabled")}function show_tooltip(e,t){if(!navigator.userAgent.match(/(iPad|iPhone|iPod)/g)){var i=10;t==undefined&&(t=$(this));var n=t.attr("tooltip"),o=TOOLTIP.find("#tooltip-pointer");"true"==t.attr("tooltip-wrap")?TOOLTIP.css("white-space","normal"):TOOLTIP.css("white-space",""),TOOLTIP.find("#tooltip-text").html(n),TOOLTIP.css("visibility","hidden").show();var r=t[0].offsetWidth,a=t[0].offsetHeight,s=(m=$(t[0]).offset()).left,l=m.top,c=$(window).width()+$(window).scrollLeft()-5,d=$(window).height()+$(window).scrollTop()-5,u=TOOLTIP[0].offsetWidth,h=TOOLTIP[0].offsetHeight,f=0,p=0,m=t.attr("tooltip-position")||"top";switch(TOOLTIP.attr("position",m).css("left",0),m){case"pointer":f=s+29,p=l+a+5,o.css("left",-1e6).css("top",-1e6);break;case"top-left":f=s,p=l-h-i,o.css("left",10).css("top",h),c-3<f+u&&(f=c-u-3);break;case"top-right":f=s,p=l-h-i,o.css("left",u-25).css("top",h),c-3<f+u&&(f=c-u-3);break;case"bottom":f=s+(r-u)/2,p=l+a+i,o.css("left",u/2-5).css("top",-5);break;case"bottom-right":f=s+(r-u),p=l+a+i,o.css("left",r/2-5).css("top",-5);break;case"left":f=s-u-6,p=l+(a-h)/2,o.css("left",u).css("top",h/2-5);break;default:f=s+(r-u)/2,p=l-h-i,o.css("left",u/2-5).css("top",h),c-3<f+u&&(f=c-u-3)}TOOLTIP.enter_t=(new Date).getTime(),TOOLTIP.count+=1;var g=TOOLTIP.count;setTimeout(function(){g==TOOLTIP.count&&TOOLTIP.enter_t>TOOLTIP.leave_t&&"hidden"==TOOLTIP.css("visibility")&&1!=TOOLTIP.is_clicked&&(TOOLTIP.hide().css("visibility","visible").css("left",f).css("top",p).show(),c<u?TOOLTIP.css("left",0):c<f+u&&TOOLTIP.css("left",c-u),d<p+h&&TOOLTIP.css("top",d-h),TOOLTIP.wait_t=0)},TOOLTIP.wait_t)}}function hide_tooltip(){0!=TOOLTIP.is(":visible")&&(TOOLTIP.leave_t=(new Date).getTime(),TOOLTIP.stop(!0,!1).hide(),TOOLTIP.is_clicked=!1,setTimeout(function(){TOOLTIP.leave_t>TOOLTIP.enter_t&&(TOOLTIP.wait_t=TOOLTIP_WAIT)},1.5*TOOLTIP_WAIT))}function register_dialog_listeners(){$("body").on("click",".dialog-load-button:not(.disabled)",load_dialog)}function close_dialog(e){if(e&&e.preventDefault(),0!=$("#main").length&&($("#main").removeClass("blurred"),$("#dialog-container").remove(),dialog_tracking_millis)){var t=(new Date).getTime()-dialog_tracking_millis;dialog_tracking_millis=undefined,ga("send","timing","dialog","close",t,dialog_tracking_url)}}function load_dialog(e,t,i){e&&e.preventDefault();var n=$(this);(t=t||n.attr("dialog-url")||e&&$(e.target).attr("dialog-url"))&&(ga("send","event","dialog","load",t),dialog_tracking_millis=(new Date).getTime(),dialog_tracking_url=t,$.ajax({url:t,statusCode:{0:networkerror_status0,401:redirect_401},success:function(e){load_dialog_success(e,n),i&&i()}}))}function load_dialog_success(e,t){if($("#dialog-container").remove(),$("body").append(e),$("#dialog-container").find('input[type="text"]:first, input[type="email"]').select(),t)switch(t.attr("dialog-style")){case"balloon":break;default:$("#main").addClass("blurred")}else $("#main").addClass("blurred");if($("#dialog-container").on("click","#dialog-block, #dialog-close-button, .close-dialog, .dialog-button.cancel-button, #cancel-link, .cancel-action",close_dialog).on("keydown","",function(e){27==(e.keyCode||e.which)&&close_dialog(e)}),"function"==typeof register_tooltip_items&&register_tooltip_items($("#dialog-container")),dialog_tracking_millis){var i=(new Date).getTime()-dialog_tracking_millis;dialog_tracking_millis=(new Date).getTime(),ga("send","timing","dialog","load",i,dialog_tracking_url)}}function papaly_app_authentication_success(){console.log("Login successful")}function papaly_app_authentication_failure(){console.log("Login Failed")}function papaly_app_authentication(e,t,i,n){n=n||{};var o="";for(var r in n)n.hasOwnProperty(r)&&(o=o.length?o+"&"+r+"="+n[r]:"?"+r+"="+n[r]);if(e&&"email"!=e){PAPALY_APP_AUTHENTICATION_CALLBACK_SUCCESS=void 0!==t?t:papaly_app_authentication_success,PAPALY_APP_AUTHENTICATION_CALLBACK_FAILURE=void 0!==i?i:papaly_app_authentication_failure;var a="/auth/"+e+o;if(check_mobile())window.location.href=a;else{(PAPALY_APP_AUTHENTICATION_WINDOW=window.open(a,"Authenticating Papaly","location=no, menubar=no, status=no, toolbar=no, scrollbars=yes, resizable=yes")).resizeTo(600,800);var s=document.all?window.screenLeft:window.screenX,l=document.all?window.screenTop:window.screenY;PAPALY_APP_AUTHENTICATION_WINDOW.moveTo(s,l),PAPALY_APP_AUTHENTICATION_WINDOW.focus(),setTimeout(papaly_app_authentication_check,1e3)}}}function papaly_app_authentication_check(){if(PAPALY_APP_AUTHENTICATION_WINDOW!=undefined)if(PAPALY_APP_AUTHENTICATION_WINDOW.closed)PAPALY_APP_AUTHENTICATION_CALLBACK_FAILURE();else{try{if(PAPALY_APP_AUTHENTICATION_WINDOW.location.href.match(/authentication\/success/)){var e=PAPALY_APP_AUTHENTICATION_WINDOW.url.match(/not_user_account=true/);PAPALY_APP_AUTHENTICATION_CALLBACK_SUCCESS(null,e),PAPALY_APP_AUTHENTICATION_WINDOW.close(),PAPALY_APP_AUTHENTICATION_WINDOW=undefined}}catch(t){}setTimeout(papaly_app_authentication_check,1e3),console.log("Still no response, wait for another 1s")}}function papaly_app_authentication_through(){var e=window.opener;if(null!=e&&e!=window){var t=document.getElementById("papaly_app_authentication_result");if(t!=undefined){var i=t.getAttribute("redirect_to"),n=document.getElementById("not-user-account")!=undefined;e.PAPALY_APP_AUTHENTICATION_CALLBACK_SUCCESS(i,n),e.PAPALY_APP_AUTHENTICATION_WINDOW=undefined,window.close()}}else window.location.href="/"}function papaly_app_authentication_rejected(){opener=window.opener,null!=opener&&setTimeout(function(){opener.PAPALY_APP_AUTHENTICATION_CALLBACK_FAILURE(),opener.PAPALY_APP_AUTHENTICATION_WINDOW=undefined,window.close()},2e3)}function papaly_app_authentication_complete(e,t,i,n){try{var o=(i||window).document.location.href,r=HOST_HTTPS+"/authentications/complete?provider="+e+"&result="+t+"&url="+encodeURIComponent(o),a=new XMLHttpRequest;a.timeout=200,a.ontimeout=n,a.onreadystatechange=function(){4==a.readyState&&n&&n()},a.open("GET",r,!0),a.send(null)}catch(s){n&&n()}}function display_not_user_account(){load_dialog(null,"dialog/existing_account_warning")}function register_shared_search_listeners(){$("#main").on("keydown","#master-search",search_keydown).on("click","#mobile-search-button",mobile_search_on).on("click","#mobile-search-close",mobile_search_off),$(".button-item[type=submit]").click(function(e){$("#master-search");var t=$("#master-search").val(),i=$("#master-search-dropdown").find(".hl-search");if(0<t.length)if(0===i.length){var n=$(this).attr("url").replace("__KEYWORD__",t);record_search($(this).attr("value")),$("#master-search-container").attr("action",n).submit()}else $("#master-search-container").attr("action",i.attr("url")),click_item(e,i);else prevent_default(e)})}function search_keydown(e){switch(e.keyCode||e.which){case 38:case 40:prevent_default(e);break;case 37:case 39:0<$("#master-search-dropdown").find(".master-search-section.selected").length&&prevent_default(e);break;case 13:var t=$("#master-search-dropdown").find(".item-bookmark.hl-search, .shortcut-module.hl-search");t.length?click_item(e,t):$("#master-search").val().length<2&&prevent_default(e)}}function record_search(e){$("#master-search").data("enter_pressed",!0);var t=$("#master-search").val().trim();ga("send","event","search",e,t),$.ajax({type:"GET",cache:!1,url:"/items/search",data:{search_option:e,keyword:t}})}function mobile_search_on(){$("#global-header").attr("mobile-search","on").find("#master-search").focus()}function mobile_search_off(){$("#global-header").attr("mobile-search",""),try_call("search_dropdown_hide")}function register_master_search_listeners(){$("#main").on("keyup","#master-search",search_keyup).on("click",".load-results-button",load_extra_sections).on("click",".social-toggle-container .switch-container",enable_social_fav).on("click","#master-search",function(){$("#main").removeClass("editing-on"),$(this).select(),"true"==$("#param-container").find('[name="user[open_in_current_tab]"]').attr("value")?$(this).closest("form").removeAttr("target"):$(this).closest("form").attr("target","_blank")}).on("click","#sidebar-mask, #main-content, #dropdown-mask, .item-bookmark, .shortcut-module",search_dropdown_hide),$("#master-search").on("focus",function(){refresh_internal_search()}),$("#mobile-search-icon").click(reveal_search),$("#mobile-close-search").click(hide_search),$&&$.fn&&$.fn.register_item_listeners&&$("#master-search-dropdown").find("#bookmark-list").find(".item-bookmark").register_item_listeners(),$(".card-list").masonry({itemSelector:".card",transitionDuration:0}),0<$("#connected-accounts-list").length&&($("#connected-accounts-list").find(".bookmark-list").masonry({itemSelector:".social-link-module-masonry",transitionDuration:0,gutter:12}),$("#tab-search-social-feeds").masonry({itemSelector:".social-link-module-masonry",transitionDuration:0,gutter:12})),0<$("#categories-tab-content").length&&$("#categories-tab-content").masonry({itemSelector:".card",transitionDuration:0,gutter:12}),window.select_and_refresh_board&&$("#categories-list").on("click",".title-description-container",function(){var e=$(this).closest(".card").attr("category-index"),t=$("#boards-container .card").filter("[category-index="+e+"]").closest(".board").attr("board-id");search_dropdown_hide(),select_and_refresh_board(t)})}function load_extra_sections(){function e(){if(!--n)for(var e;e=i.shift();)e()}var t=$(this).closest("#load-extra"),i=[],n=0;t.attr("boards-following-status")||(t.attr("boards-following-status","loading"),n++,i.push(function(){t.attr("boards-following-status","loaded"),$("#boards-following-list").show()}),load_followed_boards(null,function o(){e()},function r(){t.removeAttr("boards-following-status"),e()})),t.attr("connected-accounts-status")||(t.attr("connected-accounts-status","loading"),n+=$("#connect-more-accounts").hide().find(".social-toggle-container").length,i.push(function(){$("#connect-more-accounts").show(),t.attr("connected-accounts-status","loaded")}),request_social_favorites(function o(e){var t=e.attr("id").replace("social-account-toggle-","");$("#connect-more-accounts").find("#"+t+"-toggle").attr("current-state","on")},function r(){},function a(){},function s(){e()})),i.push(function(){refresh_internal_search($("#master-search").val())})}function enable_social_fav(){var e=$(this).closest(".social-toggle-container");connect_account(e.find(".social-connect").attr("provider"),function t(){},function i(){$('#main[board-state="social"]').length&&request_social_favorites(),e.attr("current-state","on"),refresh_internal_search($("#master-search").val())},function n(){show_flash_notice("Error connecting to your account","error")})}function search_keyup(e){var t=e.keyCode||e.which,i=$("#master-search-dropdown");switch(t){case 13:$("#master-search").data("enter_pressed",!1);break;case 37:i.is(":visible")&&search_move_highlight_horizontal(-1);break;case 39:i.is(":visible")&&search_move_highlight_horizontal(1);break;case 38:i.is(":visible")?search_move_highlight_vertical(-1):refresh_internal_search();break;case 40:i.is(":visible")?search_move_highlight_vertical(1):refresh_internal_search();break;case 27:clean_temp_state(),search_dropdown_hide(e),clean_search_candidates(),$(e.target).select();break;default:refresh_internal_search($(this).val().trim(),$(this))}}function unique_set(e,t){items_unique={};for(var i=0;i<e.size();i++){var n=t(e[i]);null!=n&&(n=n.replace(/^https?:\/\//,"").replace(/\/$/,""),items_unique[n]?items_unique[n].frequency+=+e[i].getAttribute("frequency"):(items_unique[n]=e[i],items_unique[n].frequency=+e[i].getAttribute("frequency")))}return items_unique}function refresh_internal_search(e,t){e==undefined&&(e=$("#master-search").val().trim()),e!=undefined&&1<e.length?(search_dropdown_show(t),$("#meta-search-keyword").text(e)):search_dropdown_hide(undefined,t),e!=undefined&&refresh_search_candidates(e,$("#left-section"))}function refresh_global_search(e){refresh_search_candidates(e,$("#my-links-tab-content"))}function frequency_func(e,t){var i=e.frequency||+e.getAttribute("frequency");return(t.frequency||+t.getAttribute("frequency"))-i}function refresh_search_candidates(e,t){if(t&&t.length){var i=12;t.find(".selected").removeClass("selected");var n=t.find("#saved-links-list .bookmark-list, #favorites-search-item-list"),o=t.find("#boards-following-list").find(".bookmark-list"),r=t.find("#connected-accounts-list .bookmark-list"),a=t.find("#speeddial-shortcuts-list").hide().find(".bookmark-list"),s=t.find("#categories-list").hide().find(".card-list");if(1<e.length){var l=e.split(/\s+/);if(0==l.length)return;var c=$(".board[own-board='true'], #link-bar").find(".item-bookmark");$(".board[own-board]").length||(c=$(".item-bookmark"));var d=$(".board[own-board='false'] .item-bookmark"),u=$("#social-favorites").find(".social-link-module"),h=$("#speed-dial-section").find(".shortcut-module"),f=$('.board[own-board="true"]').find(".card");d.each(function(){this.frequency=0}),u.each(function(){this.frequency=0}),h.each(function(){this.frequency=0}),f.each(function(){this.name_match=!0,this.item_match=!0,this.full_match=!0});for(var p=function(){return $(this).filter(":contains('"+l[m].toString()+"')").length},m=0;m<l.length;m++)c=c.filter(p),d=d.filter(p),u=u.filter(p),h=h.filter(p),f=f.filter(function(){return this.name_match=this.name_match&&0<$(this).find(".card-title").filter(":contains('"+l[m].toString()+"')").length,this.item_match=this.item_match&&0<$(this).find(".item-name").filter(":contains('"+l[m].toString()+"')").length,this.full_match=this.full_match&&0<$(this).find(".item-bookmark").find(".keywords").filter(":contains('"+l[m].toString()+"')").length,this.name_match||this.item_match||this.full_match});if(own_items_unique=unique_set(c,function(e){return $(e).find("a").attr("href")}),following_items_unique=unique_set(d,function(e){return $(e).find("a").attr("href")}),social_items_unique=unique_set(u,function(e){return $(e).find("a").attr("href")}),speeddial_items_unique=unique_set(h,function(e){return $(e).find("a").attr("href")}),$(Object.keys(speeddial_items_unique)).each(function(e,t){delete own_items_unique[t]}),c=$(Object.keys(own_items_unique)).map(function(e,t){return own_items_unique[t]}),d=$(Object.keys(following_items_unique)).map(function(e,t){return following_items_unique[t]}),u=$(Object.keys(social_items_unique)).map(function(e,t){return social_items_unique[t]}),h=$(Object.keys(speeddial_items_unique)).map(function(e,t){return speeddial_items_unique[t]}),c.sort(frequency_func),h.sort(frequency_func),f.sort(function(e,t){return t.name_match-e.name_match||t.item_match-e.item_match||t.full_match-e.full_match||+t.getAttribute("frequency")-+e.getAttribute("frequency")}),prepare_search_results(c,n,i,l),c.length<i&&search_more_items_on_server(l,t,i),prepare_search_results(d,o,i,l),prepare_search_results(h,a,i,l),prepare_search_results(f,s,i,l),r.length)if(r.empty(),u.length){for(m=0;m<u.length;m++){var g=$(u[m]);if(r.find("li").length<i){var _=g.clone(),v=_.find(".social-link-text"),b=_.find(".social-link-url"),y=_.find(".social-link-title");y.css("font-weight","normal");var w=new RegExp("("+l.join("|")+")","ig");v.html(v.text().replace(w,"<b>$1</b>")),b.html(b.text().replace(w,"<b>$1</b>")),y.html(y.text().replace(w,"<b>$1</b>")),_.appendTo(r)}}r.show(),$("#connected-accounts-list").show().find(".bookmark-list").masonry("reloadItems").masonry("layout"),$("#tab-search-social-feeds").masonry("reloadItems").masonry("layout"),$("#connect-more-accounts").hide()}else $("#connect-more-accounts").show();hide_empty_search_lists(t)}else n.empty(),o.empty(),r.empty(),a.empty(),s.empty();$(".card-list").masonry("reloadItems").masonry("layout")}}function hide_empty_search_lists(e){var t=e.find("#saved-links-list").find(".bookmark-list"),i=e.find("#boards-following-list").find(".bookmark-list"),n=e.find("#connected-accounts-list").find(".bookmark-list"),o=e.find("#speeddial-shortcuts-list").find(".bookmark-list"),r=e.find("#categories-list").find(".card-list"),a=t.children().length,s=i.children().length,l=n.children().length,c=o.children().length,d=r.children().length;0==c?$("#speeddial-shortcuts-list").addClass("no-results").appendTo("#master-search-dropdown"):$("#speeddial-shortcuts-list").removeClass("no-results").prependTo("#master-search-dropdown").show(),a?c?$("#saved-links-list").removeClass("no-results").insertAfter("#speeddial-shortcuts-list"):$("#saved-links-list").removeClass("no-results").prependTo("#master-search-dropdown"):$("#saved-links-list").addClass("no-results").appendTo("#master-search-dropdown"),d?($("#categories-list").removeClass("no-results").insertAfter("#saved-links-list").show(),0==a&&$("#categories-list").prependTo("#master-search-dropdown")):$("#categories-list").addClass("no-results").appendTo("#master-search-dropdown"),c&&0==a?$("#speeddial-shortcuts-list").addClass("border-margin"):$("#speeddial-shortcuts-list").removeClass("border-margin"),s?$("#boards-following-list").removeClass("no-results"):$("#boards-following-list").addClass("no-results").insertAfter("#connected-accounts-list"),l||$("#connect-more-accounts").find('.social-toggle-container[current-state="off"]').length?$("#connected-accounts-list").removeClass("no-results"):$("#connected-accounts-list").addClass("no-results").appendTo("#master-search-dropdown")}function prepare_search_results(e,t,i,n){t.empty();for(var o=0;o<Math.min(e.length,i);o++){var r=$(e[o]),a=r.clone().show().removeClass("ui-sortable-handle").addClass("tooltip-enabled");a.hasClass("card")&&a.find(".item-bookmark").show().end().find(".show-excess-links-button, .hide-excess-links-button").hide();var s=r.closest(".board").attr("board-name"),l=r.parents(".card").attr("category-name");s&&l?a.attr("tooltip","<b>"+s+" > "+l+"</b>"):s?a.attr("tooltip","<b>"+s+"</b>"):a.hasClass("shortcut-module")?a.attr("tooltip","<b>"+a.find(".shortcut-name").text().trim()+"</b>"):a.attr("tooltip","<b>Inbox</b>");var c=a.find(".card-title");c.length||(c=a.find(".item-name"));var d=new RegExp("("+n.join("|")+")","ig");c.html(c.text().replace(d,"<b>$1</b>")),a.appendTo(t),$&&$.fn&&$.fn.register_item_listeners&&a.find(".item-bookmark, .shortcut-module, .social-link-module").add(a.filter(".item-bookmark, .shortcut-module, .social-link-module")).register_item_listeners()}t.find(".edit-icon").on("click",function(e){e.stopPropagation(),load_dialog(null,$(this).attr("dialog-url"))})}function clean_search_candidates(){$("#bookmark-list").find(".item-bookmark").remove()}function search_dropdown_show(){$("#main").addClass("internal-search");var e=$("#social-favorites");e.length&&($("#connected-accounts-list").show(),$("#load-extra").attr("connected-accounts-status","loaded"),e.find("#social-accounts-toggles .social-account-toggle").each(function(){var e=$(this).attr("id").replace("social-account-toggle-","");$(this).hasClass("not-connected")?$("#connect-more-accounts").find("#"+e+"-toggle").attr("current-state","off"):$("#connect-more-accounts").find("#"+e+"-toggle").attr("current-state","on")}))}function search_dropdown_hide(){$("#main").hasClass("internal-search")&&($("#main").removeClass("internal-search"),$("#social-links-container:visible").length&&$("#social-links-container").masonry("layout"))}function search_switch_section(e,t){var i=(t=t||$("#speeddial-shortcuts-list, #saved-links-list").not(".no-results")).filter(".selected").removeClass("selected").first();i.find(".hl-search").removeClass("hl-search");var n=t.not(i).first();n.length||(n=t.first());var o=n.addClass("selected").find(".item-bookmark, .shortcut-module");if(
o.length)if(0<=e)switch_search_engine(o.first().addClass("hl-search"));else{var r=n[0].getBoundingClientRect().width,a=o[0].getBoundingClientRect().width,s=Math.floor(r/a),l=Math.floor((o.length-1)/s)*s;switch_search_engine(o.eq(l).addClass("hl-search"))}}function search_move_highlight_horizontal(e,t){var i=(t||$(".hl-search").closest(".master-search-section")||$("#master-search-dropdown")).find(".hl-search").removeClass("hl-search"),n=i.index()+e,o=i.parent().children();n<0?n=-1:n>=o.length&&(n=0),switch_search_engine(o.eq(n).addClass("hl-search"))}function search_move_highlight_vertical(e,t){var i=t||$(".hl-search").closest(".master-search-section")||$("#master-search-dropdown"),n=i.find(".hl-search").removeClass("hl-search");if(n.length){var o=i[0].getBoundingClientRect().width,r=i.find(".shortcut-module, .item-bookmark")[0].getBoundingClientRect().width||o;e*=Math.floor(o/r);var a=n.index()+e,s=n.parent().children();a<0?search_switch_section(-1,t):a>=s.length?search_switch_section(1,t):switch_search_engine(s.eq(a).addClass("hl-search"))}else search_switch_section(0<e?1:-1,t)}function switch_search_engine(e){var t=$("form#master-search-container").attr("url");if(e&&e.length){var i=e.scrollParent();i[0]==document&&(i=$("body"));var n=i.outerHeight(),o=i.scrollTop(),r=o+n,a=e.outerHeight(),s=e.offset().top-i.offset().top+o,l=s+a,c=.7;if(s<o+c*a?e.index()?i.scrollTop(s-c*a):i.scrollTop(s-2*c*a):r-c*a<l&&i.scrollTop(l-n+c*a),t=e.attr("url"),!document.location.protocol.match(/chrome/)){var d=e.attr("class");d.match("item-bookmark")?t="/items/click?from=search&url="+t:"board-search-button"==d&&(t=t.replace(/https?:/,""))}}switch_form_action(t)}function switch_form_action(e){var t=$("form#master-search-container"),i=e||t.attr("url");t.attr("action",i)}function switch_input_text_name(e){var t=$("#master-search");t.attr("name");t.attr("name",e)}function get_querystring_from_url(e){var t="",i=/\?(.*)/;if(e.match(i)){var n=/(.*)#/;(t=i.exec(e)[1]).match(n)&&(t=n.exec(t)[1])}return t}function add_hidden_field_parameters(e){if(e&&""!=e){for(var t=get_querystring_from_url(e).split("&"),i=[],n=0;n<t.length;n++){var o=t[n].split("=");i[n]=[o[0],o[1]]}add_hidden_fields_to_form(i)}}function add_hidden_fields_to_form(e){for(var t=$("#master-search-container").find("#master-search"),i=e.length-1;0<=i;i--){var n='<input type="hidden" name="'+e[i][0]+'" value="'+e[i][1]+'" />';t.after(n)}}function remove_hidden_fields_from_form(){var e=$("#master-search-container").find("[type='hidden']");e&&e.remove()}function search_more_items_on_server(e,i,n){var o=i.find("#saved-links-list .bookmark-list, #favorites-search-item-list");e&&e.length&&$.ajax({url:"/items/search",data:{q:e,no_link_bar:!0},success:function(e){var t=$(e).filter(".item-bookmark");o.length&&(t.each(function(){var e=$(this);return o.find('a[href="'+e.find("a").attr("href")+'"]').length||(o.append(e),e.register_item_listeners()),o.find(".item-bookmark").length<n}),hide_empty_search_lists(i))}})}function register_speed_dial_listeners(){$("#main").on("click","#favorite-categories .overflow-menu .open-all-icon",category_open_all).on("click",".shortcut-new .close",remove_shortcut_module).on("change keyup paste",".shortcut-new input",show_shortcut_new_instruction).on("click",".shortcut-expand-collection",expand_collection).on("click","#speed-dial-settings-icon",toggle_background_selection).on("click","#speed-dial-settings .image-thumb",select_speed_dial_bg).on("click",speeddial_outside_click).on("click","#add-favorite-category",add_favorite_category).on("click","#favorite-categories .overflow-icon",toggle_favorite_category_menu).on("click","#favorite-categories .remove",remove_favorite_category).on("click","#add-category-template #cancel-button",add_category_cancel).on("click",".dropdowns-container .dropdown-label-selection",toggle_favorites_dropdown).on("click","#add-category-template #add-button",add_own_favorite_category).on("keyup","#add-link-template input",search_keyup).on("click","#add-category-template #cancel-button",add_category_cancel).on("mouseleave",".card",hide_favorite_category_overflow).on("scroll",update_weather_dropdown_top_position).on("click",".pin-link-button, .freeze-link-button",freeze_link).on("click",".unpin-link-button, .unfreeze-link-button",unfreeze_link).on("click","#favorite-category-list .pin-category-button, .freeze-category-button",freeze_category).on("click",".unpin-category-button, .unfreeze-category-button, .unpin-category-icon, .unfreeze-category-icon",unfreeze_category),$("#time-weather-module, #global-header, #speed-dial-background-selection").on("click",".fahrenheit, .celsius",toggle_temp_type).on("click",".weather-location-city, .change-location",change_weather_location).on("click",".save-button, .city-name",save_weather_location).on("click","#weather-info-wrapper",change_weather_location_topbar).on("click",".toggle-switch",toggle_speed_dial_layout),register_shortcut_sortable(),$("#speed-dial-section").find(".shortcut-module").register_item_listeners(),$(".shortcut-collections-expanded").find(".edit-icon").click(edit_expanded_collection),$(".shortcut-collections-expanded").find(".done-editing").click(done_editing_expanded_collection),$(".shortcut-collections-expanded").on("click",".remove-icon",delete_from_collection),register_favorite_category_listeners()}function select_corresponding_board(){var e=$(this).closest(".card").attr("category-index");select_and_refresh_board($("#boards-container").find(".card").filter("[category-index="+e+"]").closest(".board").attr("board-id"))}function register_favorite_category_listeners(){$("#favorite-category-list").on("click",".title-description-container, .excess-amount",function(e){$("#main").hasClass("drag-initiated-card")||e&&0<$(e.target).closest(".add-item-controls, .overflow-menu").length||select_corresponding_board.call(this)}),$("#favorite-category-list").register_favorite_category_sortable(),$("#favorite-category-list").find(".item-bookmark").register_item_listeners(),new DropDown($("#dropdown-menu-boards")).choiceMade=function(e){refresh_categories_dropdown(e.attr("board-id")),$("#add-button").addClass("inactive-button")},new DropDown($("#dropdown-menu-categories")).choiceMade=function(){$("#add-button").removeClass("inactive-button")}}function speeddial_outside_click(e){hide_add_favorite_category(e),hide_favorite_category_overflow(e),hide_speed_dial_bg_settings(e)}function freeze_link(){var e=$(this).closest(".item-bookmark");$.ajax({type:"POST",url:"/items/freeze",data:{item_id:e.attr("item-index")},success:function(){e.addClass("frozen pinned")},error:function(){show_flash_notice("Unable to freeze Link","error")}})}function unfreeze_link(){var e=$(this).closest(".item-bookmark");$.ajax({type:"DELETE",url:"/items/freeze",data:{item_id:e.attr("item-index")},success:function(){e.removeClass("frozen pinned")},error:function(){show_flash_notice("Unable to unfreeze Link","error")}})}function freeze_category(){var e=$(this).closest(".card");$.ajax({type:"POST",url:"/categories/freeze",data:{category_id:e.attr("category-index")},success:function(){e.addClass("frozen pinned")},error:function(){show_flash_notice("Unable to freeze Category","error")}})}function unfreeze_category(){var e=$(this).closest(".card");$.ajax({type:"DELETE",url:"/categories/freeze",data:{category_id:e.attr("category-index")},success:function(){e.removeClass("frozen pinned")},error:function(){show_flash_notice("Unable to unfreeze Category","error")}})}function toggle_temp_type(){var e=$(".weather-container");if(!$(this).hasClass(e.attr("temperature-scale"))){var t=$(this).hasClass("celsius")?"celsius":"fahrenheit",i=e.find(".weather-temperature").attr("fahrenheit-value");"fahrenheit"==t?e.find(".weather-temperature").text(Math.round(i)):e.find(".weather-temperature").text(fahrenheit_to_celsius(i)),e.attr("temperature-scale",t),$("."+t).addClass("current").siblings().removeClass("current"),$.ajax({type:"PUT",url:"/users",data:{"user[temperature_scale]":t},success:function(){ga("send","event","weather","toggle_temp","success")},error:function(){ga("send","event","weather","toggle_temp","error")}})}}function change_weather_location(){$(this).closest("#time-weather-module").addClass("editing-location");var e=$(".weather-location").text();$(".location-section").find("input").val(e).focus()}function change_weather_location_topbar(){$(this).closest(".weather-container").addClass("editing-location");var e=$(".weather-location").text();$(".location-section").find("input").val(e).focus()}function save_weather_location(){$(this).closest("#time-weather-module").removeClass("editing-location"),$(this).closest(".weather-container").removeClass("editing-location")}function toggle_speed_dial_layout(){var e=$(this),t=e.closest(".switch-container").attr("toggle-name"),i="on"!=e.attr("current-state"),n=i?"on":"off";e.attr("current-state",n),$("#main").attr(t.replace(/_/g,"-"),i?"":"hidden"),adjust_speed_dial_styles();var o={};o["user["+t+"]"]="on"==n,$.ajax({type:"PUT",url:"/users",data:o,statusCode:{0:networkerror_status0,401:redirect_401},success:function(){ga("send","event","speed_dial","toggle_layout","success")},error:function(){ga("send","event","speed_dial","toggle_layout","error")}})}function refresh_boards_dropdown(){var e=$("#your-boards-sortable-container").find(".nav-section-item");refresh_favorite_category_template();var n=$("#dropdown-menu-boards").find(".dropdown-list");e.each(function(){var e=$(this).attr("name"),t=$(this).attr("board-id");if(0<$("#boards-container").find(".board[board-id="+t+"]").find('.card[pinned="false"]').length){var i=$('<li class="theme-border-color"><div board-id="'+t+'" board-name="'+e+'" class="nav-section-item">'+e+"</div></li>");n.append(i)}})}function refresh_categories_dropdown(e){var t=$("#boards-container").find(".board[board-id="+e+"]").find('.card[pinned="false"]'),i=$("#add-category-template"),n=i.find("#dropdown-menu-categories"),o=n.find(".dropdown-list"),r=n.find(".dropdown-label-selection");r.text(r.attr("init-text")),i.find("#add-button").addClass("inactive-button"),o.children("li").remove(),t.each(function(){var e=$(this).attr("category-name"),t=$(this).attr("category-index"),i=$('<li class="theme-border-color"><div category-index="'+t+'" category-name="'+e+'" class="nav-section-item">'+e+"</div></li>");o.append(i)})}function refresh_favorite_category_template(){var e=$("#add-category-template");e.find(".dropdown-list").children("li").remove(),e.find("#add-button").addClass("inactive-button");var t=$("#dropdown-menu-boards").find(".dropdown-label-selection"),i=$('<div class="nav-section-item">').text(t.attr("init-text"));t.children().replaceWith(i);var n=$("#dropdown-menu-categories").find(".dropdown-label-selection"),o=$('<div class="nav-section-item">').text(n.attr("init-text"));n.children().replaceWith(o)}function add_own_favorite_category(){if(!$(this).hasClass("inactive-button")){var e=$("#dropdown-menu-categories").find(".dropdown-label-selection").children().attr("category-index");if(e)$("#favorite-categories").removeClass("add-mode add-mode-manual"),request_favorite_category(e)}}function auto_collapse_side_bar(){"true"!=$("#main").attr("auto-collapse")&&($("#main").attr("auto-collapse","true"),$("#main").attr("sidebar-state","collapsed"))}function hide_add_favorite_category(e){var t=$("#favorite-categories");if(t.hasClass("add-mode-manual")){if(e&&$(e.target).closest("#add-category-template, #add-favorite-category").length)return;t.removeClass("add-mode add-mode-manual"),$(".dropdown-menu").removeClass("active")}}function hide_favorite_category_overflow(e){e&&0<$(e.target).closest(".overflow-icon").length||$("#favorite-categories").find(".overflow-menu").hide()}function hide_speed_dial_bg_settings(e){e&&0<$(e.target).closest("#speed-dial-settings").length||$("#speed-dial-settings").attr("setting-state","")}function remove_favorite_category(n){n&&!$(n).is(".card")&&(n=$(this).closest(".card")),$.ajax({type:"DELETE",url:"/categories/favorite",data:{category_id:n.attr("category-index")},success:function(e){n.remove();var t=$(e);if(t.filter(".card").length){var i=$("#favorite-category-list");t.find(".item-bookmark").register_item_listeners(),i.append(t),load_feeds(t.filter('[category-type!="category"]'))}show_flash_notice("Category Unfavorited","ok")},error:function(){show_flash_notice("Unable to remove Category","error")}})}function toggle_favorites_dropdown(e){e.stopPropagation();var t=$(this).closest(".dropdown-menu");"dropdown-menu-boards"==t.attr("id")?(t.toggleClass("active"),$("#dropdown-menu-categories").removeClass("active")):"dropdown-menu-categories"==t.attr("id")&&(t.toggleClass("active"),$("#dropdown-menu-boards").removeClass("active"))}function toggle_favorite_category_menu(){$(this).closest(".card").find(".overflow-menu").toggle()}function add_category_cancel(){$("#favorite-categories").removeClass("add-mode add-mode-manual")}function request_favorite_category(e){$.ajax({type:"POST",url:"/categories/favorite",data:{category_id:e},success:function(e){var t=$(e);0==t.filter(".card").length?0<e.length&&show_flash_notice(e,"ok"):(container=$("#favorite-category-list"),container.append(t),t.find(".item-bookmark").register_item_listeners(),load_feeds(t.filter('[category-type!="category"]')))}})}function add_favorite_category(){$(this).closest("#favorite-categories").addClass("add-mode add-mode-manual"),refresh_boards_dropdown()}function select_speed_dial_bg(){if(!$(this).hasClass("selected")){var e=$("#main");$(this).closest("#speed-dial-background-selection").find(".image-thumb").removeClass("selected"),$(this).addClass("selected");var t=$(this).attr("image-name");$.ajax({type:"PUT",url:"/users",data:{"user[speed_dial_photo_name]":t},success:function(){e.attr("speed-dial-bg",t),show_flash_notice("Speed Dial background image updated","ok"),$("#speed-dial-settings").removeAttr("setting-state")},error:function(){show_flash_notice("Error updating background image","error")}})}}function toggle_background_selection(){var e=$(this).closest("#speed-dial-settings");"background-selection"==e.attr("setting-state")?e.attr("setting-state",""):e.attr("setting-state","background-selection")}function select_speed_dial(e,t){if(refresh_sync_timeout(),document.location.hash="speeddial",document.title="Papaly | Speed Dial",gas("speeddial"),"speeddial"!=$("#main").attr("board-state")||t){$("#main").attr("board-state","speeddial"),reset_inbox_size("speeddial"),$("#speed-dial-section").attr("status",""),adjust_shortcuts_size(),$("#link-bar").removeClass("mini-link-bar"),clean_editing_state(),$(".nav-item-selected").removeClass("nav-item-selected"),(e?$(this):$("#nav-speed-dial")).addClass("nav-item-selected"),$("#speed-dial-section").attr("status","speeddial");var i=$("#speed-dial-container");auto_collapse_side_bar(),$.ajax({type:"GET",url:"/apps/speed_dial",data:{version:version},statusCode:{0:function(){version||networkerror_status0()},401:redirect_401},success:function(e){if(e){var t=$(e);version=t.attr("speed-dial-version"),i.children("#favorite-categories").length?i.children("#favorite-categories").replaceWith(t.filter("#favorite-categories")):i.append(t.filter("#favorite-categories")),register_favorite_category_listeners(),load_all_feeds(i),$(".board").hide(),check_link_bar()}}})}}function remove_shortcut_module(){$(this).closest(".shortcut-new").remove()}function show_shortcut_new_instruction(e){if(13==e.which){var i=$(this).closest(".shortcut-new");if("1"==i.attr("shortcut-step"))i.attr("shortcut-step","2"),i.find("input.shortcut-title").select();else{var t=i.find("input.shortcut-url").val(),n=i.find("input.shortcut-title").val(),o=$("#speed-dial-section").attr("category-index");$.ajax({type:"POST",url:"/items",data:{"item[category_index]":o,"item[name]":n,"item[url]":t,style:"shortcut",from:"shortcut"},statusCode:{0:networkerror_status0,401:redirect_401},success:function(e){var t=$(e);t.addClass("ui-sortable-handle"),t.insertBefore(i),t.register_item_listeners(),i.remove(),noticeOK("link created")},error:function(){noticeERR("error when creating item")}})}}}function edit_expanded_collection(){var e=$(this).closest(".shortcut-collections-expanded");e.attr("status","editing").find("input").select(),e.find(".shortcut-module").append('<div class="remove-icon"></div>')}function done_editing_expanded_collection(){$(this).closest(".shortcut-collections-expanded").attr("status",""),$(".shortcut-collections-expanded").find(".remove-icon").remove(),$(".shortcut-collections-expanded").find(".shortcut-icon").unwrap()}function delete_from_collection(){$(this).closest(".shortcut-module").remove()}function expand_collection(){var e=$(this).find(".shortcut-collection-title").text(),t=$(this).closest(".shortcut-collection").find(".shortcut-icons-collection").clone().removeClass("shortcut-icon");t.find(".edit-icon").remove(),$(".shortcut-collections-expanded").find(".dialog-label").append(e).end().find(".shortcut-collections").append(t),$(".shortcut-collections-expanded").addClass("visible"),$(".block-page").show()}function register_shortcut_sortable(){$("#speed-dial-section").find("ul").sortable({items:".shortcut-module",distance:10,zIndex:2e3,revert:100,placeholder:"bookmark-placeholder",connectWith:".item-container",tolerance:"pointer",helper:"clone",start:function(){$("#main").addClass("drag-initiated-shortcut"),$("#main").addClass("disable-your-boards"),$("#global-header").addClass("show-delete-dropbox")},over:function(e,t){t.placeholder.css("min-width",""),t.helper&&t.helper.addClass("transparent-item")},out:function(e,t){t.helper&&t.helper.removeClass("transparent-item")},stop:function(e,t){$("#main").removeClass("drag-initiated-shortcut"),$("#main").removeClass("disable-your-boards"),$("#global-header").removeClass("show-delete-dropbox"),t.item.css("display","")},update:function(e,t){if($(this)[0]===t.item.parent()[0]){var i=t.item,n=[i.attr("item-index")],o=0<i.filter(".item-bookmark").length,r={to_category:$("#speed-dial-section").attr("category-index"),to_position:i.index()};if(o){$("#main").hasClass("editing-on")&&(n=(i=$(".item-bookmark.selected")).map(function(e,t){return t.getAttribute("item-index")}).toArray(),$(".card.selected").removeClass("selected"));var a=i.siblings(".create-shortcut");0===a.index()&&a.before(i),i.hide();var s=$('<li class="shortcut-module" style="width: 50px; height: 50px;"></li>');i.first().after(s),i.detach(),r.render_item="true",update_board_excess_links(t.sender.closest(".card")),adjust_shortcuts_size()}r.item_ids=n,$.ajax({type:"PUT",url:"/items/move",data:r,statusCode:{0:networkerror_status0,401:redirect_401},success:function(e){ga("send","event","shortcut","move","success"),e&&s.after(e).remove()},error:function(){ga("send","event","shortcut","move","error"),show_flash_notice("Error when updating item's position","error")}})}}})}function check_link_bar(){"speeddial"==$("#main").attr("board-state")&&($("#global-header").find(".weather-container").attr("temperature-scale")?sync_speed_dial_weather():refresh_settings(!0,sync_speed_dial_weather))}function sync_speed_dial_weather(){var e=$("#global-header").find(".weather-container").attr("temperature-scale");if(e){var t=$("#global-header").find(".weather-location").text();$("#time-weather-module").find(".weather-degree-buttons").add($("#speed-dial-settings").find("#scale-toggle-container")).find("."+e).addClass("current"),$("#time-weather-module").find(".weather-container").attr("temperature-scale",e),$("#time-weather-module").find(".weather-location-city").text(t.split(",")[0]).attr("location",t),refresh_update_weather_duration(),update_weather_interval=update_weather_interval||setInterval(update_weather,6e5),update_weather(),update_time_interval=update_time_interval||setInterval(update_time,1e3),update_time()}}function update_weather(){var e=$("#global-header").find(".weather-location").text();check_update_weather_time()&&e&&"speeddial"==$("#main").attr("board-state")&&(last_weather_location&&last_weather_call_time&&last_weather_location==e&&last_weather_call_time>(new Date).getTime()-6e4||(last_weather_location&&last_weather_location!==e&&$(".weather-temperature").removeAttr("fahrenheit-value"),last_weather_location=e,last_weather_call_time=(new Date).getTime(),$.ajax({url:"https://query.yahooapis.com/v1/public/yql",method:"GET",data:{q:"select item.condition from weather.forecast where woeid in (select woeid from geo.places(1) where text = '"+e+"');",format:"json"},success:function(e){try{var t=e.query.results.channel.item.condition;if(!$.isNumeric(t.temp))throw"Temperature missing";var i=+t.temp,n=t.text;$(".weather-temperature").attr("fahrenheit-value",i).text("fahrenheit"==$(".weather-container").attr("temperature-scale")?Math.round(i):fahrenheit_to_celsius(i)),$(".weather-description").text(n)}catch(o){return this.error()}$("#main").removeAttr("weather-data")},error:function(){$.isNumeric($(".weather-temperature").attr("fahrenheit-value"))||$("#main").attr("weather-data","hidden")}})))}function check_update_weather_time(){return update_weather_end_time&&new Date<update_weather_end_time}function refresh_update_weather_duration(){update_weather_end_time=(new Date).valueOf()+864e5}function update_time(){if("speeddial"==$("#main").attr("board-state")){var e=(new Date).toLocaleTimeString().match(/^(\d{1,2}:\d{2}):\d{2} (?:A|P)M$/);e&&$("#time").text()!=e[1]&&$("#time").text(e[1])}}function fahrenheit_to_celsius(e){return Math.round(5*(e-32)/9)}function initialize_autocomplete(){$("#time-weather-module").add("#global-header").find(".location-section").find("input").each(function(){var e=this;pac_select_first(e);var s=new google.maps.places.Autocomplete(e,{types:["(cities)"]});s.addListener("place_changed",function(){var e=s.getPlace().address_components;if(e){var i={};$.each(e,function(e,t){i[t.types[0]]=t.long_name});var t=i.locality||i.administrative_area_level_3,n=i.administrative_area_level_1||null,o=i.country,r=n?t+", "+n+", "+o:t+", "+o,a=$("#global-header").find(".weather-container").find(".weather-location");a.text()!==r&&($.ajax({type:"PUT",url:"/users",data:{"user[location_city]":t,"user[location_region]":n,"user[location_country]":o},success:function(){ga("send","event","weather","update_location","success")},error:function(){ga("send","event","weather","update_location","error")}}),a.text(r),sync_speed_dial_weather()),$("#global-header").find(".weather-container").add("#time-weather-module").removeClass("editing-location")}})})}function pac_select_first(n){function e(e,t){if("keydown"==e){var i=t;t=function(e){if(13==e.which&&!$(".pac-item-selected").length){var t=$.Event("keydown",{keyCode:40,which:40});i.call(n,t)}i.call(n,e)}}o.call(n,e,t)}var o=n.addEventListener?n.addEventListener:n.attachEvent;n.addEventListener=n.attachEvent=e}function check_weather_size(){if("speeddial"==$("#main").attr("board-state")){var e=$(window).height(),t=93,i="hidden"!=$("#main").attr("appearance-speed-dial-show-shortcuts"),n="hidden"!=$("#main").attr("appearance-speed-dial-show-inbox"),o="hidden"!=$("#main").attr("appearance-speed-dial-show-favorite-categories"),r=0;i&&(r+=$("#speed-dial-section").outerHeight(!0)),n&&(r+=$("#inbox-wrapper").outerHeight(!0)),o&&(r+=$("#favorite-categories").outerHeight(!0));var a=(.8*(e-t)-r)/346;a<.5||3==i+n+o?$("#main").attr("weather-module","mini"):a<.8?($("#main").attr("weather-module","collapsed"),$("#time-weather-module").css("font-size","1rem")):($("#main").removeAttr("weather-module"),$("#time-weather-module").css("font-size",Math.min(a,1)+"rem"))}}function update_weather_dropdown_top_position(){var e=$("#time-weather-module").find("input"),t=e.outerHeight(),i=e.offset().top+t;$(".pac-container:last-child").offset({top:i})}function adjust_speed_dial_styles_without_throttle(){if("speeddial"==$("#main").attr("board-state")){var e=get_style();adjust_section_margins(e),check_weather_size(),fix_shortcuts(e)}}function get_style(){$("#injected-style").remove();var e=$('<style id="injected-style"></style>');return e.append(document.createTextNode("")),$("body").prepend(e),e}function add_style_rule(e,t,i){e.length&&t&&i&&e.append(t+"{ "+i+" }")}function fix_shortcuts(e){var t='#main[board-state="speeddial"]:not(.internal-search) #speed-dial-section .shortcut-module,#main[board-state="speeddial"]:not(.internal-search) #speed-dial-section .bookmark-placeholder,#main[board-state="speeddial"]:not(.internal-search) #speed-dial-section .create-shortcut',i=$("#speed-dial-section").find(".shortcut-module")[0];if(i){var n=i.getBoundingClientRect().width,o=$("#speed-dial-section").find(".ui-sortable")[0].getBoundingClientRect().width,r=(o-1)/Math.floor(o/n)-n;add_style_rule(e,t,0<r?"margin: 0 "+r/2+"px;":null)}}function adjust_section_margins(e){var t="hidden"!=$("#main").attr("appearance-speed-dial-show-shortcuts"),i="hidden"!=$("#main").attr("appearance-speed-dial-show-inbox"),n="hidden"!=$("#main").attr("appearance-speed-dial-show-favorite-categories");add_style_rule(e,$("#speed-dial-section").filter(function(){return t}).add($("#inbox-wrapper").filter(function(){return i})).add($("#favorite-categories").filter(function(){return n})).slice(0,-1).map(function(){return'#main[board-state="speeddial"]:not(.internal-search) #'+$(this).attr("id")}).toArray().join(", "),"margin-bottom: 8vh;")}function register_speed_dial_observer(){"MutationObserver"in window&&$("#speed-dial-container").length&&new MutationObserver(function(){$("#main")[0].className.match(/(^|\W)drag-initiated-/)||adjust_speed_dial_styles()}).observe($("#speed-dial-container")[0],{childList:!0,subtree:!0})}function register_social_favorite_listeners(){var e=$("#social-favorites");e.find("#social-accounts-toggles div.not-connected").hover(show_toggle_tooltip,hide_toggle_tooltip),e.find(".social-account-toggle").click(filter_social_account),$("#social-links-container").masonry({itemSelector:".social-link-module-masonry",transitionDuration:0,gutter:12}),$("#social-links-container").find(".social-link-module").register_item_listeners()}function select_social_favorites(){refresh_sync_timeout(),document.location.hash="social_favorites",document.title="Papaly | Social Bookmarks",gas("social_favorites"),$("#main").attr("board-state","social"),minimize_inbox(),$("#speed-dial-section").attr("status",""),clean_editing_state(),$(".nav-item-selected").removeClass("nav-item-selected"),$(this).addClass("nav-item-selected"),0<$("#social-favorites").length&&($(".board").hide(),$("#social-favorites").show()),request_social_favorites(),adjust_shortcuts_size()}function request_social_favorites(n,o,r,a){var s=$(".connect-search-social-favorites");s.html('<span class="non-loaded loading-dots">Loading</span><div class="close-panel-empty"></div>'),s.attr("done","true"),s.addClass("search-button-loading"),$.ajax({method:"GET",url:"/apps/social_favorites",statusCode:{0:networkerror_status0,401:redirect_401},success:function(e){var t=$(e);$("#main").hasClass("internal-search")||$(".board").hide(),$("#social-favorites").remove(),$("#main-content").children(".container").append(t),register_social_favorite_listeners();var i=t.find(".social-account-toggle");s.attr("needs-load",i.length),i.each(function(){reload_social_account(this,n,o,r,a)})},error:function(){$(".connect-search-social-favorites").text("Load results from connected accounts"),show_flash_notice("Error while pulling social favorites","error")}})}function sort_social_favorites(){var e=$("#social-links-container");e.append(e.find(".social-link-module").sort(function(e,t){return Date.parse($(t).find(".social-link-date").text())-Date.parse($(e).find(".social-link-date").text())}))}function reload_social_account(e,n,t,i,o){var r=$(e),a=r.attr("id"),s=a.replace("social-account-toggle-","");return"social-account-toggle-all"==a||(r.hasClass("not-connected")?(i&&i(s),o&&o()):($("#social-loading-mask").show(),$.ajax({type:"GET",url:"/apps/social_favorite_module",data:{provider:s},success:function(e){var t=$(e);check_account_conflicts(t);var i=$("#social-links-container");$("#social-loading-mask").hide(),i.append(t),t.register_item_listeners(),sort_social_favorites(),i.masonry("reloadItems"),i.masonry("layout"),n&&n(r,t),o&&o()},error:function(){$("#social-loading-mask").hide(),r.addClass("not-connected"),0==$(".social-account-toggle").filter(":not(.not-connected)").filter(":not(#social-account-toggle-all)").length&&$("#empty-social-favorites").show(),t&&t(s),o&&o()}}))),!0}function check_account_conflicts(e){0<e.filter("#not-user-account").remove().length&&display_not_user_account()}function filter_social_account(e,t){if($("#social-loading-mask").hide(),$("#social-nolinks").hide(),(t=t||$(e.target).closest(".social-account-toggle")).addClass("selected").siblings().removeClass("selected"),t.hasClass("not-connected")){connect_account($(this).closest(".social-account-toggle").attr("provider"),function o(){$("#empty-social-favorites").hide(),$(".social-link-module").hide()},filter_social_account_success,filter_social_account_error)}else{var i=t.attr("id");if("social-account-toggle-all"==i)$("#social-links-container").find(".social-link-module").show();else{var n="."+i.replace("social-account-toggle-","")+"-module";$("#social-links-container").find(".social-link-module").hide().filter(n).show()}$(".social-link-module:hidden").css({top:"0px",left:"0px"}).removeClass("social-link-module-masonry masonry-brick"),$(".social-link-module:visible").addClass("social-link-module-masonry masonry-brick"),$("#social-links-container").masonry("reloadItems").masonry("layout"),0==$(".social-link-module:visible").length&&$("#social-nolinks").show()}}function connect_account(t,i,n,o){papaly_app_authentication(t,function(){i&&i();var e=$('#social-favorites .social-account-toggle[provider="'+t+'"]');e.removeClass("not-connected"),reload_social_account(e,n,o)},o||function(){noticeERR("Error when connecting your account")},{offline:"true"})}function filter_social_account_success(e,t){t.hide(),e.hasClass("selected")?filter_social_account(null,e):"social-account-toggle-all"==e.siblings().filter(".selected").attr("id")&&(t.show().addClass("social-link-module-masonry masonry-brick"),social_container.masonry("reloadItems").masonry("layout"))}function filter_social_account_error(e){show_flash_notice("Having trouble accessing "+e,"error")}function show_toggle_tooltip(){var e=$(this).attr("id");"social-account-toggle-facebook"==e?$("#social-toggle-tooltip").find("span").text("Facebook"):"social-account-toggle-twitter"==e?$("#social-toggle-tooltip").find("span").text("Twitter"):"social-account-toggle-youtube"==e?$("#social-toggle-tooltip").find("span").text("YouTube"):"social-account-toggle-linkedin"==e&&$("#social-toggle-tooltip").find("span").text("LinkedIn");var t=$(this).offset().left;$(window).width()<718?$("#social-toggle-tooltip").hide():$("#social-toggle-tooltip").show().css({top:-77,left:t-460})}function hide_toggle_tooltip(){$("#social-toggle-tooltip").hide()}function select_explore(){refresh_sync_timeout(),document.location.hash="explore",document.title="Papaly | Explore",gas("explore"),$("#main").attr("board-state","explore"),$(".nav-item-selected").removeClass("nav-item-selected"),$(this).addClass("nav-item-selected"),$("#speed-dial-section").attr("status",""),minimize_inbox();var t=$("#main-content").children(".container");t.find("#explore-section").remove();var e="<div id='explore-section'>Loading...</div>";t.append(e),$.ajax({type:"GET",url:"/apps/explore",success:function(e){t.find("#explore-section").remove(),t.append(e),1==$(".invite-friends").attr("state")&&loadFacebookFriends(),$("#featured-boards-section .board-state-button").on("click",board_state_button_clicked),$("#featured-boards-section .connect-fb").on("click",connectFacebook)},statusCode:{0:networkerror_status0,401:redirect_401},error:function(){t.find("#explore-section").html("Unable to load Explore page"),show_flash_notice("Unable to load Explore page","error")}})}function replace_user(){$(this).closest("li").remove()}function board_state_button_clicked(e){e.preventDefault();var t=$(this),i=t.attr("state"),n="",o="";switch(i){case"follow":n="PUT",o="following";break;case"following":n="DELETE",o="follow";break;case"signup":return void load_dialog(e,"/dialog/must_login");case"owner-private":return void make_board_public(t);case"owner":return void t.siblings(".category-card-link")[0].click();default:return}var r=t.attr("board-id");$.ajax({type:n,url:"/boards/follow",data:{board_id:r,render:"sidebar"},success:function(e){t.attr("state",o),"following"==o?$("#boards-you-follow").find("ul").append(e):"follow"==o&&$("#boards-you-follow").find("[board-id="+r+"]").parent().remove()},statusCode:{401:function(){load_dialog(e,"/dialog/signup?from=user_shared_follow")}}})}
function connectFacebook(){papaly_app_authentication("facebook",function(){loadFacebookFriends()},function(){show_flash_notice("Error when connecting your account","error")})}function loadFacebookFriends(){var e=$(".invite-friends").attr("state");$(".invite-friends").attr("state","1"),$.ajax({type:"GET",url:"/apps/facebook_friends",success:function(e){$(".invite-friends").find("ul").append(e),$("#featured-boards-section .close").on("click",replace_user)},error:function(){"0"==e&&show_flash_notice("Error when connecting your account","error"),$(".invite-friends").attr("state","0")}})}function register_sidebar_listeners(){$("#sidebar-nav").on("click","#add-board",add_board).on("keyup","input.nav-section-item-title",new_board_input_handler).on("click",".nav-section-item-remove",remove_new_board_tab).on("click","#nav-your-boards .nav-section-item, #boards-you-follow .nav-section-item",select_board).on("click","#nav-speed-dial",select_speed_dial).on("click","#nav-explore",select_explore).on("click","#nav-social-favorites",select_social_favorites).on("click","#nav-inbox",select_inbox_recent).on("click",".sidebar-toggle-icon",toggle_sidebar_clicked).on("click",hide_sidebar_click_anywhere).on("click",".sidebar-overflow-button",toggle_sidebar_overflow).on("click","#sidebar-background",show_float_sidebar).on("click",".nav-section-item",toggle_batch_mask),register_sidebar_sortables(),decide_sidebar_toggle_shadow(),$("#sidebar-nav").on("click","#refresh-page",function(){$(this).addClass("rotating"),redirect_location("/?click=refresh_page")})}function register_sidebar_sortables(){$.ui.sortable&&($("#your-boards-sortable-container, #boards-you-follow").register_tab_sortable(),$("#your-boards-sortable-container").find(".nav-section-item").register_tab_droppable())}function toggle_sidebar_overflow(e){"show"==$("#top-actions-container").attr("overflow-menu-status")?$("#top-actions-container").attr("overflow-menu-status","hide"):($("#top-actions-container").attr("overflow-menu-status","show"),$("#main").one("click",hide_sidebar_overflow),e.stopPropagation())}function hide_sidebar_overflow(){$("#top-actions-container").attr("overflow-menu-status","hide")}function refresh_sidebar(o,r){$.ajax({type:"GET",url:"/users/get_sidebar",success:function(e){var t=$(e).filter("#sidebar-nav");if(""!=t&&0!=t.length){var i=$("#sidebar-nav");if(o){var n=i.find(".nav-item-selected").attr("board-id");n!=t.find(".nav-item-selected").attr("board-id")&&(t.find(".nav-item-selected").removeClass("nav-item-selected"),n&&t.find('nav-item-section[board-id="'+n+'"]').addClass("nav-item-selected"))}i.replaceWith(t),register_sidebar_listeners(),r&&r()}},statusCode:{401:redirect_401},error:function(){}})}function decide_sidebar_toggle_shadow(){var e=$(window).height();if(0!=$("#sidebar-main").length){var t=$("#sidebar-main")[0].scrollHeight;return e-$("#sidebar-toggle").outerHeight()<t&&($("#sidebar-toggle").addClass("toggle-shadow"),!0)}}function toggle_sidebar_clicked(){var e,t=$("#main").attr("sidebar-state"),i=$(window).width();set_sidebar_state(e="collapsed"==t?"expanded":""==t&&i<=624?"expanded":"collapsed"),624<i&&$.ajax({type:"PUT",url:"/users/sidebar_collapsed",data:{value:"collapsed"==e}})}function set_sidebar_state(e){remove_new_board_tab(),$("#main").attr("sidebar-state",e),$("#social-links-container").masonry("layout"),adjust_speed_dial_styles()}function show_float_sidebar(){"collapsed"==$("#main").attr("sidebar-state")&&(remove_new_board_tab(),$("#main").attr("sidebar-state","float"))}function hide_float_sidebar(){"float"==$("#main").attr("sidebar-state")&&set_sidebar_state("collapsed")}function hide_sidebar_click_anywhere(e){if(!("float"!=$("#main").attr("sidebar-state")&&624<$(window).width())){var t=$(e.target).attr("id");"sidebar-nav"!=t&&"sidebar-main"!=t||set_sidebar_state("collapsed")}}function select_board(e){var t=$(this),i=t.attr("board-id");if(check_mobile()){if($("#nav-your-boards").removeClass("mobile-unhover"),$("#boards-you-follow").removeClass("mobile-unhover"),$(e.target).hasClass("nav-item-left"))return;$("#nav-your-boards").addClass("mobile-unhover"),$("#boards-you-follow").addClass("mobile-unhover")}document.location.hash="board_id="+i,document.title="Papaly | "+t.find(".nav-item-board-name").text().trim();var n=t.closest(".nav-section").attr("id");n&&gas(n=n.match("follow")?"followed_boards":"boards"),select_and_refresh_board(i,!1)}function remove_new_board_tab(){$("#sidebar-nav").find(".nav-section-item-editing").remove(),$(".walkthrough-item.create-board").hide()}function add_board(){if(show_float_sidebar(),0==$("#sidebar-nav").find(".nav-section-item-editing").length){$("#sidebar-nav").find(".nav-section-item").removeClass("nav-item-selected");var e=$("#template-container").find(".nav-section-item-editing").clone();$("#sidebar-nav").find("#your-boards-sortable-container").prepend(e),$("#sidebar-nav").find(".nav-section-item-editing input").val("New Board")}if($("#sidebar-nav").find(".nav-section-item-editing input").select(),"false"===$("#tutorial-add-board").attr("completed")){try_call("add_board_tutorial_completed");var t=$(".nav-section-item-editing").offset().left,i=$(".nav-section-item-editing").offset().top;$(".walkthrough-item.create-board").show().css({top:i-5,left:t+265})}}function new_board_input_handler(e){var t=e.keyCode||e.which;if(1==t){if(!$("#sidebar-nav").find(".nav-section-item-title").length)return;if(0<$(e.target).closest("#sidebar-nav").length)return}if(27!=t){if(13==t||1==t){(i=$("#main .nav-section-item-title")).attr("disabled","disabled");$(e.target).closest(".nav-section-item-editing");var i,n=(i=$("#main .nav-section-item-title")).val().trim();0!=n.length?($.ajax({type:"POST",url:"/boards",data:{name:n,position:0},statusCode:{0:networkerror_status0,401:redirect_401},success:function(e){ga("send","event","board","create","success"),$("#your-boards-sortable-container").html($(e).html()),$("#your-boards-sortable-container").find(".nav-section-item").register_tab_droppable(),select_and_refresh_board($("#your-boards-sortable-container").find(".nav-section-item:first").attr("board-id"),!0),noticeOK("New board created")},error:function(){ga("send","event","board","create","error"),show_flash_notice("Error when creating board","error"),i.removeAttr("disabled")}}),$(".walkthrough-item.create-board").hide()):i.addClass("invalid").val("")}}else"float"==$("#main").attr("sidebar-state")?set_sidebar_state("collapsed"):remove_new_board_tab()}function check_sidebar_version(e){$("#sidebar-nav").attr("version-desk")!=e&&(refresh_sidebar(!0,undefined),refresh_settings(!0))}function register_comments_panel_listeners(){$("#boards-container").on("click",".board-comments-btn",reveal_comments_panel),$("#comments-links-panel").on("click",".top-tabs .tab",comments_tab_select).on("change keyup paste",".new-comment-container textarea",comment_text_changed).on("click","#comment-submit-button",comment_submit_clicked).on("click",".delete-comment",delete_comment_clicked).on("click",".actions-arrow",toggle_suggestions_actions).on("click",".delete-suggestion",delete_suggestion_clicked).on("click",".close-panel",block_page_click),$("#float-container").on("click",".block-page",block_page_click)}function block_page_click(e){e&&e.preventDefault(),$(".block-page").hide(),$("div#comments-links-panel").removeClass("panel-visible"),$("#main").removeClass("blurred")}function reveal_comments_panel(){load_comments_panel($(this).closest(".board").attr("board-id")),$("div#comments-links-panel").addClass("panel-visible"),$(".block-page").show(),$("#main").addClass("blurred")}function load_comments_panel(t){var i=$("#comments-links-panel");i.html('<span class="non-loaded loading-dots">Loading</span><div class="close-panel-empty"></div>'),$.ajax({type:"GET",url:"/boards/comments_panel",data:{board_id:t},success:function(e){i.html(e),update_board_comment_count(t)},error:function(){console.log("Error while loading comments panel"),i.html('<span class="non-loaded">Unable to load comments for this board.</span><div class="close-panel-empty"></div>')}})}function update_board_comment_count(e){var t=$(".comments-links-container"),i=parseInt(t.attr("num-comments"),10)+parseInt(t.attr("num-suggestions"),10);$('.board[board-id="'+e+'"]').find(".board-comments-number").text(i.toString())}function comments_tab_select(){$(this).parent().find(".tab").removeClass("current-tab"),$(this).addClass("current-tab"),$("div.comments-tab").hasClass("current-tab")?$("div.content-comments").addClass("content-visible").scrollTop(0):$("div.content-comments").removeClass("content-visible"),$("div.suggestions-tab").hasClass("current-tab")?$("div.content-suggestions").addClass("content-visible").scrollTop(0):$("div.content-suggestions").removeClass("content-visible")}function comment_text_changed(){var e=$(this),t=e.val().trim(),i=e.closest(".new-comment-container").find("#comment-submit-button");""==t?i.removeClass("active-button").addClass("inactive-button"):i.removeClass("inactive-button").addClass("active-button")}function comment_submit_clicked(){var e=$(this);if(!e.hasClass("inactive-button")){var t=e.closest(".comments-links-container").attr("board-id"),i=e.attr("nickname"),n=e.closest(".new-comment-container").find("textarea"),o=n.val().trim();n.attr("disabled","disabled"),e.removeClass("active-button").addClass("inactive-button"),$.ajax({type:"PUT",url:"/boards/comment",data:{board_id:t,nickname:i,comment:o},success:function(){load_comments_panel(t)},error:function(){console.log("Error while submitting comment."),n.removeAttr("disabled"),e.removeClass("inactive-button").addClass("active-button")}})}}function delete_comment_clicked(){if(confirm("Are you sure you want to delete the comment?")){var i=$(this).closest(".comment-container"),e=i.attr("comment-id");$.ajax({type:"DELETE",url:"/boards/comment",data:{comment_id:e},statusCode:{0:networkerror_status0,401:redirect_401},success:function(){var e=i.closest(".comments-links-container"),t=parseInt(e.attr("num-comments"))-1;e.attr("num-comments",t),e.find(".num-comments-span").text(t),update_board_comment_count(e.attr("board-id")),i.remove()},error:function(){console.log("Error deleting comment")}})}}function delete_suggestion_clicked(){if(confirm("Are you sure you want to delete the suggestion?")){var i=$(this).closest(".suggestion-container"),e=i.attr("suggestion-id");$.ajax({type:"DELETE",url:"/boards/comment",data:{comment_id:e},statusCode:{0:networkerror_status0,401:redirect_401},success:function(){var e=i.closest(".comments-links-container"),t=parseInt(e.attr("num-suggestions"))-1;e.attr("num-suggestions",t),e.find(".num-suggestions-span").text(t),update_board_comment_count(e.attr("board-id")),i.remove()},error:function(){console.log("Error deleting comment")}})}}function toggle_suggestions_actions(){$(this).parent().find("ul").toggleClass("visible")}function register_edit_listeners(){$("#boards-container").on("click",".command-edit-board",editing_on).on("click",".command-done-editing-board",editing_off).on("click",".card-select-box, .card-title",select_card).on("click",".title-description-container .edit-icon",edit_category_title).on("click",".card-edit-ok",save_category_edit).on("click",".card-edit-cancel",cancel_category_edit).on("keyup",".category-link.name, .category-link.category-note, .category-feed.name, .category-feed.category-note, .category-feed.url",edit_category_keyup).on("click",".command-create-category",create_category_clicked).on("click",".add-childcategory-icon",add_childcategory).on("click",".title-color-select",select_category_color).on("click",".type-selections .type-link",category_type_link).on("click",".type-selections .type-feed",category_type_feed).on("click",".add-item-controls .add-icon",add_item_clicked).on("click",".add-item-controls .overflow-icon",toggle_category_dropdown).on("keyup",".newitem-url",add_item_url_submit).on("mousedown",".item-bookmark.new-item-template .close",cancel_new_item).on({keyup:newitem_name_keyup,blur:newitem_name_blur},".new-item-template .item-name").on("click",".board-title-container .edit-icon",edit_board_title).on("click",".toggle-switch",toggle_switch_clicked).on("click",".sort-options-container .property-button",sort_clicked).on("click",".max-slot-container .property-option",max_slot_clicked).on("click",".show-excess-links-button",show_excess_links).on("click",".hide-excess-links-button",hide_excess_links).on("click",".command-show-links",show_all_links_toggle).on("click",".command-hide-excess-links",hide_all_links_toggle).on("input",".specify-excess-amount > input",excess_amount_input).on("keydown",".specify-excess-amount > input",excess_amount_keydown).on("blur",".specify-excess-amount > input",excess_amount_blur).on("click",".card-unavailable .remove-button",remove_pinned_category).on("click",".cards-container .item-select-box",select_item),$("#boards-you-follow").on("click",".nav-section-item",editing_off),$("#main-nav").on("click",editing_off),$(".delete-dropbox").register_trash_droppable()}function move_category_within_board(e,n){$.ajax({type:"PUT",url:"/categories/move",data:e,statusCode:{0:networkerror_status0,401:redirect_401},success:function(e,t,i){e&&"success"==e.status?(update_categories_with_replacement(e.categories),ga("send","event","category","move","slot"),n&&n()):this.error(i,t,e&&e.message)},error:function(){ga("send","event","category","move","error"),show_flash_notice("Error when updating category's position","error")}})}function checkLimitations(){"true"==$(".board:visible").attr("co-owner-limit")&&(0<$("#boards-container .bookmark-placeholder").length||0<$("#boards-container .category-placeholder").length)&&$("#main").addClass("edit-coowner")}function restoreLimitations(){$("#main").removeClass("edit-coowner")}function editing_on(){clean_editing_state(),$("#main").addClass("editing-on")}function editing_off(){clean_editing_state(),$("#main").removeClass("editing-on"),update_board_excess_links($(".item-bookmark.selected").removeClass("selected").closest(".card")),$(".card.selected").removeClass("selected"),$(".board-title-container").removeClass("editing").find(".board-title-editing").remove(),$(".batch-action-button").addClass("disabled")}function clean_editing_state(){cancel_new_item();var e=$("#main").find(".card.category-editing");0<e.length&&save_category_edit(undefined,e),board_title_save()}function select_card(){if($("#main").hasClass("editing-on")&&!$(this).closest(".board").hasClass("board-readonly")){var e=$(this).closest(".child-category, .category-container");if(e.hasClass("category-container")){if(!e.find(".card:not(.feed) .item-bookmark").length)return;e.find(".card:not(.feed) .item-bookmark.selected").length?e.find(".card:not(.feed) .item-bookmark").removeClass("selected").closest(".card").add(e.find(".parent-category")).removeClass("selected"):e.find(".card:not(.feed) .item-bookmark").addClass("selected").closest(".card").add(e.find(".parent-category")).addClass("selected"),update_board_excess_links(e.find(".card:not(.feed)"))}else{if(e.hasClass("feed")||!e.find(".item-bookmark").length)return;e.find(".item-bookmark.selected").length?(e.removeClass("selected").find(".item-bookmark").removeClass("selected"),e.closest(".category-container").filter(function(){return!$(this).find(".item-bookmark.selected").length}).find(".parent-category").removeClass("selected")):e.addClass("selected").find(".item-bookmark").addClass("selected").closest(".category-container").find(".parent-category").addClass("selected"),update_board_excess_links(e)}toggle_batch_mask()}}function select_item(e){if($("#main").hasClass("editing-on")){var t=$(e.target).closest(".item-bookmark");t.toggleClass("selected");var i=t.closest(".card");if(update_board_excess_links(i),i.find(".item-bookmark.selected").length?i.addClass("selected"):i.removeClass("selected"),i.hasClass("child-category")){var n=i.closest(".category-container");n.find(".item-bookmark.selected").length?n.find(".parent-category").addClass("selected"):n.find(".parent-category").removeClass("selected")}toggle_batch_mask()}}function toggle_batch_mask(){0===$(".cards-container").find(".selected").length?$(".batch-action-button").addClass("disabled"):$(".batch-action-button").removeClass("disabled")}function sort_clicked(){var e=$(this),t=e.closest(".board").attr("board-id"),i=e.attr("value");$.ajax({type:"PUT",url:"/boards/sort",data:{board_id:t,order:i},success:function(e){replace_board_with(e)}})}function max_slot_clicked(){var e=$(this),t=e.closest(".property-options-container");t.find(".property-option").removeClass("property-selected"),e.addClass("property-selected");var i=e.attr("option-value");t.attr("current-value",i);var n=t.closest(".board").attr("board-id"),o=t.attr("property-id"),r={};r.board_id=n,r[o]=i,$.ajax({method:"PUT",url:"/boards",data:r,statusCode:{0:networkerror_status0,401:redirect_401},success:function(){ga("send","event","board","update","success"),select_and_refresh_board(n,!0)},error:function(){ga("send","event","board","update","error"),show_flash_notice("Error while updating board settings","error")}})}function show_excess_links(){var e=$(this).closest(".card").attr("hide-excess-links",!1);update_board_excess_links(e),$.ajax({method:"PUT",url:"/categories",data:{"category[index]":e.attr("category-index"),"category[hide_excess_links]":!1},statusCode:{401:redirect_401},success:function(){ga("send","event","category","update","success")},error:function(){ga("send","event","category","update","error")}})}function hide_excess_links(){var e=$(this).closest(".card").attr("hide-excess-links",!0);update_board_excess_links(e),$.ajax({method:"PUT",url:"/categories",data:{"category[index]":e.attr("category-index"),"category[hide_excess_links]":!0},statusCode:{401:redirect_401},success:function(){ga("send","event","category","update","success")},error:function(){ga("send","event","category","update","error")}})}function update_board_excess_links(e){e.each(update_card_excess_links).closest(".board").each(update_board_excess_links_toggle)}function update_board_excess_links_toggle(){var e=$(this),t=e.find('.show-excess-links-button[style!="display: none;"]').length,i=e.find('.hide-excess-links-button[style!="display: none;"]').length,n=e.find(".command-show-links");t?n.show().next().hide():i?n.hide().next().show():n.hide().next().hide()}function update_card_excess_links(){var e=$(this),t=e.closest(".board"),i=+t.attr("excess-links-amount")||10;i=Math.max(i,e.find(".item-bookmark.selected").last().index()+1);var n=e.find(".item-bookmark").length;e.is(".feed")&&(i=Math.min(Math.ceil(i/2),10),n=Math.min(n,10));var o=e.find(".show-excess-links-button");"true"==e.attr("hide-excess-links")?(o.next().hide(),i<n?o.show().find("span").text(n-i):o.hide(),e.find(".item-bookmark").hide().slice(0,i).show()):(o.hide(),e.is(".feed")?e.find(".item-bookmark").hide().slice(0,10).show():e.find(".item-bookmark").show(),i<n&&"true"==t.attr("hide-excess-links")?o.next().show():o.next().hide())}function show_all_links_toggle(e,t){var i=$(this),n=i.closest(".board");update_board_excess_links((i.is(".command-show-links")?i:i.find(".command-show-links")).closest(".board").find(".card").attr("hide-excess-links",!1)),t||$.ajax({method:"PUT",url:"/boards",data:{board_id:n.attr("board-id"),hide_category_excess_links:!1},statusCode:{401:redirect_401},success:function(){ga("send","event","category","update","success")},error:function(){ga("send","event","category","update","error")}})}function hide_all_links_toggle(e,t){var i=$(this),n=i.closest(".board");update_board_excess_links((i.is(".command-hide-excess-links")?i:i.find(".command-hide-excess-links")).closest(".board").find(".card").attr("hide-excess-links",!0)),t||$.ajax({method:"PUT",url:"/boards",data:{board_id:n.attr("board-id"),hide_category_excess_links:!0},statusCode:{401:redirect_401},success:function(){ga("send","event","category","update","success")},error:function(){ga("send","event","category","update","error")}})}function excess_amount_input(){var e=$(this),t=e.val();(!t||+t<=0)&&(t=e.attr("value"));var i=e.closest(".board");i.attr("excess-links-amount")!=t&&update_board_excess_links(i.attr("excess-links-amount",t).find(".card"))}function excess_amount_keydown(e){13==e.which&&$(this).blur()}function excess_amount_blur(){var e=$(this),t=+e.val();if(!t||t<=0||1e4<t||t%1){t=e.attr("value"),e.val(t);var i=e.closest(".board");if(i.attr("excess-links-amount")!=t)update_board_excess_links(i.attr("excess-links-amount",t).find(".card"))}else t!==+e.attr("value")&&$.ajax({type:"PUT",url:"/boards",data:{excess_links_amount:t,board_id:e.closest(".board").attr("board-id")},statusCode:{0:networkerror_status0,401:redirect_401},success:function(){ga("send","event","board","update","success"),show_flash_notice("Updated board settings","ok"),e.attr("value",t)},error:function(){ga("send","event","board","update","error"),show_flash_notice("Error while updating board settings","error")}})}function toggle_switch_clicked(){var e=$(this),t="no"==e.attr("current-state")?"yes":"no";e.attr("current-state",t);var i=e.attr("toggle-name"),n=e.closest(".board"),o=n.attr("board-id"),r={};switch(r.board_id=o,i){case"secret":"no"==t?r.is_public=!0:(n.find('.toggle-switch[toggle-name="invisible"]').attr("current-state","yes"),r.is_public=!1,r.is_crawled=!1);var a="no"==t?"public":"private";n.find(".co-owner-button").attr("board-source-is",a);break;case"invisible":"no"==t?(n.find('.toggle-switch[toggle-name="secret"]').attr("current-state","no"),r.is_crawled=!0,r.is_public=!0):r.is_crawled=!1;break;case"notes":r.collapse_notes="no"!=t;break;case"child-categories":r.collapse_child_categories="no"!=t;break;case"excess_links":"no"==t?(r.hide_excess_links=!1,n.find(".command-show-links, .command-hide-excess-links").hide()):(r.hide_excess_links=!0,n.find(".command-show-links").show(),n.find(".command-hide-excess-links").hide())}$.ajax({type:"PUT",url:"/boards",data:r,statusCode:{0:networkerror_status0,401:redirect_401},success:function(){ga("send","event","board","update","success"),show_flash_notice("Updated board settings","ok"),"secret"==i?($('.nav-section-item[board-id="'+o+'"]').attr("status",r.is_public?"public":"private"),n.attr("status",r.is_public?"public":"private")):"notes"==i?(items=n.find(".item-bookmark"),items.attr("note-status",r.collapse_notes?"collapsed":"expanded")):"child-categories"==i?(child_cats=n.find(".child-category"),child_cats.attr("collapse-category",r.collapse_child_categories?"collapsed":"expanded")):"excess_links"==i&&(n.attr("hide-excess-links",r.hide_excess_links),e.closest(".switch-container").next(".specify-excess-amount").find("input").focus().select(),r.hide_excess_links?hide_all_links_toggle.call(n,null,!0):show_all_links_toggle.call(n,null,!0))},error:function(){ga("send","event","board","update","error"),show_flash_notice("Error while updating board settings","error")}})}function edit_board_title(){var e=$(this).closest(".board"),t=e.attr("board-name"),i=$("#template-container").find(".board-title-editing").clone();e.find("div.board-title-container").addClass("editing").prepend(i),i.find(".board-title-input").keyup(board_title_keyup),i.find("input").val(t).select()}function board_title_keyup(e){switch(e.keyCode||e.which){case 13:board_title_save();break;case 27:$(this).closest(".board-title-container:visible").removeClass("editing").find(".board-title-editing").remove();break;default:return}}function board_title_save(){var e=$(".board-title-container.editing").find(".board-title-input"),t=e.closest(".board"),i=t.attr("board-id"),n=(t.attr("board-name")||"").trim(),o=(e.val()||"").trim();if(""!==o){if(n!=o){var r={};r.authenticity_token=CSRF_TOKEN,r.name=o,r.board_id=i,$.ajax({type:"PUT",url:"/boards",data:r,statusCode:{0:networkerror_status0,401:redirect_401},success:function(){ga("send","event","board","update","success"),refresh_board_title(i,o),noticeOK("Board title updated")},error:function(){ga("send","event","board","update","error"),show_flash_notice("Error when updating board title","error")}})}t.find("h1.board-title").text(o),t.find("div.board-title-container").removeClass("editing").find(".board-title-editing").remove()}else e.addClass("invalid").attr("placeholder","title can't be empty")}function refresh_board_title(e,t){var i=$("#boards-container").find('.board[board-id="'+e+'"]');i.attr("board-name",t),i.find("h1.board-title").text(t);var n=$("#nav-your-boards").find('.nav-section-item[board-id="'+e+'"]');n.attr("name",t).attr("tooltip","<b>"+t+"</b>"),n.find(".nav-item-board-name").text(t)}function undo_action(){$.ajax({type:"GET",url:"/undo",statusCode:{0:networkerror_status0,401:redirect_401},success:function(e){var t=$(e);if(0<t.filter(".board").length){var i=t.filter(".board"),n=i.attr("board-id");$('.board[board-id="'+n+'"]').remove(),$(".board").hide(),$("#boards-container").append(i.show()),i.register_board_listeners(),refresh_sidebar(!1,function(){$(".nav-item-selected").removeClass("nav-item-selected"),$('.nav-section-item[board-id="'+n+'"]').addClass("nav-item-selected")})}replace_link_bar_with(t),adjust_shortcuts_size()}}),hide_flash_notice()}function add_item_clicked(){if(!(0<$(this).closest(".card").find(".new-item-template").length)){clean_editing_state();var e=$("#template-container").find(".new-item-template").clone();$(this).closest(".card").find(".item-container").prepend(e),e.find(".newitem-url").focus(),try_call("add_link_tutorial_completed")}}function add_item_url_submit(e){var t=$(this),o=t.parents(".new-item-template");if(27!=e.which){if(13==e.which||(e.ctrlKey||e.metaKey)&&86==e.which){var r=$(this).val().trim();if($(this).val(r),r==decodeURI(r)&&(r=encodeURI(r)),r.length<1)return t.addClass("invalid"),void t.select();o.attr("status","step2"),$.ajax({type:"GET",dataType:"json",url:"https://wscraper.herokuapp.com/get_link_data",data:{url:r,with_images:!1},timeout:5e3,success:function(e){var t=e.data||{},i=t.title||"New bookmark",n=t.url||r;o.attr("url",n),o.attr("status","step3"),o.find(".item-name").val(i).select()},error:function(){o.attr("url",r),o.attr("status","step3"),o.find(".item-name").val("New bookmark").select()}}),$.ajax({type:"GET",dataType:"json",url:"/api/favicon",data:{url:r},success:function(e){o.find(".item-icon").css("background","url("+e.favicon_url+")")},error:function(){}})}}else o.remove()}function newitem_name_blur(){var e=$(this).closest(".new-item-template");setTimeout(function(){e.attr("last-act")||(e.attr("last-act","save"),submit_create_new_item(e))},150)}function newitem_name_keyup(e){var t=e.keyCode||e.which,i=$(this).closest(".new-item-template");13==t?i.attr("last-act")||(i.attr("last-act","save"),submit_create_new_item(i)):27==t&&(i.attr("last-act","cancel"),i.remove())}function submit_create_new_item(n){var o=n.closest(".card"),e=n.find(".item-name"),t=e.val().trim(),i=n.attr("url");if(i==decodeURI(i)&&(i=encodeURI(i)),e.val(t),t.length<1)return e.addClass("invalid"),void e.focus();$.ajax({type:"POST",url:"/items",data:{"item[category_index]":o.attr("category-index"),"item[position]":n.index(),"item[name]":t,"item[url]":i,from:"url"},statusCode:{0:networkerror_status0,401:redirect_401},success:function(e){ga("send","event","item","create","success");var t=$(e).addClass("ui-sortable-handle");t.register_item_listeners();var i=o.find(".item-container");hide_tooltip(),n.remove(),i.prepend(t),update_board_excess_links(o),t.flashlight(),show_flash_notice("Bookmark saved","ok"),"true"==t.attr("xtn-notice")&&setTimeout(show_xtn_notice,1500)},error:function(){ga("send","event","item","create","error"),show_flash_notice("Error saving bookmark","error")}})}function show_xtn_notice(){var e=$('<div class="promote-extension"></div>');$("body").append(e);var t=e.css("display").match(/none/i);e.remove(),t||load_dialog(null,"/dialog/xtn_intro")}function cancel_new_item(){var e=$(".board").find(".new-item-template");e.attr("last-act","cancel"),e.remove()}function trash_item(e,t,i){t=t||$(e.target).closest(".item-bookmark"),stop_propagation(e);var n,o=t.closest(".card");if(t.detach(),update_board_excess_links(o),25<t.length)n="<b>"+t.length+" items</b> removed";else if(1<t.length)n="<b>"+t.length+' items</b> removed.<br/><div id="undo_action" class="theme-text-color">undo</div>';else{var r=t.find("var").attr("name")||t.text().trim();n='Link "<b>'+r.substring(0,12)+'</b>" removed.<br/><div id="undo_action" class="theme-text-color">undo</div>'}var a=t.map(function(e,t){return t.getAttribute("item-index")}).toArray(),s=e.target.className;e.target.className.match("ui-droppable")?s="dropbox":e.target.className.match("delete-items-btn")?s="massdelete":e.target.className.match("delete-icon")?s="button":"remove_duplicate-items-button"==e.target.id?s="remove_duplicates":e.target.className.match("delete-link")&&(s="edit_dialog_delete");var l=t.hasClass("shortcut-module")?"shortcut":"item";$.ajax({type:"DELETE",url:"/items",data:{item_ids:a,target:s},statusCode:{0:networkerror_status0,401:redirect_401},success:function(){ga("send","event",l,"delete","success",a.length),t.remove(),toggle_batch_mask(),show_flash_notice(n,"delete"),i&&i()},error:function(){ga("send","event",l,"delete","error",a.length),show_flash_notice("Error when moving item to trash","error")}})}function create_category_clicked(){if(!$("#main").hasClass("editing-on")){$("#boards-container .new-card-template.parent-category").closest(".category-container").add($("#boards-container .new-card-template.child-category")).remove();var e=$("#template-container").find(".category-container").clone();e.find(".card").addClass("parent-category");var t=$(this).closest(".board");t.find(".cards-container .category-slot").first().prepend(e),edit_category_title(undefined,e.find(".parent-category")),t.find(".empty-board-overlay, .command-import-bookmarks").hide();var i=$(".new-card-template .title-description-container").outerHeight();$(".new-card-template .item-container-mask").css("top",i)}}function add_childcategory(){if(!$("#main").hasClass("editing-on")){$("#boards-container .new-card-template.parent-category").closest(".category-container").add($("#boards-container .new-card-template.child-category")).remove();var e=$("#template-container").find(".card").clone().addClass("child-category");$(this).closest(".category-container").find(".child-category.placeholder").after(e),edit_category_title(undefined,e);var t=e.find(".title-description-container").outerHeight();e.find(".item-container-mask").css("top",t)}}function save_new_category(i){if("save"!==i.attr("last-act")){var e,t,n,o,r;i.attr("last-act","save"),i.hasClass("child-category")?(e=-5,t=null,n=.9*i.siblings(".child-category").first().attr("category-position")||1,r=i.siblings(".parent-category").attr("category-index")):(e=0,t=null,n=.9*$(".board:visible .cards-container .slot-"+e+" .card:not(.new-card-template):first").attr("category-position")||1,o=i.closest(".board").attr("board-id"));var a=i.hasClass("category-type-feed")?i.find(".category-feed.type-container"):i.find(".category-link.type-container"),s=a.find("input.name"),l=a.find("textarea.category-note"),c=s.val(),d=l.val(),u=i.find(".color-selected").attr("color")||i.attr("color"),h=i.hasClass("category-type-feed")?a.find("input.url").val():"";h==decodeURI(h)&&(h=encodeURI(h));var f=h?"rss":"category";if(""===c)return s.addClass("invalid").focus(),void i.attr("last-act","");$.ajax({type:"POST",url:"/categories",data:{board_id:o,parent_category_id:r,"category[name]":c,"category[description]":d,"category[color]":u,"category[slot]":e,"category[behind]":t,"category[ahead]":n,"category[url]":h,"category[category_type]":f},statusCode:{0:networkerror_status0,401:redirect_401},success:function(e){ga("send","event","category","create","success");var t=$(e);t.hasClass("category-container")?i.closest(".category-container").replaceWith(t):i.replaceWith(t),"category"==f&&t.register_item_sortable(),register_newcard_listeners(t),show_flash_notice("New category created.","ok"),"category"!=f&&load_feed.call(t)},error:function(){ga("send","event","category","create","error"),i.attr("last-act",""),show_flash_notice("Error creating category","error")}})}}function register_newcard_listeners(e){if((e=$(e)).find(".title-description-container").flashlight(),e.find(".title-description-container").addClass("ui-sortable-handle"),adjust_slot_height(),e.is(":not(.feed)")){var t=e.closest(".board").attr("board-id"),i=e.attr("category-index"),n=$('.nav-section-item[board-id="'+t+'"]').find(".nav-item-categories"),o=$('<li class="nav-item-category ui-droppable" category-index="'+i+'">'+e.find(".card-title").html()+"</li>");n.prepend(o),o.register_tab_category_droppable()}}function edit_category_title(e,t){(t=t||$(this).closest(".card")).find(".card-description").hide(),$(
".overflow-menu").hide(),$(".item-container-mask").show(),clean_editing_state();var i=$("#template-container").find(".card-edit-mode").clone();t.addClass("category-editing"),t.find(".title-description-container").prepend(i);var n=t.attr("color");t.find('.title-color-select[color="'+n+'"]').addClass("color-selected");var o=t.find(".card-title").text();i.find("input.name").val(o).select();var r=t.hasClass("category-type-feed")?t.find(".category-feed.type-container"):t.find(".category-link.type-container"),a=t.find(".card-description").text();r.find(".category-note").text(a),r.find(".character-count span").text(140-a.length),i.find(".category-note").on("change keyup paste focus",note_character_counter),try_call("add_link_tutorial_completed");var s=$(this).closest(".title-description-container").outerHeight();$(".item-container-mask").css("top",s)}function note_character_counter(){var e=140-$(this).val().length;$(this).closest(".type-container").find(".character-count span").text(e)}function add_category_feed_url_submit(e,a){var t=a.find(".category-feed.url"),i=t.val();if(!i)return t.addClass("invalid");"submit-feed-url"!==a.attr("last-act")&&(a.attr("last-act","submit-feed-url"),a.attr("status","step2"),t.blur(),t.removeClass("invalid"),$.ajax({type:"GET",dataType:"json",url:"https://wscraper.herokuapp.com/get_rss_feed",statusCode:{0:networkerror_status0,401:redirect_401},data:{url:i,with_entries:!1},success:function(e,t,i){if(!e||"success"!=e.status)return this.error(i,"error",e&&e.message||"Could not create feed","error");var n=e.data||{},o=n.title||"New Feed",r=n.description||"";r=140<r.length?r.substring(0,137)+"...":r,a.attr("url",n.url),a.attr("status","step3"),a.find(".category-feed.name").val(o).select(),note_character_counter.call(a.find(".category-feed.category-note").val(r))},error:function(e,t,i){a.attr("status","step1"),a.attr("last-act",""),show_flash_notice(i||"Invalid feed","error")}}))}function save_category_edit(e,t){if((t=t||$(e.target).closest(".card")).hasClass("new-card-template"))t.hasClass("category-type-feed")?(t.attr("status")||t.attr("status","step1"),"step1"==t.attr("status")?add_category_feed_url_submit(e,t):"step3"==t.attr("status")&&save_new_category(t)):save_new_category(t);else{var i=t.find(".card-description"),n=i.text(),o=t.find("textarea.category-note").val(),r=t.find(".card-title"),a=r.text(),s=t.find("input.name").val().trim(),l=t.attr("color"),c=t.find(".color-selected").attr("color")||l;if(s.length<1||a==s&&l==c&&o==n)cancel_category_edit(undefined,t);else{var d=t.attr("category-index");$.ajax({type:"PUT",url:"/categories",data:{"category[index]":d,"category[name]":s,"category[color]":c,"category[description]":o},statusCode:{0:networkerror_status0,401:redirect_401},success:function(){ga("send","event","category","update","success"),i.text(o),0==o.length?i.hide():i.show(),r.text(s),t.attr("color",c),t.attr("category-name",s),t.find(".title-description-container").css({"border-left-color":"#"+c}),cancel_category_edit(undefined,t);$('.nav-item-category[category-index="'+d+'"]').html(s);show_flash_notice('Category updated.<br/><div id="undo_action class="theme-text-color">undo</div>',"ok")},error:function(){ga("send","event","category","update","error"),show_flash_notice("Error updating category","error")}})}}}function cancel_category_edit(e,t){if((t=t||$(e.target).closest(".card")).hasClass("new-card-template")){var i=t.closest(".board");return t.hasClass("parent-category")?(t.closest(".category-container").remove(),0===i.find(".category-container").length&&i.find(".empty-board-overlay").show()):t.remove(),void(0===i.find(".card").length&&i.find(".empty-board-overlay, .command-import-bookmarks").show())}t.removeClass("category-editing"),t.find(".card-edit-mode").remove();var n=t.attr("color");t.find(".title-description-container").css({"border-left-color":"#"+n})}function edit_category_keyup(e){var t=e.which;27==t?cancel_category_edit(e):13==t&&save_category_edit(e)}function select_category_color(){var e=$(this);$(".title-color-select").removeClass("color-selected"),e.addClass("color-selected");var t=e.attr("color");e.closest(".card").find(".title-description-container").css({"border-left-color":"#"+t})}function category_type_link(){var e=$(this).closest(".new-card-template");e.hasClass("category-type-feed")&&e.removeClass("category-type-feed"),e.addClass("category-type-link")}function category_type_feed(){var e=$(this).closest(".new-card-template");e.hasClass("category-type-link")&&e.removeClass("category-type-link"),e.addClass("category-type-feed")}function trash_category(e,i){i||e||print_callstack(),i||(i=$(e.target).closest(".category"));var n,o=i.filter(".parent-category").closest(".category-container"),t=i.closest(".board");i.detach(),t.each(update_board_excess_links_toggle),n=25<i.length?"<b>"+i.length+" categories</b> removed":1<i.length?"<b>"+i.length+' categories</b> removed. <br/> <div id="undo_action" class="theme-text-color">undo</div>':"Category <b>"+name.substring(0,12)+'</b> removed. <br/> <div id="undo_action" class="theme-text-color">undo</div>';var r=i.map(function(e,t){return t.getAttribute("category-index")}).toArray();target=e.target.className,e.target.className.match("ui-droppable")?target="dropbox":e.target.className.match("delete-items-btn")?target="button":"remove-duplicate-categories-button"==e.target.id&&(target="remove_duplicates"),$.ajax({type:"DELETE",url:"/categories",data:{category_ids:r,target:target},statusCode:{0:networkerror_status0,401:redirect_401},success:function(){ga("send","event","category","delete","success",r.length),o.remove(),i.remove();for(var e=0;e<r.length;e++){var t=r[e];$('.nav-item-category[category-index="'+t+'"]').remove()}show_flash_notice(n,"delete")},error:function(){ga("send","event","category","delete","success"),show_flash_notice("Error when deleting category","error")}})}function remove_pinned_category(e){trash_category(e,$(this).closest(".card-unavailable"))}function update_categories_with_replacement(e){var n=$();$.each(e,function(e,t){var i=$(t);i.hasClass("category-container")?($('.card.parent-category[category-index="'+e+'"]').closest(".category-container").replaceWith(i),n=n.add(i)):i.hasClass("child-category")&&($('.card.child-category[category-index="'+e+'"]').replaceWith(i),n=n.add(i))}),n.register_new_category_listeners()}function register_flash_notice_listeners(){$(".flash-notice").click(hide_flash_notice)}function noticeOK(e){show_flash_notice(e,"ok")}function noticeERR(e){show_flash_notice(e,"error")}function show_flash_notice(e,t){var i=4e3;t&&"ok"!==t?"delete"===t?i=1e4:"error"===t&&(i=4e3):(t="ok",i=4e3);var n=$("#flash-notice");n.attr("status",t),n.find(".flash-notice-label").html(e),void 0!==undo_action&&n.find("#undo_action").click(undo_action),n.attr("state","2");var o=flash_notice_count+=1;setTimeout(function(){o==flash_notice_count&&hide_flash_notice()},i)}function hide_flash_notice(){var e=$("#flash-notice");e.attr("state","3"),setTimeout(function(){e.attr("state","1")},600)}function load_all_feeds(e){load_feeds((e=e||$(".board:visible")).find('.card:not([category-type="category"])'))}function load_feeds(e){e.each(function(){load_feed.call(this)})}function load_feed(){var a=$(this),s=a.attr("category-type"),e=a.attr("category-version"),l=Math.floor((new Date).getTime()/3600/1e3).toString();if(!(l==e&&0<a.find("ol .item-bookmark").size())&&s!==undefined)if("rss"==s||"google_news"==s){var c=(new Date).getTime();$.ajax({type:"GET",cache:!0,dataType:"json",url:"https://wscraper.herokuapp.com/get_rss_feed",data:{limit:25,url:a.attr("category-url")},success:function(e){if(e.status&&"success"!=e.status)return console.log("Error loading feed");var t=(new Date).getTime()-c;ga("send","timing","feed","load",t,a.attr("category-url"));var n=a.attr("category-index"),i=e.data.entries.map(function(e){var t=e.thumbnail_url_1||e.thumbnail_url_2||e.thumbnail_url_3;t="google_news"==s?t||"/assets/feed_icons/news.png":t||"/assets/shared_board_01/default-feed.png";var i=$('<li class="theme-item-border-color item-bookmark tooltip-enabled" tooltip-wrap="true" tooltip-position="pointer"><a rel="nofollow" class="theme-text-color" target="_blank" ga-label="BOOKMARK"><div class="item-icon" style="background-size: 100% 100%;"></div><div class="item-name"></div><div class="item-thumb"></div><span class="item-description theme-text-color"></span></a><var class="keywords" style="display:none"></var></li>');return i.attr("item-index",n).attr("url",e.url).attr("tooltip","<b>"+e.title+"</b><br/>"+e.url).find("a").attr("href",e.url).find(".item-icon").css("background-image","url("+t+")").end().find(".item-name").text(e.title).end().find(".item-thumb").css("background-image","url("+t+")").end().find(".item-description").text(e.title.substring(0,60)).end().end().find("var").attr("name",e.title).attr("url",e.url).text(e.title).end(),i[0].outerHTML}).join("");if(i){var o=a.find("ol"),r=o.find(".show-excess-links-button, .hide-excess-links-button").detach();o.html(i),o.find(".item-bookmark").register_item_listeners(),o.append(r),a.attr("category-version",l),"function"==typeof adjust_slot_height&&adjust_slot_height(),a.closest("#boards-container").length&&update_board_excess_links(a)}else a.find("ol .feed-loading").remove()},error:function(){console.log("Error loading feed")}})}else $.ajax({type:"GET",cache:!0,url:"/feeds/feed",data:{index:a.attr("category-index")},success:function(e){0!==$(e).filter(".item-bookmark").size()?(a.find("ol").html($(e)),a.find("ol .item-bookmark").register_item_listeners(),a.attr("category-version",l),a.closest("#boards-container").length&&update_board_excess_links(a),void 0!==adjust_slot_height&&adjust_slot_height()):a.find("ol .feed-loading").remove()},error:function(){console.log("Error loading feed")}})}function register_account_listeners(){$("#main").on("click",".logout, #logout",logout).on("click","#notifications",toggle_notifications_dropdown).on("click","#themes-settings",toggle_theme_and_background_settings).on("click","#user-options",toggle_user_options_dropdown).on("mouseleave","#notifications",hide_notifications_dropdown).on("mouseleave","#themes-settings",hide_theme_and_background_settings).on("mouseleave","#user-options",hide_user_dropdown_menu).on("click",".tutorial-reset-button",function(){try_call("reset_tutorial")}),register_refresh_account_listener(),register_notification_listener()}function register_refresh_account_listener(){$("#main").on("click mouseup contextmenu",".account-settings-link, .settings-link",function(){$(this).closest("#right-section").attr("refresh","true"),$(window).one("focus",refresh_settings)}),refresh_settings()}function hide_notifications_dropdown(){$("#main").removeClass("global-header-dropdown-shown"),$("#notifications").removeClass("dropdown-shown")}function hide_theme_and_background_settings(){$("#main").removeClass("global-header-dropdown-shown"),$("#themes-settings").removeClass("settings-shown"),$("#themes-settings").removeClass("dropdown-shown")}function hide_user_dropdown_menu(){$("#main").removeClass("global-header-dropdown-shown"),$("#user-options").removeClass("dropdown-shown")}function toggle_notifications_dropdown(){$("#main").toggleClass("global-header-dropdown-shown");var e=$(this);e.toggleClass("dropdown-shown"),e.hasClass("new-activity")&&(e.hasClass("main-ui-2021-1-finish-signup-notification")||$.ajax({method:"PUT",url:"/users/notifications",success:function(){e.removeClass("new-activity")}}))}function toggle_theme_and_background_settings(e){e&&e.target!=$("#themes-settings")[0]||($("#main").toggleClass("global-header-dropdown-shown"),$("#themes-settings").toggleClass("settings-shown"),$("#themes-settings").toggleClass("dropdown-shown"))}function toggle_user_options_dropdown(){$("#main").toggleClass("global-header-dropdown-shown"),$("#user-options").toggleClass("dropdown-shown")}function refresh_settings(e,a){e||$('#right-section[refresh="true"]').length?$.ajax({url:"/users/account_header",data:{main_ui:"ScreenMainUI"==$("body").attr("ga-screen")},success:function(e){var t=$(e),i=t.find("#right-section");$("#right-section").replaceWith(i);var n=t.filter("#param-container");$("#param-container").replaceWith(n),$("#right-section").removeAttr("refresh"),register_refresh_account_listener(),"true"==$("#param-container").find('[name="user[appearance_show_speed_dial]"]').attr("value")||"true"==$("#param-container").find('[name="user[topbar_shows_shortcuts]"]').attr("value")?($("#main").removeAttr("speed-dial-state"),$("#speed-dial-section").removeClass("shortcut-hidden")):($("#main").attr("speed-dial-state","hidden"),$("#speed-dial-section").addClass("shortcut-hidden")),"true"==$("#param-container").find('[name="user[appearance_show_inbox]"]').attr("value")?$("#main").removeAttr("inbox-state"):$("#main").attr("inbox-state","hidden");var o=$("#param-container").find('[name="user[appearance_font_size_category]"]').attr("value"),r=$("#param-container").find('[name="user[appearance_font_size_item]"]').attr("value");$("#main").attr("font-size-category",o).attr("font-size-item",r),a&&a()}}):a&&a()}function register_notifications_poller(){"Notification"in window?"granted"===Notification.permission?(ga("send","event","desktop notifications","alreadygranted"),initiate_polling()):"denied"===Notification.permission?ga("send","event","desktop notifications","alreadydenied"):(ga("send","event","desktop notifications","requested"),Notification.requestPermission(function(e){"granted"===e?(ga("send","event","desktop notifications","granted"),initiate_polling()):ga("send","event","desktop notifications","denied")})):ga("send","event","desktop notifications","notsupported")}function initiate_polling(){var e=2592e5,t=setInterval(poll,9e5);setTimeout(function(){clearInterval(t),console.log("Notification polling timed out")},e)}function poll(){$.ajax({type:"GET",url:"/users/notifications/new",cache:!1,statusCode:{401:redirect_401},success:function(e){var t=e&&e.results||[];$(t).each(generate_notification),t.length&&(refresh_settings(!0),ga("send","event","desktop notifications","show",t.length))},error:function(){ga("send","event","desktop notifications","pollerror")}})}function generate_notification(e,t){var i=new Notification(t.title,{body:t.body,icon:"/favicon.ico"});i.href=t.url.match(HOST_HTTPS)?t.url:HOST_HTTPS+t.url,i.onerror=function(){ga("send","event","desktop notifications","notificationerror",i.href)},i.onclick=function(){i.close(),i.href&&(ga("send","event","desktop notifications","click",i.href),open_url(i.href,!1))}}function register_notification_listener(){$("#main").on("click","#notifications .invite-accept",accept_coownership)}function accept_coownership(){var e=$(this);$.ajax({type:"POST",url:"/boards/accept_owner_invite",data:{invite_id:e.attr("invite-id")},success:function(){ga("send","event","notification","accept_coownership","success"),show_flash_notice("You are now a co owner of this board!","ok"),e.removeClass("selected").next().addClass("selected"),refresh_sidebar(!1,function(){select_and_refresh_board(e.attr("board-id"))})},error:function(){ga("send","event","notification","accept_coownership","error"),show_flash_notice("Error accepting board invite","error")}})}function register_sync(){sync_timeout()||refresh_sync_timeout(),$(window).on("focus",check_sync)}function check_sync(){var e=6e5;(new Date).getTime()>sync_timeout()+e&&(refresh_sync_timeout(),refresh_current_board(),refresh_link_bar())}function sync_timeout(){return+$("#main").attr("refresh_timeout")}function refresh_sync_timeout(){$("#main").attr("refresh_timeout",(new Date).getTime())}function reset_tutorial(){var t=0==$("#tutorial-walkthrough").length;$.ajax({type:"GET",url:"/features/tutorial_reset",data:t?{render:"tutorial-walkthrough"}:undefined,success:function(e){t&&$("#float-container").append(e),$("#param-container").find('[name="user[tutorial_drag_drop_shown]"]').attr("value","false"),$("#param-container").find('[name="user[tutorial_add_link_shown]"]').attr("value","false"),$("#param-container").find('[name="user[tutorial_inbox_shown]"]').attr("value","false"),$("#param-container").find('[name="user[tutorial_add_board_shown]"]').attr("value","false"),reload_tutorial(),reveal_tutorial_dialog(null,"tutorial-drag-drop")}})}function register_tutorial_listeners(){load_tutorial(),$(".next").click(tutorial_next),$(".back").click(tutorial_back),$(".skip").click(tutorial_skip),$(".done").click(remove_tutorial_dialog),$("#tutorial-dialog .close-dialog, .block-page").click(remove_tutorial_dialog),$(window).resize(adjust_pulsing_dots_and_dialog)}function reload_tutorial(){$("#tutorial-drag-drop").remove(),$("#tutorial-add-link").remove(),$("#tutorial-inbox").remove(),$("#tutorial-add-board").remove(),load_tutorial()}function load_tutorial(){"false"==$("#param-container").find('[name="user[tutorial_drag_drop_shown]"]').attr("value")&&request_tutorial("tutorial-drag-drop"),"false"==$("#param-container").find('[name="user[tutorial_add_link_shown]"]').attr("value")&&request_tutorial("tutorial-add-link"),"false"==$("#param-container").find('[name="user[tutorial_inbox_shown]"]').attr("value")&&request_tutorial("tutorial-inbox"),"false"==$("#param-container").find('[name="user[tutorial_add_board_shown]"]').attr("value")&&request_tutorial("tutorial-add-board")}function request_tutorial(e){$("#"+e).remove();var t=setUpTutorialButton($("#tutorial-template"),e);if(0<$(".board:visible").find(".card").length||"tutorial-drag-drop"!=e&&"tutorial-add-link"!=e){var i="true"==$("#param-container").find('[name="user[tutorial_drag_drop_shown]"]').attr("value"),n="true"==$("#param-container").find('[name="user[tutorial_add_link_shown]"]').attr("value"),o="true"==$("#param-container").find('[name="user[tutorial_inbox_shown]"]').attr("value"),r="true"==$("#param-container").find('[name="user[tutorial_add_board_shown]"]').attr("value");switch(e){case"tutorial-drag-drop":i||t.show(),t.attr("completed",i),t.click(reveal_tutorial_dialog),$(".board:visible").find(".card").first().append(t);break;case"tutorial-add-link":!n&&i&&t.show(),t.attr("completed",n),t.click(reveal_tutorial_dialog),$(".board:visible").find(".card").first().append(t);break;case"tutorial-inbox":!o&&i&&t.show(),t.attr("completed",o),t.click(reveal_tutorial_dialog),$("#inbox-section").find(".inner-section").append(t);break;case"tutorial-add-board":!r&&n&&i&&o&&t.show(),t.attr("completed",r),t.removeClass("pulsating-dot"),t.addClass("pulsating-dot-wt"),t.click(add_board),$("#nav-your-boards .float-group").append(t);break;default:console.log("Tutorial load error: "+e)}}}function setUpTutorialButton(e,t){var i=$(e).clone();return i.attr("id",t),i}function adjust_pulsing_dots_and_dialog(){adjust_dialog($("#tutorial-drag-drop")),adjust_dialog($("#tutorial-add-link")),adjust_dialog($("#tutorial-inbox"))}function adjust_dialog(e){if(e&&0<e.length&&0<$(".board:visible").find(".card").length){if((h=$("#tutorial-dialog")).removeClass("no-reference-point"),h.is(":visible")){var t;e.is(":visible")?t=e.offset():(e.show(),t=e.offset(),e.hide());var i=t.left;t.top}if("1"==h.attr("tutorial-state")){var n=(a=(r=$(".board:visible .category-slot.slot-0 .card").first()).offset()).left+r.width()/2,o=a.top;h.css({top:o+30,left:n+0}),$(".cards-container").css({"z-index":"101",position:"relative"}),$(window).width()<1103&&h.css({top:o+30,left:n+0}),$(window).width()<808&&h.css({top:"10px",left:"0",right:"0",margin:"auto"})}if("2"==h.attr("tutorial-state")){var r,a,s=(a=(r=$(".board:visible .category-slot.slot-0 .card").first()).offset()).left+r.width(),l=a.top;h.css({top:l+47,left:s-80}),$(".slot-0 .card:first-child").css({"z-index":"101",position:"relative","background-color":"#fff"}),$(".slot-0 .card:first-child .add-item-controls").css({display:"block"}),$(window).width()<808&&h.css({top:l+47,left:s-200}),$(window).width()<718&&h.css({top:l+47,left:s-370}),$(window).width()<624&&h.css({top:l+47,left:s-270}),h.offset().left+h.width()>$(window).width()?(h.css({left:"initial",right:"0"}),h.find(".outer-arrow").css("left",s-h.offset().left-60)):h.find(".outer-arrow").css("left",""),$(window).width()<568&&h.css({top:"10px",left:"0",right:"0"})}else h.find(".outer-arrow").css("left","");if("3"==h.attr("tutorial-state")){var c=$("#inbox-section").offset().left,d=$("#inbox-section").offset().top,u=0==c;h.css({top:d-7,left:i+35}),$("#inbox-section").css({"z-index":"101",position:"relative"}),$("#speed-dial-section").css({"z-index":"102",position:"relative"}),$(window).width()<964&&(h.css({top:d+40,left:c}),$("#inbox-section").css({"z-index":"101",position:"relative"})),$(window).width()<750&&(h.css({top:d+40,left:c-120}),$("#inbox-section").css({"z-index":"101",position:"relative"})),$(window).width()<624&&(h.css({top:d+40,left:c}),$("#inbox-section").css({"z-index":"101",position:"relative"})),u?(h.css({top:"10px",left:($(window).width()-h.width())/2}),h.find(".outer-arrow").css("left","8px"),h.find(".outer-arrow").css("top","0px")):(h.find(".outer-arrow").css("left",""),h.find(".outer-arrow").css("top","")),$(window).width()<568&&(h.css({top:"10px",left:"0",right:"0"}),$("#inbox-section").css({"z-index":"101",position:"relative"}))}else h.find(".outer-arrow").css("left",""),h.find(".outer-arrow").css("top","")}else{var h;(h=$("#tutorial-dialog")).addClass("no-reference-point"),h.css("left",""),h.css("top","")}}function show_drag_drop_tutorial(){"true"===$("#tutorial-drag-drop").attr("completed")?show_add_link_and_inbox_tutorial():$("#tutorial-drag-drop").show()}function show_add_link_and_inbox_tutorial(){"true"===$("#tutorial-add-link").attr("completed")&&"true"===$("#tutorial-inbox").attr("completed")?show_add_board_tutorial():("false"===$("#tutorial-add-link").attr("completed")&&$("#tutorial-add-link").show(),"false"===$("#tutorial-inbox").attr("completed")&&$("#tutorial-inbox").show())}function show_add_board_tutorial(){"false"===$("#tutorial-add-board").attr("completed")&&$("#tutorial-add-board").show()}function mark_tutorial_complete(e){$(e).each(function(e,t){$("#param-container").find('[name="user['+t+']"]').attr("value","true"),tutorial_tag="#"+t.replace("_shown","").replace(/_/g,"-"),$(tutorial_tag).attr("completed","true"),$(tutorial_tag).hide()}),$.ajax({type:"PUT",url:"/features/tutorial_completion",data:{tutorial_names:e}})}function drag_drop_tutorial_completed(){"false"===$("#param-container").find('[name="user[tutorial_drag_drop_shown]"]').attr("value")&&($("#param-container").find('[name="user[tutorial_drag_drop_shown]"]').attr("value","true"),show_add_link_and_inbox_tutorial(),mark_tutorial_complete(["tutorial_drag_drop_shown"]))}function add_link_tutorial_completed(){"false"===$("#param-container").find('[name="user[tutorial_add_link_shown]"]').attr("value")&&($("#param-container").find('[name="user[tutorial_add_link_shown]"]').attr("value","true"),0!=$("#tutorial-inbox").length&&"true"!==$("#tutorial-inbox").attr("completed")||show_add_board_tutorial(),mark_tutorial_complete(["tutorial_add_link_shown"]))}function inbox_tutorial_completed(){"false"===$("#param-container").find('[name="user[tutorial_inbox_shown]"]').attr("value")&&($("#param-container").find('[name="user[tutorial_inbox_shown]"]').attr("value","true"),0!=$("#tutorial-add-link").length&&"true"!==$("#tutorial-add-link").attr("completed")||show_add_board_tutorial(),mark_tutorial_complete(["tutorial_inbox_shown"]))}function add_board_tutorial_completed(){"false"===$("#param-container").find('[name="user[tutorial_add_board_shown]"]').attr("value")&&($("#param-container").find('[name="user[tutorial_add_board_shown]"]').attr("value","true"),mark_tutorial_complete(["tutorial_add_board_shown"]))}function reveal_tutorial_dialog(e,t){var i=t&&$("#"+t)||$(this);t=t||i.attr("id");var n=$("#tutorial-dialog");"tutorial-drag-drop"==t&&(n.attr("tutorial-state","1"),drag_drop_tutorial_completed()),"tutorial-add-link"==t&&(n.attr("tutorial-state","2"),add_link_tutorial_completed()),"tutorial-inbox"==t&&(n.attr("tutorial-state","3"),inbox_tutorial_completed()),n.show(),0==i.length?n.addClass("no-reference-point"):n.removeClass("no-reference-point"),adjust_dialog(i),$(".block-page").show()}function tutorial_next(){var e=$("#tutorial-dialog").attr("tutorial-state"),t=parseInt(e)+1;$("#tutorial-dialog").attr("tutorial-state",t),2==t?(remove_tutorial_dialog(),add_link_tutorial_completed(),reveal_tutorial_dialog(null,"tutorial-add-link")):3==t&&(remove_tutorial_dialog(),inbox_tutorial_completed(),reveal_tutorial_dialog(null,"tutorial-inbox"))}function tutorial_back(){var e=$("#tutorial-dialog").attr("tutorial-state"),t=parseInt(e)-1;$("#tutorial-dialog").attr("tutorial-state",t),1==t?(remove_tutorial_dialog(),reveal_tutorial_dialog(null,"tutorial-drag-drop")):2==t&&(remove_tutorial_dialog(),add_link_tutorial_completed(),reveal_tutorial_dialog(null,"tutorial-add-link"))}function tutorial_skip(){mark_tutorial_complete(["tutorial_add_link_shown","tutorial_inbox_shown","tutorial_add_board_shown"]),remove_tutorial_dialog()}function remove_tutorial_dialog(){$("#tutorial-dialog").hide(),$(".block-page").hide(),$(".cards-container, #inbox-section, .slot-0 .card:first-child").css({"z-index":"",position:""}),$(".slot-0 .card:first-child .add-item-controls").css({display:""})}function register_rand_notice_listeners(e){0<$("#rand-notice").length?($("#rand-notice").on("click",".close, .link-button",hide_rand_notice).on("click","#go-to-review",go_review).on("click","#guest-register, #go-to-setting",go_setting).on("click","#go-to-uservoice",function(){window.open("https://papaly.freshdesk.com/")}),show_rand_notice(e)):load_rand_notice_from_server(function(){$("#rand-notice").length&&register_rand_notice_listeners(e)})}function load_rand_notice_from_server(n){$.ajax({type:"GET",url:"/dialog/rand_notice",success:function(e){var t=$("#float-container");if(0<t.length){var i=$("#rand-notice");0<i.length?i.replaceWith(e):t.append(e)}n&&n()}})}function hide_rand_notice(e,t){var i=$("#rand-notice");t&&(i=$('#rand-notice[count="'+t+'"]')),0<i.size()&&(i.attr("state","3"),setTimeout(function(){i.attr("state","1")},600))}function go_setting(){var e=$(this);setTimeout(function(){e.parents(".rand-notice-msg").remove()},1e3),window.location.href="/settings"}function guest_register(){var e=$(this);setTimeout(function(){e.parents(".rand-notice-msg").remove()},1e3),hide_rand_notice(),console.debug("TODO: register the guest user")}function go_review(){$.ajax({url:"/users/chrome_review_clicked",type:"GET",dataType:"json"});var e="https://chrome.google.com/webstore/detail/new-tab-bookmark-speed-di/pdcohkhhjbifkmpakaiopnllnddofbbn/reviews";window.open(e,"_blank").focus(),hide_rand_notice()}function show_rand_notice(e){e=e||1,e=Math.max(1e-5,e);var t=$("#rand-notice"),n=0,o=Math.random()/e,r=$("#param-container");t.find(".rand-notice-msg").hide().each(function(){var e=r.find('[name="'+this.id+'"]'),t=parseFloat(e.attr("value"));if(!isNaN(t)&&o<(n+=t)){e.attr("value",0),$(this).show();var i=$("#rand-notice");return i.attr("status",status),i.attr("state","2"),rand_notice_count+=1,i.attr("count",rand_notice_count),setTimeout(function(){hide_rand_notice(null,rand_notice_count)},RAND_NOTICE_DURATION),$.ajax({type:"PUT",cache:!1,url:"/users/rand_notice_shown",data:{notice:this.id}}),!1}}),0==t.find(".rand-notice-msg:visible").length&&hide_rand_notice()}function register_main_ui_listeners(){register_sidebar_listeners(),register_inbox_listeners(),register_speed_dial_listeners(),register_social_favorite_listeners(),register_comments_panel_listeners(),adjust_slot_height(),$(".board:visible").register_board_listeners(),register_edit_listeners(),$("#boards-container").on("click",".overflow-menu .open-all-icon",category_open_all).on("click",".followers",followers_clicked).on("click",".co-owners",co_owners_clicked).on("click",'.share-button[status="private"]',make_public_notice).on("mouseleave",".card",hide_category_dropdown).on("click",".card",hide_category_dropdown).on("click",".show-commands-right",show_commands_right).on("click",".toggle-notes",toggle_notes).on("click",".toggle-child-category",toggle_child_category).on("click",".overflow-menu .toggle-notes",toggle_item_notes_in_category).on("click",".xtn-notice .close",remove_extension_notice),register_shared_search_listeners(),register_account_listeners(),$("#main").on("click",click_anywhere_to_hide).on("keyup keydown","#master-search",internal_search).on("click",toggle_inbox_section).on("click",toggle_speed_dial_section).on("click",".toggle-link-bar",toggle_link_bar).on("click","#speed-dial-info-button",show_speed_dial_info).on("click","#inbox-info-button",show_inbox_info).on("click",new_board_input_handler).on("click",".theme-switch:not(.current-theme)",switch_ui_theme).on("click",".batch-action-button.disabled",show_batch_edit_info).on("click",".overflow-button",reveal_board_overflow_menu).on("mouseleave",".overflow-menu-window",hide_board_overflow_menu).on("mouseenter",".overflow-menu-window",clear_hide_board_overflow_menu_timeout).on("click","#themes-backgrounds-settings-container .image-thumb",select_board_bg).on("keyup","#custom-bg-image-url",activate_set_button).on("click","#speed-dial-bg-change-button.active",set_custom_background_url),$("#main-content").scroll(show_mini_link_bar),register_master_search_listeners(),$("#main").on("click","#have-account-notice .close",close_login_notice).on("click","#have-account-notice .login",login),adjust_shortcuts_size()}function adjust_category_mask(){var e=$(".card.category-editing .title-description-container").outerHeight();$(".item-container-mask").css("top",e)}function internal_search(){$(this).val().length<2?$("#main").removeClass("internal-search"):$("#main").addClass("internal-search")}function show_mini_link_bar(){var e=45;"inbox"==$("#main").attr("board-state")?e=1e4:$(window).width()<371&&"true"==$("#main-content").attr("guest-account")&&(e=79),$(this).scrollTop()>e&&"inbox-expanded"!==$("#link-bar").attr("state")&&"hidden"!==$("#main").attr("link-bar-state")&&"speed-dial-expanded"!==$("#link-bar").attr("state")&&"speeddial"!==$("#main").attr("board-state")?($("#link-bar").addClass("mini-link-bar"),$("#main-content .container").css({"padding-top":"89px"})):($("#link-bar").removeClass("mini-link-bar"),$("#main-content .container").css({"padding-top":""})),5<$(this).scrollTop()?$("#global-header").addClass("shadow"):$("#global-header").removeClass("shadow"),$("#link-bar").hasClass("mini-link-bar")&&$("#global-header").removeClass("shadow")}function toggle_inbox_section(e){var t="expand-inbox-section"==e.target.id;if("inbox-expanded"==$("#link-bar").attr("state")&&(t||0===$(e.target).closest("#link-bar").length))return $("#link-bar").attr("state",""),void adjust_speed_dial_styles();t&&($("#link-bar").attr("state","inbox-expanded"),adjust_speed_dial_styles())}function toggle_speed_dial_section(e){var t="expand-speed-dial-section"==e.target.id;"speed-dial-expanded"!=$("#link-bar").attr("state")||!t&&0!==$(e.target).closest("#link-bar").length?t&&$("#link-bar").attr("state","speed-dial-expanded"):$("#link-bar").attr("state","")}function focus_search_bar(){$(this).find("#master-search").focus()}function toggle_link_bar(){"hidden"==$("#main").attr("link-bar-state")?$("#main").attr("link-bar-state",""):$("#main").attr("link-bar-state","hidden"),$.ajax({type:"PUT",url:"/users/linkbar_collapsed",data:{value:"hidden"==$("#main").attr("link-bar-state")}})}function show_speed_dial_info(){"on"==$("#speed-dial-section").attr("help-section")?$("#speed-dial-section").attr("help-section",""):$("#speed-dial-section").attr("help-section","on")}function show_inbox_info(){"on"==$("#inbox-section").attr("help-section")?$("#inbox-section").attr("help-section",""):$("#inbox-section").attr("help-section","on")}function show_batch_edit_info(){"on"==$(".batch-action-mask-container").attr("help-section")?$(".batch-action-mask-container").attr("help-section",""):$(".batch-action-mask-container").attr("help-section","on")}function switch_ui_theme(){var e=$(this),t=e.siblings(".current-theme").removeClass("current-theme"),i=t.length?t.attr("id").match(/\w+(?=-ui-switch)/)[0]:"transparent",n=e.addClass("current-theme").attr("id").match(/\w+(?=-ui-switch)/)[0];$("#custom-image-inline-styles").remove(),$.ajax({method:"PUT",url:"/users",data:{authenticity_token:CSRF_TOKEN,"user[theme]":n},success:function(){ga("send","event","user","update","success"),activate_set_button(),$("#themes-backgrounds-settings-container").find(".image-thumb").removeClass("selected"),switch_theme_stylesheet(n,i)},statusCode:{0:networkerror_status0,401:redirect_401},error:function(){ga("send","event","user","update","error"),show_flash_notice("Error when updating theme","error")}})}function register_inbox_listeners(){var e=$(
"#inbox-section");e.register_item_sortable(),e.find(".item-bookmark").register_item_listeners(),e.find(".item-container").on("DOMNodeInserted DOMNodeRemoved",function(e){var t=$(e.target);if(!t.hasClass("item-bookmark"))if(t.filter("#empty-inbox").length);else if(t.hasClass("bookmark-placeholder")){var i=$("#empty-inbox");0===i.filter(":last-child").length&&i.parent().append(i)}var n=$(this).find(".item-bookmark:not(.ui-sortable-helper)").length;$(".toggle-link-bar span").text(n)}),e.on("click",".item-select-box",select_item)}function click_anywhere_to_hide(e){hide_followers_list(e),hide_co_owners_list(e),hide_make_public_notice(e),hide_mobile_commands_right(e),hide_speed_dial_info(e),hide_weather_editing_location(e),hide_weather_editing_location_topbar(e),hide_inbox_info(e),hide_batch_action_info(e),hide_board_overflow_menu(e)}function select_inbox_recent(){document.location.hash="recent",document.title="Papaly | Inbox and Recent",gas("inbox_recent"),$("#main").attr("board-state","inbox"),$(".nav-item-selected").removeClass("nav-item-selected"),$("#speed-dial-section").attr("status",""),$("#social-favorites").hide(),$("#nav-inbox").addClass("nav-item-selected"),expand_inbox(),$("#main").hasClass("editing-on")?$("#inbox-section").attr("status","editing"):$("#inbox-section").attr("status","default"),$(".board").hide(),show_mini_link_bar();var i=$("#boards-container");i.find('.board[board-id="recent"]').show(),$.ajax({type:"GET",url:"/apps/recent",success:function(e){var t=$(e);i.find('.board[board-id="recent"]').remove(),i.append(t),t.show(),t.find(".item-bookmark").register_item_listeners(),try_call("xtn_fix_inbox_recent")},statusCode:{0:networkerror_status0,401:redirect_401},error:function(){}})}function select_and_refresh_board(e,r){refresh_sync_timeout();var t=$('#sidebar-nav .nav-section-item[board-id="'+e+'"]');$("#main").attr("board-state","board"),minimize_inbox(),$("#speed-dial-section").attr("status",""),clean_editing_state(),$("#main").attr("current-board-id",e);t.attr("board-version");if((r=r||t.attr("force_refresh"))||!t.hasClass("nav-item-selected")){t.removeAttr("force_refresh"),$(".card.selected").removeClass("selected"),$(".item-bookmark.selected").removeClass("selected");var i=$("#boards-container").find('.board[board-id="'+e+'"]'),a=i.length,s=null;a?(s=i.attr("board-version"),$(".board").hide(),i.show(),i.register_board_listeners(),adjust_slot_height(),document.title="Papaly | "+i.attr("board-name")):$(".card .item-name").css("color","#999"),$(".nav-section-item").removeClass("nav-item-selected"),t.addClass("nav-item-selected"),$.ajax({type:"GET",url:"/boards",data:{board_id:e,board_version:s,force_refresh:r},success:function(e,t,i){$(".card .item-name").css("color","");var n=$(e),o=n.attr("board-version");a&&o==s&&!r||(replace_board_with(n),adjust_slot_height()),check_sidebar_version(i.getResponseHeader("papaly-version-desk")),try_call("reload_tutorial"),adjust_shortcuts_size()},statusCode:{0:function(){i.length||networkerror_status0()},401:redirect_401},error:function(){$(".card .item-name").css("color","")}})}}function replace_board_with(e){e=$(e).filter(".board"),document.title="Papaly | "+e.attr("board-name"),setup_board(e)}function refresh_current_board(){var e=$("#sidebar-nav .nav-item-selected").attr("board-id");e&&select_and_refresh_board(e,!0)}function setup_board(e){if(0!==e.length){var t=e.attr("board-id"),i=e.attr("board-version"),n=e.attr("board-name"),o=$('.board[board-id="'+t+'"]');0===o.length?$("#boards-container").append(e):o.replaceWith(e),e.show().siblings(".board").hide(),e.register_board_listeners();var r=$('.nav-section-item[board-id="'+t+'"]');r.attr("board-version",i),r.find(".nav-item-board-name").html(n);var a=r.find(".nav-item-categories");a.find("li").remove(),e.find('.card:not(.feed)[pinned="false"]').each(function(){a.append($('<li class="nav-item-category ui-droppable" category-index="'+$(this).attr("category-index")+'">'+$(this).find(".card-title").html()+"</li>"))}),a.find("li").register_tab_category_droppable()}}function followers_clicked(){if(!$(".commands-right").hasClass("command-disabled")){var i=$(this).find(".followers-list");if(i.toggle(),i.is(":visible")&&"cached"!=i.attr("status")){var e=$(this).closest(".board").attr("board-id");$.ajax({type:"GET",url:"/boards/followers_list",data:{board_id:e},statusCode:{0:networkerror_status0,401:redirect_401},success:function(e){var t=$(e);i.find(".followers-list-container").html(t),i.attr("status","cached")},error:function(){show_flash_notice("Unable to load followers","error"),i.hide()}})}}}function co_owners_clicked(e){$(e.target).find(".co-owners-list").toggle()}function hide_followers_list(e){e&&$(e.target).closest(".followers").length||$(".followers-list").hide()}function hide_co_owners_list(e){e&&$(e.target).closest(".co-owners").length||$(".co-owners-list").hide()}function hide_board_overflow_menu(e){e&&$(e.target).closest(".overflow-button").length||$(".overflow-menu-window").hide()}function make_public_notice(){$(this).next().toggle()}function hide_make_public_notice(e){e&&$(e.target).closest(".share-button-container").length||$(".share-button-container .notice").hide()}function minimize_inbox(){reset_inbox_size("minimized"),check_mobile()&&$("#main").animate({scrollTop:0},0)}function expand_inbox(){reset_inbox_size("expanded")}function reset_inbox_size(e){var t=$("#inbox-section");e!==undefined&&t.attr("status",e)}function inbox_edit_toggle(){"default"==$("#inbox-section").attr("status")?$("#inbox-section").attr("status","editing"):$("#inbox-section").attr("status","default")}function hide_category_dropdown(e){e&&$(e.target).hasClass("overflow-icon")||$(this).find(".overflow-menu").hide()}function toggle_category_dropdown(){var e=$(this).closest(".title-description-container").find(".overflow-menu");e.toggle(),e.is(":visible")&&$(this).closest(".card").one("mouseleave",hide_category_dropdown).one("click",hide_category_dropdown)}function show_commands_right(){$("div.commands-right").toggleClass("hidden-on-mobile")}function toggle_notes(){"expanded"==$(this).closest(".item-bookmark").attr("note-status")?$(this).closest(".item-bookmark").attr("note-status","collapsed"):$(this).closest(".item-bookmark").attr("note-status","expanded")}function toggle_child_category(){var e=$(this).closest(".child-category"),t="collapsed"==e.attr("collapse-category")?"expanded":"collapsed";e.attr("collapse-category",t),"true"!=e.siblings(".parent-category").attr("pinned")&&$.ajax({method:"PUT",url:"/categories",data:{"category[index]":e.attr("category-index"),"category[collapse_category]":"collapsed"==t},statusCode:{401:redirect_401},success:function(){ga("send","event","category","toggle_collapse","success")},error:function(){ga("send","event","category","toggle_collapse","error")}})}function toggle_item_notes_in_category(){"all-expanded"==$(this).closest(".card").attr("item-notes-status")?$(this).closest(".card").attr("item-notes-status","all-collapsed").find(".item-bookmark").each(collapse_item_notes):$(this).closest(".card").attr("item-notes-status","all-expanded").find(".item-bookmark").each(expand_item_notes)}function remove_extension_notice(){$(".board .xtn-notice").remove()}function clear_hide_board_overflow_menu_timeout(){hide_board_overflow_menu_timeout&&clearTimeout(hide_board_overflow_menu_timeout)}function select_board_bg(){if(!$(this).hasClass("selected")){var e=$(".current-theme"),t=e.length?e.attr("id").match(/\w+(?=-ui-switch)/)[0]:"transparent",i=$("#main");$(this).closest("#themes-backgrounds-settings-container").find(".image-thumb").removeClass("selected"),$(this).addClass("selected");var n=$(this).attr("image-name");i.attr({"theme-background-image":n}),$("#custom-image-inline-styles").remove(),$.ajax({method:"PUT",url:"/users",data:{"user[background_image]":n,"user[theme]":"transparent"},statusCode:{0:networkerror_status0,401:redirect_401},success:function(){ga("send","event","board","update","success"),activate_set_button(),$(".theme-switch").removeClass("current-theme"),switch_theme_stylesheet("transparent",t)},error:function(){ga("send","event","board","update","error"),show_flash_notice("Could not update board background image","error")}})}}function activate_set_button(){$("#custom-bg-image-url").val()?$("#speed-dial-bg-change-button").addClass("active"):$("#speed-dial-bg-change-button").removeClass("active")}function set_custom_background_url(){var e=$(".current-theme"),t=e.length?e.attr("id").match(/\w+(?=-ui-switch)/)[0]:"transparent",i=$("#custom-bg-image-url").val(),n=$("#main");$("<img/>").attr("src",i).on("load",function(){$.ajax({method:"PUT",url:"/users",data:{"user[background_image]":"custom","user[custom_background_image_url]":i,"user[theme]":"transparent"},statusCode:{0:networkerror_status0,401:redirect_401},success:function(){ga("send","event","board","update","success"),n.attr({"theme-background-image":"custom"}),$("#themes-backgrounds-settings-container").find(".image-thumb").removeClass("selected"),$("#custom-image-inline-styles").remove(),$("body").prepend("            <style type='text/css' id='custom-image-inline-styles'>              #main[theme-background-image=\"custom\"],              #main[theme-background-image=\"custom\"] ~ .pac-container::before,              #global-header-background::before,              #notifications-dropdown::before,              #user-options .options-dropdown::before,              #themes-backgrounds-settings-container::before,              #speed-dial-section::before,              #inbox-section::before,              .board-commands .overflow-menu-window::before,              .board-commands .followers-list::before,              .board-commands #batch-action-info::before,              .board-properties::before,              .background-image-container::before,              .cards-container::before,              .title-description-container .overflow-menu::before,              #comments-link-panel::before,              #sidebar-background::before,              #nav-your-boards .collapsed-menu-section::before,              #boards-you-follow .collapsed-menu-section::before,              #add-category-template .dropdown-list::before {                background-image: url('"+i+"');                background-position: center bottom !important;              }              .background-image-container {                overflow: hidden;              }              .background-image-container::before,              .cards-container::before,              .title-description-container .overflow-menu::before {                display: block;              }            </style>          "),$("#speed-dial-bg-change-button").removeClass("active"),$(".theme-switch").removeClass("current-theme"),switch_theme_stylesheet("transparent",t)},error:function(){ga("send","event","board","update","error"),show_flash_notice("Could not update board background image","error")}}),$(this).remove()}).on("error",function(){show_flash_notice("Invalid Image URL","error"),$(this).remove()})}function reveal_board_overflow_menu(){$(this).next(".overflow-menu-window").toggle(),clear_hide_board_overflow_menu_timeout(),hide_board_overflow_menu_timeout=setTimeout(function(){hide_board_overflow_menu()},1e3)}function collapse_item_notes(){$(this).attr("note-status","collapsed")}function expand_item_notes(){$(this).attr("note-status","expanded")}function hide_mobile_commands_right(e){e&&$(e.target).closest(".show-commands-right").length||$("div.commands-right").addClass("hidden-on-mobile")}function hide_speed_dial_info(e){e&&$(e.target).closest("#speed-dial-section").length||$("#speed-dial-section").attr("help-section","")}function hide_weather_editing_location(e){e&&$(e.target).closest(".change-location, .weather-location-city, #time-weather-module .location-section").length||$("#time-weather-module").removeClass("editing-location")}function hide_weather_editing_location_topbar(e){e&&$(e.target).closest("#global-header .weather-container").length||$("#global-header .weather-container").removeClass("editing-location")}function hide_inbox_info(e){e&&$(e.target).closest("#inbox-section").length||$("#inbox-section").attr("help-section","")}function hide_batch_action_info(e){e&&0<$(e.target).closest(".batch-edit-buttons").length||$(".batch-action-mask-container").attr("help-section","")}function reveal_search(){$(".logo-search-container").addClass("mobile-search-active"),$("#master-search").focus()}function hide_search(){$(".logo-search-container").removeClass("mobile-search-active"),$("#master-search").val(""),$("#main").removeClass("internal-search")}function category_open_all(e){click_item(e,$(this).closest(".card").find(".item-bookmark").find("a"))}function adjust_slot_height(e){e===undefined&&(e=$(".board:visible")),adjust_board_slot_height(e)}function refresh_link_bar(){$.ajax({method:"GET",url:"/users/get_linkbar",success:function(e){ga("send","event","link bar","refresh","success"),replace_link_bar_with($(e))},statusCode:{401:redirect_401},error:function(){ga("send","event","link bar","refresh","error")}})}function replace_link_bar_with(e){var t=e.filter("#link-bar"),i=t.find("#inbox-section");if(i.length){var n=$("#inbox-section");i.attr("category-version")!==n.attr("category-version")&&(i.attr("status",n.attr("status")),n.replaceWith(i),register_inbox_listeners())}var o=t.find("#speed-dial-section");if(o.length){var r=$("#speed-dial-section");o.attr("category-version")!==r.attr("category-version")&&(o.attr("status",r.attr("status")),r.replaceWith(o),register_shortcut_sortable(),o.find(".shortcut-module").register_item_listeners(),adjust_shortcuts_size())}}function load_followed_boards(e,t,i){var n=[];$("#boards-you-follow .nav-section-item").each(function(){n.push($(this).attr("board-id"))}),$.ajax({type:"GET",url:"/boards/cache",data:{board_ids:n},success:function(e){var o=$("#boards-container");$(e).filter(".board").each(function(){var e=o.find('.board[board-id="'+$(this).attr("board-id")+'"]'),t=!!e.length,i=t?e.attr("board-version"):null,n=$(this).attr("board-version");t&&n==i||setup_board($(this))}),t&&t()},error:function(){show_flash_notice("Unable to load followed boards","error"),i&&i()}})}function close_login_notice(){$(this).closest("#have-account-notice").remove()}function login(e){load_dialog(e,"/dialog/login",function(){$("#dialog-popup").attr("switch-account",!0)})}function adjust_shortcuts_size(){var e=$("#speed-dial-section");if("speeddial"!=$("#main").attr("board-state")){var t=50,i=37,n=e.find(".shortcut-module").length,o=t*n,r=e.find("ul.ui-sortable").width(),a=$("#link-bar").width(),s=Math.floor(a/2-27),l=a/2;if(r<o){e.addClass("small-shortcuts");var c=Math.ceil(n/2)*i+27;e.width(c+1)}o<=s&&(e.removeClass("small-shortcuts"),e.prop("style").removeProperty("width")),e.width()>l&&e.prop("style").removeProperty("width")}else e.prop("style").removeProperty("width")}function switch_theme_stylesheet(e,t){if(e!=t){var i=$('link[href*="theme_'+t+'"]'),n=i.attr("data-theme-hashes");if(n){var o=JSON.parse(n);i.attr("href",i.attr("href").replace(/\/assets\/theme_[^\?]*\.css/,o[e]||"/assets/theme_"+e+".css"))}else i.attr("href",i.attr("href").replace(t,e))}}function register_login_listeners(){register_user_login_listener(),register_guest_login_listener(),register_register_login_listener(),register_connect_listeners(),register_reset_password_listener(),register_app_login_listener()}function register_user_login_listener(){$("form#user-login-form").bind("submit",function(e){e.preventDefault();var i=$(this),n=i.find('input[type="submit"]');n.attr("disabled","disabled"),block_app(),$.ajax({type:"POST",url:"/login.json",data:i.serialize(),statusCode:{401:function(e,t,i){this.error(e,t,i)}},success:function(e){n.removeAttr("disabled"),e&&"success"==e.status&&redirect_location("/")},error:function(e){var t=e.responseJSON&&e.responseJSON.error;t&&i.find("#devise-notice").text(t),i.find("#devise-notice").show(),i.find("input#user_email").focus(),release_block(),n.removeAttr("disabled")}})})}function register_guest_login_listener(){$("form.guest-login-form").bind("submit",function(e){e.preventDefault();var t=$(this),i=t.find('input[type="submit"]');i.attr("disabled","disabled"),block_app(),$.ajax({type:"POST",url:"/guest.json",data:guest_login_get_data(t),success:function(){i.removeAttr("disabled"),redirect_location("/")},error:function(){release_block()}})})}function guest_login_get_data(e){var t=e.find("input#user_email").val(),i=e.find('input[name="authenticity_token"]').val(),n=e.find("input#user_password").val(),o=e.find("input#user_password_confirmation").val();return t=t?t.trim():"",{authenticity_token:i=i?i.trim():"",email:t,user:{email:t,password:n=n?n.trim():"",password_confirmation:o=o?o.trim():""}}}function register_register_login_listener(){$("form.register-form").bind("submit",function(e){if(e.preventDefault(),"undefined"==typeof grecaptcha||grecaptcha.getResponse()){var i=$(this),n=i.find('input[type="submit"]');n.attr("disabled","disabled"),block_app(),$.ajax({type:"POST",url:"/register.json",data:i.serialize(),success:function(){n.removeAttr("disabled"),redirect_location("/")},error:function(e){var t=e.responseJSON&&e.responseJSON.error;t&&i.find("#devise-notice").text(t),i.find("#devise-notice").show(),i.find("input#user_email").focus(),release_block(),n.removeAttr("disabled")}})}else $("#devise-notice").text("Please fill in the reCAPTCHA.").show()})}function register_connect_listeners(){$("form.connect-form").bind("submit",function(e){e.preventDefault();var n=$(this),o=n.find('input[type="submit"]');o.attr("disabled","disabled"),block_app(),$.ajax({type:"PUT",url:"/users.json",data:n.serialize(),success:function(){redirect_location("/"),n.find('input[type="submit"]').removeAttr("disabled")},statusCode:{0:networkerror_status0,401:redirect_401},error:function(e){release_block(),o.removeAttr("disabled"),n.find("input").removeClass("invalid");var t=n.find("#devise-notice");t.show();var i=e.responseJSON&&(e.responseJSON.message||e.responseJSON.error)||"Error updating user, please try again";i.match(/match/)&&(n.find('input[name="user[password]"]').addClass("invalid"),n.find('input[name="user[password_confirmation]"]').addClass("invalid"),t.html("Password does not match")),i.match(/password is too short/)&&(n.find('input[name="user[password]"]').addClass("invalid"),n.find('input[name="user[password_confirmation]"]').addClass("invalid"),t.html("Password too short (mininum 6 characters)")),i.match(/email/)&&(n.find('input[name="user[email]"]').addClass("invalid"),t.html("Email taken")),i.match(/nickname/)&&(n.find('input[name="user[nickname]"]').addClass("invalid"),i.match(/only allow letters and numbers/)?t.html("Username can only have letters and numbers"):i.match(/too short/)?t.html("Username too short (minimum 5 characters)"):i.match(/taken|available/)&&t.html("Username is unavailble")),n.find("input.invalid:first").select()}})})}function register_reset_password_listener(){$("form#reset-password-form").bind("submit",function(e){e.preventDefault();var t=$(this),i=t.find('input[type="submit"]');return i.attr("disabled","disabled"),block_app(),$.ajax({type:"POST",url:"/reset_password.html",data:t.serialize(),success:function(e){release_block(),i.removeAttr("disabled"),t.find("input").removeClass("invalid"),e.match(/Email not found/)?(t.find("div#devise-notice").show(),t.find("input#user_email").addClass("invalid").focus()):load_dialog_success(e)}}),!1})}function register_app_login_listener(){$(".app-login-button").click(function(e){var t=$(this);e.preventDefault();var i={};$("#dialog-popup, #extension-login").attr("switch-account")&&(i.switch_account=!0);var n=t.attr("provider");papaly_app_authentication(n,function(e,t){t?display_not_user_account():papaly_app_authentication_complete(n,"success",window,function(){redirect_location(e||document.location.href)})},function(){papaly_app_authentication_complete(n,"failure",window)},i)})}!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(m,e){function s(e){var t=e.length,i=re.type(e);return"function"!==i&&!re.isWindow(e)&&(!(1!==e.nodeType||!t)||("array"===i||0===t||"number"==typeof t&&0<t&&t-1 in e))}function t(e,i,n){if(re.isFunction(i))return re.grep(e,function(e,t){return!!i.call(e,t,e)!==n});if(i.nodeType)return re.grep(e,function(e){return e===i!==n});if("string"==typeof i){if(fe.test(i))return re.filter(i,e,n);i=re.filter(i,e)}return re.grep(e,function(e){return 0<=re.inArray(e,i)!==n})}function i(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function h(e){var i=we[e]={};return re.each(e.match(ye)||[],function(e,t){i[t]=!0}),i}function o(){me.addEventListener?(me.removeEventListener("DOMContentLoaded",r,!1),m.removeEventListener("load",r,!1)):(me.detachEvent("onreadystatechange",r),m.detachEvent("onload",r))}function r(){(me.addEventListener||"load"===event.type||"complete"===me.readyState)&&(o(),re.ready())}function l(e,t,i){if(i===undefined&&1===e.nodeType){var n="data-"+t.replace(Ce,"-$1").toLowerCase();if("string"==typeof(i=e.getAttribute(n))){try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:xe.test(i)?re.parseJSON(i):i)}catch(o){}re.data(e,t,i)}else i=undefined}return i}function c(e){var t;for(t in e)if(("data"!==t||!re.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function n(e,t,i,n){if(re.acceptData(e)){var o,r,a=re.expando,s=e.nodeType,l=s?re.cache:e,c=s?e[a]:e[a]&&a;if(c&&l[c]&&(n||l[c].data)||i!==undefined||"string"!=typeof t)return c||(c=s?e[a]=G.pop()||re.guid++:a),l[c]||(l[c]=s?{}:{toJSON:re.noop}),"object"!=typeof t&&"function"!=typeof t||(n?l[c]=re.extend(l[c],t):l[c].data=re.extend(l[c].data,t)),r=l[c],n||(r.data||(r.data={}),r=r.data),i!==undefined&&(r[re.camelCase(t)]=i),"string"==typeof t?null==(o=r[t])&&(o=r[re.camelCase(t)]):o=r,o}}function a(e,t,i){if(re.acceptData(e)){var n,o,r=e.nodeType,a=r?re.cache:e,s=r?e[re.expando]:re.expando;if(a[s]){if(t&&(n=i?a[s]:a[s].data)){o=(t=re.isArray(t)?t.concat(re.map(t,re.camelCase)):t in n?[t]:(t=re.camelCase(t))in n?[t]:t.split(" ")).length;for(;o--;)delete n[t[o]];if(i?!c(n):!re.isEmptyObject(n))return}(i||(delete a[s].data,c(a[s])))&&(r?re.cleanData([e],!0):ne.deleteExpando||a!=a.window?delete a[s]:a[s]=null)}}}function d(){return!0}function u(){return!1}function f(){try{return me.activeElement}catch(e){}}function g(e){var t=De.split("|"),i=e.createDocumentFragment();if(i.createElement)for(;t.length;)i.createElement(t.pop());return i}function _(e,t){var i,n,o=0,r=typeof e.getElementsByTagName!==$e?e.getElementsByTagName(t||"*"):typeof e.querySelectorAll!==$e?e.querySelectorAll(t||"*"):undefined;if(!r)for(r=[],i=e.childNodes||e;null!=(n=i[o]);o++)!t||re.nodeName(n,t)?r.push(n):re.merge(r,_(n,t));return t===undefined||t&&re.nodeName(e,t)?re.merge([e],r):r}function v(e){Ae.test(e.type)&&(e.defaultChecked=e.checked)}function p(e,t){return re.nodeName(e,"table")&&re.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function b(e){return e.type=(null!==re.find.attr(e,"type"))+"/"+e.type,e}function y(e){var t=Xe.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function w(e,t){for(var i,n=0;null!=(i=e[n]);n++)re._data(i,"globalEval",!t||re._data(t[n],"globalEval"))}function k(e,t){if(1===t.nodeType&&re.hasData(e)){var i,n,o,r=re._data(e),a=re._data(t,r),s=r.events;if(s)for(i in delete a.handle,a.events={},s)for(n=0,o=s[i].length;n<o;n++)re.event.add(t,i,s[i][n]);a.data&&(a.data=re.extend({},a.data))}}function $(e,t){var i,n,o;if(1===t.nodeType){if(i=t.nodeName.toLowerCase(),!ne.noCloneEvent&&t[re.expando]){for(n in(o=re._data(t)).events)re.removeEvent(t,n,o.handle);t.removeAttribute(re.expando)}"script"===i&&t.text!==e.text?(b(t).text=e.text,y(t)):"object"===i?(t.parentNode&&(t.outerHTML=e.outerHTML),ne.html5Clone&&e.innerHTML&&!re.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===i&&Ae.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===i?t.defaultSelected=t.selected=e.defaultSelected:"input"!==i&&"textarea"!==i||(t.defaultValue=e.defaultValue)}}function x(e,t){var i=re(t.createElement(e)).appendTo(t.body),n=m.getDefaultComputedStyle?m.getDefaultComputedStyle(i[0]).display:re.css(i[0],"display");return i.detach(),n}function C(e){var t=me,i=it[e];return i||("none"!==(i=x(e,t))&&i||((t=((Ke=(Ke||re("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement))[0].contentWindow||Ke[0].contentDocument).document).write(),t.close(),i=x(e,t),Ke.detach()),it[e]=i),i}function T(t,i){return{get:function(){var e=t();if(null!=e){if(!e)return(this.get=i).apply(this,arguments);delete this.get}}}}function P(e,t){if(t in e)return t;for(var i=t.charAt(0).toUpperCase()+t.slice(1),n=t,o=mt.length;o--;)if((t=mt[o]+i)in e)return t;return n}function E(e,t){for(var i,n,o,r=[],a=0,s=e.length;a<s;a++)(n=e[a]).style&&(r[a]=re._data(n,"olddisplay"),i=n.style.display,t?(r[a]||"none"!==i||(n.style.display=""),""===n.style.display&&Ee(n)&&(r[a]=re._data(n,"olddisplay",C(n.nodeName)))):r[a]||(o=Ee(n),(i&&"none"!==i||!o)&&re._data(n,"olddisplay",o?i:re.css(n,"display"))));for(a=0;a<s;a++)(n=e[a]).style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?r[a]||"":"none"));return e}function N(e,t,i){var n=ut.exec(t);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):t}function A(e,t,i,n,o){for(var r=i===(n?"border":"content")?4:"width"===t?1:0,a=0;r<4;r+=2)"margin"===i&&(a+=re.css(e,i+Pe[r],!0,o)),n?("content"===i&&(a-=re.css(e,"padding"+Pe[r],!0,o)),"margin"!==i&&(a-=re.css(e,"border"+Pe[r]+"Width",!0,o))):(a+=re.css(e,"padding"+Pe[r],!0,o),"padding"!==i&&(a+=re.css(e,"border"+Pe[r]+"Width",!0,o)));return a}function S(e,t,i){var n=!0,o="width"===t?e.offsetWidth:e.offsetHeight,r=nt(e),a=ne.boxSizing()&&"border-box"===re.css(e,"boxSizing",!1,r);if(o<=0||null==o){if(((o=ot(e,t,r))<0||null==o)&&(o=e.style[t]),at.test(o))return o;n=a&&(ne.boxSizingReliable()||o===e.style[t]),o=parseFloat(o)||0}return o+A(e,t,i||(a?"border":"content"),n,r)+"px"}function I(e,t,i,n,o){return new I.prototype.init(e,t,i,n,o)}function L(){return setTimeout(function(){gt=undefined}),gt=re.now()}function O(e,t){var i,n={height:e},o=0;for(t=t?1:0;o<4;o+=2-t)n["margin"+(i=Pe[o])]=n["padding"+i]=e;return t&&(n.opacity=n.width=e),n}function j(e,t,i){for(var n,o=(Pt[t]||[]).concat(Pt["*"]),r=0,a=o.length;r<a;r++)if(n=o[r].call(i,t,e))return n}function D(t,e,i){var n,o,r,a,s,l,c,d,u=this,h={},f=t.style,p=t.nodeType&&Ee(t),m=re._data(t,"fxshow");for(n in i.queue||(null==(s=re._queueHooks(t,"fx")).unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,u.always(function(){u.always(function(){s.unqueued--,re.queue(t,"fx").length||s.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(i.overflow=[f.overflow,f.overflowX,f.overflowY],c=re.css(t,"display"),d=C(t.nodeName),"none"===c&&(c=d),"inline"===c&&"none"===re.css(t,"float")&&(ne.inlineBlockNeedsLayout&&"inline"!==d?f.zoom=1:f.display="inline-block")),i.overflow&&(f.overflow="hidden",ne.shrinkWrapBlocks()||u.always(function(){f.overflow=i.overflow[0],f.overflowX=i.overflow[1],f.overflowY=i.overflow[2]})),e)if(o=e[n],$t.exec(o)){if(delete e[n],r=r||"toggle"===o,o===(p?"hide":"show")){if("show"!==o||!m||m[n]===undefined)continue;p=!0}h[n]=m&&m[n]||re.style(t,n)}if(!re.isEmptyObject(h))for(n in m?"hidden"in m&&(p=m.hidden):m=re._data(t,"fxshow",{}),r&&(m.hidden=!p),p?re(t).show():u.done(function(){re(t).hide()}),u.done(function(){var e;for(e in re._removeData(t,"fxshow"),h)re.style(t,e,h[e])}),h)a=j(p?m[n]:0,n,u),n in m||(m[n]=a.start,p&&(a.end=a.start,a.start="width"===n||"height"===n?1:0))}function H(e,t){var i,n,o,r,a;for(i in e)if(o=t[n=re.camelCase(i)],r=e[i],re.isArray(r)&&(o=r[1],r=e[i]=r[0]),i!==n&&(e[n]=r,delete e[i]),(a=re.cssHooks[n])&&"expand"in a)for(i in r=a.expand(r),delete e[n],r)i in e||(e[i]=r[i],t[i]=o);else t[n]=o}function z(r,e,t){var i,a,n=0,o=Tt.length,s=re.Deferred().always(function(){delete l.elem}),l=function(){if(a)return!1;for(var e=gt||L(),t=Math.max(0,c.startTime+c.duration-e),i=1-(t/c.duration||0),n=0,o=c.tweens.length;n<o;n++)c.tweens[n].run(i);return s.notifyWith(r,[c,i,t]),i<1&&o?t:(s.resolveWith(r,[c]),!1)},c=s.promise({elem:r,props:re.extend({},e),opts:re.extend(!0,{specialEasing:{}},t),originalProperties:e,originalOptions:t,startTime:gt||L(),duration:t.duration,tweens:[],createTween:function(e,t){var i=re.Tween(r,c.opts,e,t,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(i),i},stop:function(e){var t=0,i=e?c.tweens.length:0;if(a)return this;for(a=!0;t<i;t++)c.tweens[t].run(1);return e?s.resolveWith(r,[c,e]):s.rejectWith(r,[c,e]),this}}),d=c.props;for(H(d,c.opts.specialEasing);n<o;n++)if(i=Tt[n].call(c,r,d,c.opts))return i;return re.map(d,j,c),re.isFunction(c.opts.start)&&c.opts.start.call(r,c),re.fx.timer(re.extend(l,{elem:r,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function W(r){return function(e,t){"string"!=typeof e&&(t=e,e="*");var i,n=0,o=e.toLowerCase().match(ye)||[];if(re.isFunction(t))for(;i=o[n++];)"+"===i.charAt(0)?(i=i.slice(1)||"*",(r[i]=r[i]||[]).unshift(t)):(r[i]=r[i]||[]).push(t)}}function R(t,o,r,a){function s(e){var n;return l[e]=!0,re.each(t[e]||[],function(e,t){var i=t(o,r,a);return"string"!=typeof i||c||l[i]?c?!(n=i):void 0:(o.dataTypes.unshift(i),s(i),!1)}),n}var l={},c=t===Kt;return s(o.dataTypes[0])||!l["*"]&&s("*")}function M(e,t){var i,n,o=re.ajaxSettings.flatOptions||{};for(n in t)t[n]!==undefined&&((o[n]?e:i||(i={}))[n]=t[n]);return i&&re.extend(!0,e,i),e}function q(e,t,i){for(var n,o,r,a,s=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),o===undefined&&(o=e.mimeType||t.getResponseHeader("Content-Type"));if(o)for(a in s)if(s[a]&&s[a].test(o)){l.unshift(a);break}if(l[0]in i)r=l[0];else{for(a in i){if(!l[0]||e.converters[a+" "+l[0]]){r=a;break}n||(n=a)}r=r||n}if(r)return r!==l[0]&&l.unshift(r),i[r]}function F(e,t,i,n){var o,r,a,s,l,c={},d=e.dataTypes.slice();if(d[1])for(a in e.converters)c[a.toLowerCase()]=e.converters[a];for(r=d.shift();r;)if(e.responseFields[r]&&(i[e.responseFields[r]]=t),!l&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=r,r=d.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(!(a=c[l+" "+r]||c["* "+r]))for(o in c)if((s=o.split(" "))[1]===r&&(a=c[l+" "+s[0]]||c["* "+s[0]])){!0===a?a=c[o]:!0!==c[o]&&(r=s[0],d.unshift(s[1]));break}if(!0!==a)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(u){return{state:"parsererror",error:a?u:"No conversion from "+l+" to "+r}}}return{state:"success",data:t}}function B(i,e,n,o){var t;if(re.isArray(e))re.each(e,function(e,t){n||ei.test(i)?o(i,t):B(i+"["+("object"==typeof t?e:"")+"]",t,n,o)});else if(n||"object"!==re.type(e))o(i,e);else for(t in e)B(i+"["+t+"]",e[t],n,o)}function U(){try{return new m.XMLHttpRequest}catch(e){}}function Y(){try{return new m.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function X(e){return re.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}var G=[],Q=G.slice,V=G.concat,K=G.push,J=G.indexOf,Z={},ee=Z.toString,te=Z.hasOwnProperty,ie="".trim,ne={},oe="1.11.0",re=function(e,t){return new re.fn.init(e,t)},ae=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,se=/^-ms-/,le=/-([\da-z])/gi,ce=function(e,t){return t.toUpperCase()};re.fn=re.prototype={jquery:oe,constructor:re,selector:"",length:0,toArray:function(){return Q.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:Q.call(this)},pushStack:function(e){var t=re.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return re.each(this,e,t)},map:function(i){return this.pushStack(re.map(this,function(e,t){return i.call(e,t,e)}))},slice:function(){return this.pushStack(Q.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(e<0?t:0);return this.pushStack(0<=i&&i<t?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:K,sort:G.sort,splice:G.splice},re.extend=re.fn.extend=function(e){var t,i,n,o,r,a,s=e||{},l=1,c=arguments.length,d=!1;for("boolean"==typeof s&&(d=s,s=arguments[l]||{},l++),"object"==typeof s||re.isFunction(s)||(s={}),l===c&&(s=this,l--);l<c;l++)if(null!=(r=arguments[l]))for(o in r)t=s[o],s!==(n=r[o])&&(d&&n&&(re.isPlainObject(n)||(i=re.isArray(n)))?(i?(i=!1,a=t&&re.isArray(t)?t:[]):a=t&&re.isPlainObject(t)?t:{},s[o]=re.extend(d,a,n)):n!==undefined&&(s[o]=n));return s},re.extend({expando:"jQuery"+(
oe+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===re.type(e)},isArray:Array.isArray||function(e){return"array"===re.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return 0<=e-parseFloat(e)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||"object"!==re.type(e)||e.nodeType||re.isWindow(e))return!1;try{if(e.constructor&&!te.call(e,"constructor")&&!te.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(i){return!1}if(ne.ownLast)for(t in e)return te.call(e,t);for(t in e);return t===undefined||te.call(e,t)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?Z[ee.call(e)]||"object":typeof e},globalEval:function(e){e&&re.trim(e)&&(m.execScript||function(e){m.eval.call(m,e)})(e)},camelCase:function(e){return e.replace(se,"ms-").replace(le,ce)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,i){var n=0,o=e.length,r=s(e);if(i){if(r)for(;n<o&&!1!==t.apply(e[n],i);n++);else for(n in e)if(!1===t.apply(e[n],i))break}else if(r)for(;n<o&&!1!==t.call(e[n],n,e[n]);n++);else for(n in e)if(!1===t.call(e[n],n,e[n]))break;return e},trim:ie&&!ie.call("\ufeff\xa0")?function(e){return null==e?"":ie.call(e)}:function(e){return null==e?"":(e+"").replace(ae,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(s(Object(e))?re.merge(i,"string"==typeof e?[e]:e):K.call(i,e)),i},inArray:function(e,t,i){var n;if(t){if(J)return J.call(t,e,i);for(n=t.length,i=i?i<0?Math.max(0,n+i):i:0;i<n;i++)if(i in t&&t[i]===e)return i}return-1},merge:function(e,t){for(var i=+t.length,n=0,o=e.length;n<i;)e[o++]=t[n++];if(i!=i)for(;t[n]!==undefined;)e[o++]=t[n++];return e.length=o,e},grep:function(e,t,i){for(var n=[],o=0,r=e.length,a=!i;o<r;o++)!t(e[o],o)!==a&&n.push(e[o]);return n},map:function(e,t,i){var n,o=0,r=e.length,a=[];if(s(e))for(;o<r;o++)null!=(n=t(e[o],o,i))&&a.push(n);else for(o in e)null!=(n=t(e[o],o,i))&&a.push(n);return V.apply([],a)},guid:1,proxy:function(e,t){var i,n,o;return"string"==typeof t&&(o=e[t],t=e,e=o),re.isFunction(e)?(i=Q.call(arguments,2),(n=function(){return e.apply(t||this,i.concat(Q.call(arguments)))}).guid=e.guid=e.guid||re.guid++,n):undefined},now:function(){return+new Date},support:ne}),re.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){Z["[object "+t+"]"]=t.toLowerCase()});var de=function(i){function y(e,t,i,n){var o,r,a,s,l,c,d,u,h,f;if((t?t.ownerDocument||t:R)!==I&&S(t),i=i||[],!e||"string"!=typeof e)return i;if(1!==(s=(t=t||I).nodeType)&&9!==s)return[];if(O&&!n){if(o=ve.exec(e))if(a=o[1]){if(9===s){if(!(r=t.getElementById(a))||!r.parentNode)return i;if(r.id===a)return i.push(r),i}else if(t.ownerDocument&&(r=t.ownerDocument.getElementById(a))&&z(t,r)&&r.id===a)return i.push(r),i}else{if(o[2])return Z.apply(i,t.getElementsByTagName(e)),i;if((a=o[3])&&$.getElementsByClassName&&t.getElementsByClassName)return Z.apply(i,t.getElementsByClassName(a)),i}if($.qsa&&(!j||!j.test(e))){if(u=d=W,h=t,f=9===s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){for(c=g(e),(d=t.getAttribute("id"))?u=d.replace(ye,"\\$&"):t.setAttribute("id",u),u="[id='"+u+"'] ",l=c.length;l--;)c[l]=u+_(c[l]);h=be.test(e)&&m(t.parentNode)||t,f=c.join(",")}if(f)try{return Z.apply(i,h.querySelectorAll(f)),i}catch(p){}finally{d||t.removeAttribute("id")}}}return k(e.replace(le,"$1"),t,i,n)}function e(){function i(e,t){return n.push(e+" ")>x.cacheLength&&delete i[n.shift()],i[e+" "]=t}var n=[];return i}function l(e){return e[W]=!0,e}function n(e){var t=I.createElement("div");try{return!!e(t)}catch(i){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function t(e,t){for(var i=e.split("|"),n=e.length;n--;)x.attrHandle[i[n]]=t}function c(e,t){var i=t&&e,n=i&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||G)-(~e.sourceIndex||G);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function o(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function r(i){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===i}}function a(a){return l(function(r){return r=+r,l(function(e,t){for(var i,n=a([],e.length,r),o=n.length;o--;)e[i=n[o]]&&(e[i]=!(t[i]=e[i]))})})}function m(e){return e&&typeof e.getElementsByTagName!==X&&e}function s(){}function g(e,t){var i,n,o,r,a,s,l,c=B[e+" "];if(c)return t?0:c.slice(0);for(a=e,s=[],l=x.preFilter;a;){for(r in i&&!(n=ce.exec(a))||(n&&(a=a.slice(n[0].length)||a),s.push(o=[])),i=!1,(n=de.exec(a))&&(i=n.shift(),o.push({value:i,type:n[0].replace(le," ")}),a=a.slice(i.length)),x.filter)!(n=pe[r].exec(a))||l[r]&&!(n=l[r](n))||(i=n.shift(),o.push({value:i,type:r,matches:n}),a=a.slice(i.length));if(!i)break}return t?a.length:a?y.error(e):B(e,s).slice(0)}function _(e){for(var t=0,i=e.length,n="";t<i;t++)n+=e[t].value;return n}function u(a,e,t){var s=e.dir,l=t&&"parentNode"===s,c=q++;return e.first?function(e,t,i){for(;e=e[s];)if(1===e.nodeType||l)return a(e,t,i)}:function(e,t,i){var n,o,r=[M,c];if(i){for(;e=e[s];)if((1===e.nodeType||l)&&a(e,t,i))return!0}else for(;e=e[s];)if(1===e.nodeType||l){if((n=(o=e[W]||(e[W]={}))[s])&&n[0]===M&&n[1]===c)return r[2]=n[2];if((o[s]=r)[2]=a(e,t,i))return!0}}}function h(o){return 1<o.length?function(e,t,i){for(var n=o.length;n--;)if(!o[n](e,t,i))return!1;return!0}:o[0]}function w(e,t,i,n,o){for(var r,a=[],s=0,l=e.length,c=null!=t;s<l;s++)(r=e[s])&&(i&&!i(r,n,o)||(a.push(r),c&&t.push(s)));return a}function v(f,p,m,g,_,e){return g&&!g[W]&&(g=v(g)),_&&!_[W]&&(_=v(_,e)),l(function(e,t,i,n){var o,r,a,s=[],l=[],c=t.length,d=e||b(p||"*",i.nodeType?[i]:i,[]),u=!f||!e&&p?d:w(d,s,f,i,n),h=m?_||(e?f:c||g)?[]:t:u;if(m&&m(u,h,i,n),g)for(o=w(h,l),g(o,[],i,n),r=o.length;r--;)(a=o[r])&&(h[l[r]]=!(u[l[r]]=a));if(e){if(_||f){if(_){for(o=[],r=h.length;r--;)(a=h[r])&&o.push(u[r]=a);_(null,h=[],o,n)}for(r=h.length;r--;)(a=h[r])&&-1<(o=_?te.call(e,a):s[r])&&(e[o]=!(t[o]=a))}}else h=w(h===t?h.splice(c,h.length):h),_?_(null,t,h,n):Z.apply(t,h)})}function f(e){for(var n,t,i,o=e.length,r=x.relative[e[0].type],a=r||x.relative[" "],s=r?1:0,l=u(function(e){return e===n},a,!0),c=u(function(e){return-1<te.call(n,e)},a,!0),d=[function(e,t,i){return!r&&(i||t!==E)||((n=t).nodeType?l(e,t,i):c(e,t,i))}];s<o;s++)if(t=x.relative[e[s].type])d=[u(h(d),t)];else{if((t=x.filter[e[s].type].apply(null,e[s].matches))[W]){for(i=++s;i<o&&!x.relative[e[i].type];i++);return v(1<s&&h(d),1<s&&_(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(le,"$1"),t,s<i&&f(e.slice(s,i)),i<o&&f(e=e.slice(i)),i<o&&_(e))}d.push(t)}return h(d)}function d(g,_){var v=0<_.length,b=0<g.length,e=function(e,t,i,n,o){var r,a,s,l=0,c="0",d=e&&[],u=[],h=E,f=e||b&&x.find.TAG("*",o),p=M+=null==h?1:Math.random()||.1,m=f.length;for(o&&(E=t!==I&&t);c!==m&&null!=(r=f[c]);c++){if(b&&r){for(a=0;s=g[a++];)if(s(r,t,i)){n.push(r);break}o&&(M=p)}v&&((r=!s&&r)&&l--,e&&d.push(r))}if(l+=c,v&&c!==l){for(a=0;s=_[a++];)s(d,u,t,i);if(e){if(0<l)for(;c--;)d[c]||u[c]||(u[c]=K.call(n));u=w(u)}Z.apply(n,u),o&&!e&&0<u.length&&1<l+_.length&&y.uniqueSort(n)}return o&&(M=p,E=h),d};return v?l(e):e}function b(e,t,i){for(var n=0,o=t.length;n<o;n++)y(e,t[n],i);return i}function k(e,t,i,n){var o,r,a,s,l,c=g(e);if(!n&&1===c.length){if(2<(r=c[0]=c[0].slice(0)).length&&"ID"===(a=r[0]).type&&$.getById&&9===t.nodeType&&O&&x.relative[r[1].type]){if(!(t=(x.find.ID(a.matches[0].replace(we,ke),t)||[])[0]))return i;e=e.slice(r.shift().value.length)}for(o=pe.needsContext.test(e)?0:r.length;o--&&(a=r[o],!x.relative[s=a.type]);)if((l=x.find[s])&&(n=l(a.matches[0].replace(we,ke),be.test(r[0].type)&&m(t.parentNode)||t))){if(r.splice(o,1),!(e=n.length&&_(r)))return Z.apply(i,n),i;break}}return P(e,c)(n,t,!O,i,be.test(e)&&m(t.parentNode)||t),i}var p,$,x,C,T,P,E,N,A,S,I,L,O,j,D,H,z,W="sizzle"+-new Date,R=i.document,M=0,q=0,F=e(),B=e(),U=e(),Y=function(e,t){return e===t&&(A=!0),0},X=typeof undefined,G=1<<31,Q={}.hasOwnProperty,V=[],K=V.pop,J=V.push,Z=V.push,ee=V.slice,te=V.indexOf||function(e){for(var t=0,i=this.length;t<i;t++)if(this[t]===e)return t;return-1},ie="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ne="[\\x20\\t\\r\\n\\f]",oe="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",re=oe.replace("w","w#"),ae="\\["+ne+"*("+oe+")"+ne+"*(?:([*^$|!~]?=)"+ne+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+re+")|)|)"+ne+"*\\]",se=":("+oe+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+ae.replace(3,8)+")*)|.*)\\)|)",le=new RegExp("^"+ne+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ne+"+$","g"),ce=new RegExp("^"+ne+"*,"+ne+"*"),de=new RegExp("^"+ne+"*([>+~]|"+ne+")"+ne+"*"),ue=new RegExp("="+ne+"*([^\\]'\"]*?)"+ne+"*\\]","g"),he=new RegExp(se),fe=new RegExp("^"+re+"$"),pe={ID:new RegExp("^#("+oe+")"),CLASS:new RegExp("^\\.("+oe+")"),TAG:new RegExp("^("+oe.replace("w","w*")+")"),ATTR:new RegExp("^"+ae),PSEUDO:new RegExp("^"+se),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ne+"*(even|odd|(([+-]|)(\\d*)n|)"+ne+"*(?:([+-]|)"+ne+"*(\\d+)|))"+ne+"*\\)|)","i"),bool:new RegExp("^(?:"+ie+")$","i"),needsContext:new RegExp("^"+ne+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ne+"*((?:-\\d)?\\d*)"+ne+"*\\)|)(?=[^-]|$)","i")},me=/^(?:input|select|textarea|button)$/i,ge=/^h\d$/i,_e=/^[^{]+\{\s*\[native \w/,ve=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,be=/[+~]/,ye=/'|\\/g,we=new RegExp("\\\\([\\da-f]{1,6}"+ne+"?|("+ne+")|.)","ig"),ke=function(e,t,i){var n="0x"+t-65536;return n!=n||i?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)};try{Z.apply(V=ee.call(R.childNodes),R.childNodes),V[R.childNodes.length].nodeType}catch($e){Z={apply:V.length?function(e,t){J.apply(e,ee.call(t))}:function(e,t){for(var i=e.length,n=0;e[i++]=t[n++];);e.length=i-1}}}for(p in $=y.support={},T=y.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},S=y.setDocument=function(e){var t,l=e?e.ownerDocument||e:R,i=l.defaultView;return l!==I&&9===l.nodeType&&l.documentElement?(L=(I=l).documentElement,O=!T(l),i&&i!==i.top&&(i.addEventListener?i.addEventListener("unload",function(){S()},!1):i.attachEvent&&i.attachEvent("onunload",function(){S()})),$.attributes=n(function(e){return e.className="i",!e.getAttribute("className")}),$.getElementsByTagName=n(function(e){return e.appendChild(l.createComment("")),!e.getElementsByTagName("*").length}),$.getElementsByClassName=_e.test(l.getElementsByClassName)&&n(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),$.getById=n(function(e){return L.appendChild(e).id=W,!l.getElementsByName||!l.getElementsByName(W).length}),$.getById?(x.find.ID=function(e,t){if(typeof t.getElementById!==X&&O){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},x.filter.ID=function(e){var t=e.replace(we,ke);return function(e){return e.getAttribute("id")===t}}):(delete x.find.ID,x.filter.ID=function(e){var i=e.replace(we,ke);return function(e){var t=typeof e.getAttributeNode!==X&&e.getAttributeNode("id");return t&&t.value===i}}),x.find.TAG=$.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!==X)return t.getElementsByTagName(e)}:function(e,t){var i,n=[],o=0,r=t.getElementsByTagName(e);if("*"!==e)return r;for(;i=r[o++];)1===i.nodeType&&n.push(i);return n},x.find.CLASS=$.getElementsByClassName&&function(e,t){if(typeof t.getElementsByClassName!==X&&O)return t.getElementsByClassName(e)},D=[],j=[],($.qsa=_e.test(l.querySelectorAll))&&(n(function(e){e.innerHTML="<select t=''><option selected=''></option></select>",e.querySelectorAll("[t^='']").length&&j.push("[*^$]="+ne+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||j.push("\\["+ne+"*(?:value|"+ie+")"),e.querySelectorAll(":checked").length||j.push(":checked")}),n(function(e){var t=l.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&j.push("name"+ne+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||j.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),j.push(",.*:")})),($.matchesSelector=_e.test(H=L.webkitMatchesSelector||L.mozMatchesSelector||L.oMatchesSelector||L.msMatchesSelector))&&n(function(e){$.disconnectedMatch=H.call(e,"div"),H.call(e,"[s!='']:x"),D.push("!=",se)}),j=j.length&&new RegExp(j.join("|")),D=D.length&&new RegExp(D.join("|")),t=_e.test(L.compareDocumentPosition),z=t||_e.test(L.contains)?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},Y=t?function(e,t){if(e===t)return A=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i||(1&(i=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!$.sortDetached&&t.compareDocumentPosition(e)===i?e===l||e.ownerDocument===R&&z(R,e)?-1:t===l||t.ownerDocument===R&&z(R,t)?1:N?te.call(N,e)-te.call(N,t):0:4&i?-1:1)}:function(e,t){if(e===t)return A=!0,0;var i,n=0,o=e.parentNode,r=t.parentNode,a=[e],s=[t];if(!o||!r)return e===l?-1:t===l?1:o?-1:r?1:N?te.call(N,e)-te.call(N,t):0;if(o===r)return c(e,t);for(i=e;i=i.parentNode;)a.unshift(i);for(i=t;i=i.parentNode;)s.unshift(i);for(;a[n]===s[n];)n++;return n?c(a[n],s[n]):a[n]===R?-1:s[n]===R?1:0},l):I},y.matches=function(e,t){return y(e,null,null,t)},y.matchesSelector=function(e,t){if((e.ownerDocument||e)!==I&&S(e),t=t.replace(ue,"='$1']"),$.matchesSelector&&O&&(!D||!D.test(t))&&(!j||!j.test(t)))try{var i=H.call(e,t);if(i||$.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch($e){}return 0<y(t,I,null,[e]).length},y.contains=function(e,t){return(e.ownerDocument||e)!==I&&S(e),z(e,t)},y.attr=function(e,t){(e.ownerDocument||e)!==I&&S(e);var i=x.attrHandle[t.toLowerCase()],n=i&&Q.call(x.attrHandle,t.toLowerCase())?i(e,t,!O):undefined;return n!==undefined?n:$.attributes||!O?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},y.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},y.uniqueSort=function(e){var t,i=[],n=0,o=0;if(A=!$.detectDuplicates,N=!$.sortStable&&e.slice(0),e.sort(Y),A){for(;t=e[o++];)t===e[o]&&(n=i.push(o));for(;n--;)e.splice(i[n],1)}return N=null,e},C=y.getText=function(e){var t,i="",n=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=C(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[n++];)i+=C(t);return i},(x=y.selectors={cacheLength:50,createPseudo:l,match:pe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(we,ke),e[3]=(e[4]||e[5]||"").replace(we,ke),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||y.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&y.error(e[0]),e},PSEUDO:function(e){var t,i=!e[5]&&e[2];return pe.CHILD.test(e[0])?null:(e[3]&&e[4]!==undefined?e[2]=e[4]:i&&he.test(i)&&(t=g(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(we,ke).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=F[e+" "];return t||(t=new RegExp("(^|"+ne+")"+e+"("+ne+"|$)"))&&F(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==X&&e.getAttribute("class")||"")})},ATTR:function(i,n,o){return function(e){var t=y.attr(e,i);return null==t?"!="===n:!n||(t+="","="===n?t===o:"!="===n?t!==o:"^="===n?o&&0===t.indexOf(o):"*="===n?o&&-1<t.indexOf(o):"$="===n?o&&t.slice(-o.length)===o:"~="===n?-1<(" "+t+" ").indexOf(o):"|="===n&&(t===o||t.slice(0,o.length+1)===o+"-"))}},CHILD:function(f,e,t,p,m){var g="nth"!==f.slice(0,3),_="last"!==f.slice(-4),v="of-type"===e;return 1===p&&0===m?function(e){return!!e.parentNode}:function(e,t,i){var n,o,r,a,s,l,c=g!==_?"nextSibling":"previousSibling",d=e.parentNode,u=v&&e.nodeName.toLowerCase(),h=!i&&!v;if(d){if(g){for(;c;){for(r=e;r=r[c];)if(v?r.nodeName.toLowerCase()===u:1===r.nodeType)return!1;l=c="only"===f&&!l&&"nextSibling"}return!0}if(l=[_?d.firstChild:d.lastChild],_&&h){for(s=(n=(o=d[W]||(d[W]={}))[f]||[])[0]===M&&n[1],a=n[0]===M&&n[2],r=s&&d.childNodes[s];r=++s&&r&&r[c]||(a=s=0)||l.pop();)if(1===r.nodeType&&++a&&r===e){o[f]=[M,s,a];break}}else if(h&&(n=(e[W]||(e[W]={}))[f])&&n[0]===M)a=n[1];else for(;(r=++s&&r&&r[c]||(a=s=0)||l.pop())&&((v?r.nodeName.toLowerCase()!==u:1!==r.nodeType)||!++a||(h&&((r[W]||(r[W]={}))[f]=[M,a]),r!==e)););return(a-=m)===p||a%p==0&&0<=a/p}}},PSEUDO:function(e,r){var t,a=x.pseudos[e]||x.setFilters[e.toLowerCase()]||y.error("unsupported pseudo: "+e);return a[W]?a(r):1<a.length?(t=[e,e,"",r],x.setFilters.hasOwnProperty(e.toLowerCase())?l(function(e,t){for(var i,n=a(e,r),o=n.length;o--;)e[i=te.call(e,n[o])]=!(t[i]=n[o])}):function(e){return a(e,0,t)}):a}},pseudos:{not:l(function(e){var n=[],o=[],s=P(e.replace(le,"$1"));return s[W]?l(function(e,t,i,n){for(var o,r=s(e,null,n,[]),a=e.length;a--;)(o=r[a])&&(e[a]=!(t[a]=o))}):function(e,t,i){return n[0]=e,s(n,null,i,o),!o.pop()}}),has:l(function(t){return function(e){return 0<y(t,e).length}}),contains:l(function(t){return function(e){return-1<(e.textContent||e.innerText||C(e)).indexOf(t)}}),lang:l(function(i){return fe.test(i||"")||y.error("unsupported lang: "+i),i=i.replace(we,ke).toLowerCase(),function(e){var t;do{if(t=O?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===i||0===t.indexOf(i+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=i.location&&i.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===L},focus:function(e){return e===I.activeElement&&(!I.hasFocus||I.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!x.pseudos.empty(e)},header:function(e){return ge.test(e.nodeName)},input:function(e){return me.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:a(function(){return[0]}),last:a(function(e,t){return[t-1]}),eq:a(function(e,t,i){return[i<0?i+t:i]}),even:a(function(e,t){for(var i=0;i<t;i+=2)e.push(i);return e}),odd:a(function(e,t){for(var i=1;i<t;i+=2)e.push(i);return e}),lt:a(function(e,t,i){for(var n=i<0?i+t:i;0<=--n;)e.push(n);return e}),gt:a(function(e,t,i){for(var n=i<0?i+t:i;++n<t;)e.push(n);return e})}}).pseudos.nth=x.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})x.pseudos[p]=o(p);for(p in{submit:!0,reset:!0})x.pseudos[p]=r(p);return s.prototype=x.filters=x.pseudos,x.setFilters=new s,P=y.compile=function(e,t){var i,n=[],o=[],r=U[e+" "];if(!r){for(t||(t=g(e)),i=t.length;i--;)(r=f(t[i]))[W]?n.push(r):o.push(r);r=U(e,d(o,n))}return r},$.sortStable=W.split("").sort(Y).join("")===W,$.detectDuplicates=!!A,S(),$.sortDetached=n(function(e){return 1&e.compareDocumentPosition(I.createElement("div"))}),n(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||t("type|href|height|width",function(e,t,i){if(!i)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),$.attributes&&n(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||t("value",function(e,t,i){if(!i&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),n(function(e){return null==e.getAttribute("disabled")})||t(ie,function(e,t,i){var n;if(!i)return!0===e[t]?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}),y}(m);re.find=de,re.expr=de.selectors,re.expr[":"]=re.expr.pseudos,re.unique=de.uniqueSort,re.text=de.getText,re.isXMLDoc=de.isXML,re.contains=de.contains;var ue=re.expr.match.needsContext,he=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,fe=/^.[^:#\[\.,]*$/;re.filter=function(e,t,i){var n=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?re.find.matchesSelector(n,e)?[n]:[]:re.find.matches(e,re.grep(t,function(e){return 1===e.nodeType}))},re.fn.extend({find:function(e){var t,i=[],n=this,o=n.length;if("string"!=typeof e)return this.pushStack(re(e).filter(function(){for(t=0;t<o;t++)if(re.contains(n[t],this))return!0}));for(t=0;t<o;t++)re.find(e,n[t],i);return(i=this.pushStack(1<o?re.unique(i):i)).selector=this.selector?this.selector+" "+e:e,i},filter:function(e){return this.pushStack(t(this,e||[],!1))},not:function(e){return this.pushStack(t(this,e||[],!0))},is:function(e){return!!t(this,"string"==typeof e&&ue.test(e)?re(e):e||[],!1).length}});var pe,me=m.document,ge=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(re.fn.init=function(e,t){var i,n;if(!e)return this;if("string"!=typeof e)return e.nodeType?(this.context=this[0]=e,this.length=1,this):re.isFunction(e)?"undefined"!=typeof pe.ready?pe.ready(e):e(re):(e.selector!==undefined&&(this.selector=e.selector,this.context=e.context),re.makeArray(e,this));if(!(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&3<=e.length?[null,e,null]:ge.exec(e))||!i[1]&&t)return!t||t.jquery?(t||pe).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof re?t[0]:t,re.merge(this,re.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:me,!0)),he.test(i[1])&&re.isPlainObject(t))for(i in t)re.isFunction(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}if((n=me.getElementById(i[2]))&&n.parentNode){if(n.id!==i[2])return pe.find(e);this.length=1,this[0]=n}return this.context=me,this.selector=e,this}).prototype=re.fn,pe=re(me);var _e=/^(?:parents|prev(?:Until|All))/,ve={children:!0,contents:!0,next:!0,prev:!0};re.extend({dir:function(e,t,i){for(var n=[],o=e[t];o&&9!==o.nodeType&&(i===undefined||1!==o.nodeType||!re(o).is(i));)1===o.nodeType&&n.push(o),o=o[t];return n},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}}),re.fn.extend({has:function(e){var t,i=re(e,this),n=i.length;return this.filter(function(){for(t=0;t<n;t++)if(re.contains(this,i[t]))return!0})},closest:function(e,t){for(var i,n=0,o=this.length,r=[],a=ue.test(e)||"string"!=typeof e?re(e,t||this.context):0;n<o;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(a?-1<a.index(i):1===i.nodeType&&re.find.matchesSelector(i,e))){r.push(i);break}return this.pushStack(1<r.length?re.unique(r):r)},index:function(e){return e?"string"==typeof e?re.inArray(this[0],re(e)):re.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(re.unique(re.merge(this.get(),re(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),re.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return re.dir(e,"parentNode")},parentsUntil:function(e,t,i){return re.dir(e,"parentNode",i)},next:function(e){return i(e,"nextSibling")},prev:function(e){return i(e,"previousSibling")},nextAll:function(e){return re.dir(e,"nextSibling")},prevAll:function(e){return re.dir(e,"previousSibling")},nextUntil:function(e,t,i){return re.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return re.dir(e,"previousSibling",i)},siblings:function(e){return re.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return re.sibling(e.firstChild)},contents:function(e){return re.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:re.merge([],e.childNodes)}},function(n,o){re.fn[n]=function(e,t){var i=re.map(this,o,e);return"Until"!==n.slice(-5)&&(t=e),t&&"string"==typeof t&&(i=re.filter(t,i)),1<this.length&&(ve[n]||(i=re.unique(i)),_e.test(n)&&(i=i.reverse())),this.pushStack(i)}});var be,ye=/\S+/g,we={};re.Callbacks=function(o){o="string"==typeof o?we[o]||h(o):re.extend({},o);var r,t,i,a,n,s,l=[],c=!o.once&&[],d=function(e){for(t=o.memory&&e,i=!0,n=s||0,s=0,a=l.length,r=!0;l&&n<a;n++)if(!1===l[n].apply(e[0],e[1])&&o.stopOnFalse){t=!1;break}r=!1,l&&(c?c.length&&d(c.shift()):t?l=[]:u.disable())},u={add:function(){if(l){var e=l.length;!function n(e){re.each(e,function(e,t){var i=re.type(t);"function"===i?o.unique&&u.has(t)||l.push(t):t&&t.length&&"string"!==i&&n(t)})}(arguments),r?a=l.length:t&&(s=e,d(t))}return this},remove:function(){return l&&re.each(arguments,function(e,t){for(var i;-1<(i=re.inArray(t,l,i));)l.splice(i,1),r&&(i<=a&&a--,i<=n&&n--)}),this},has:function(e){return e?-1<re.inArray(e,l):!(!l||!l.length)},empty:function(){return l=[],a=0,this},disable:function(){return l=c=t=undefined,this},disabled:function(){return!l},lock:function(){return c=undefined,t||u.disable(),this},locked:function(){return!c},fireWith:function(e,t){return!l||i&&!c||(t=[e,(t=t||[]).slice?t.slice():t],r?c.push(t):d(t)),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!i}};return u},re.extend({Deferred:function(e){var r=[["resolve","done",re.Callbacks("once memory"),"resolved"],["reject","fail",re.Callbacks("once memory"),"rejected"],["notify","progress",re.Callbacks("memory")]],o="pending",a={state:function(){return o},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var o=arguments;return re.Deferred(function(n){re.each(r,function(e,t){var i=re.isFunction(o[e])&&o[e];s[t[1]](function(){var e=i&&i.apply(this,arguments);e&&re.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[t[0]+"With"](this===a?n.promise():this,i?[e]:arguments)})}),o=null}).promise()},promise:function(e){return null!=e?re.extend(e,a):a}},s={};return a.pipe=a.then,re.each(r,function(e,t){var i=t[2],n=t[3];a[t[1]]=i.add,n&&i.add(function(){o=n},r[1^e][2].disable,r[2][2].lock),s[t[0]]=function(){return s[t[0]+"With"](this===s?a:this,arguments),this},s[t[0]+"With"]=i.fireWith}),a.promise(s),e&&e.call(s,s),s},when:function(e){var o,t,i,n=0,r=Q.call(arguments),a=r.length,s=1!==a||e&&re.isFunction(e.promise)?a:0,l=1===s?e:re.Deferred(),c=function(t,i,n){return function(e){i[t]=this,n[t]=1<arguments.length?Q.call(arguments):e,n===o?l.notifyWith(i,n):--s||l.resolveWith(i,n)}};if(1<a)for(o=new Array(a),t=new Array(a),i=new Array(a);n<a;n++)r[n]&&re.isFunction(r[n].promise)?r[n].promise().done(c(n,i,r)).fail(l.reject).progress(c(n,t,o)):--s;return s||l.resolveWith(i,r),l.promise()}}),re.fn.ready=function(e){return re.ready.promise().done(e),this},re.extend({isReady:!1,readyWait:1,holdReady:function(e){e?re.readyWait++:re.ready(!0)},ready:function(e){if(!0===e?!--re.readyWait:!re.isReady){if(!me.body)return setTimeout(re.ready);(re.isReady=!0)!==e&&0<--re.readyWait||(be.resolveWith(me,[re]),re.fn.trigger&&re(me).trigger("ready").off("ready"))}}}),re.ready.promise=function(e){if(!be)if(be=re.Deferred(),"complete"===me.readyState)setTimeout(re.ready);else if(me.addEventListener)me.addEventListener("DOMContentLoaded",r,!1),m.addEventListener("load",r,!1);else{me.attachEvent("onreadystatechange",r),m.attachEvent("onload",r);var t=!1;try{t=null==m.frameElement&&me.documentElement}catch(i){}t&&t.doScroll&&function n(){if(!re.isReady){try{t.doScroll("left")}catch(i){return setTimeout(n,50)}o(),re.ready()}}()}return be.promise(e)};var ke,$e=typeof undefined;for(ke in re(ne))break;ne.ownLast="0"!==ke,ne.inlineBlockNeedsLayout=!1,re(function(){var e,t,i=me.getElementsByTagName("body")[0];i&&((e=me.createElement("div")).style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",t=me.createElement("div"),i.appendChild(e).appendChild(t),typeof t.style.zoom!==$e&&(t.style.cssText="border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1",(ne.inlineBlockNeedsLayout=3===t.offsetWidth)&&(i.style.zoom=1)),i.removeChild(e),e=t=null)}),function(){var e=me.createElement("div");if(null==ne.deleteExpando){ne.deleteExpando=!0;try{delete e.test}catch(t){ne.deleteExpando=!1}}e=null}(),re.acceptData=function(e){var t=re.noData[(e.nodeName+" ").toLowerCase()],i=+e.nodeType||1;return(1===i||9===i)&&(!t||!0!==t&&e.getAttribute("classid")===t)};var xe=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Ce=/([A-Z])/g;re.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return!!(e=e.nodeType?re.cache[e[re.expando]]:e[re.expando])&&!c(e)},data:function(e,t,i){return n(e,t,i)},removeData:function(e,t){return a(e,t)},_data:function(e,t,i){return n(e,t,i,!0)},_removeData:function(e,t){return a(e,t,!0)}}),re.fn.extend({data:function(e,t){var i,n,o,r=this[0],a=r&&r.attributes;if(e!==undefined)return"object"==typeof e?this.each(function(){re.data(this,e)}):1<arguments.length?this.each(function(){re.data(this,e,t)}):r?l(r,e,re.data(r,e)):undefined;if(this.length&&(o=re.data(r),1===r.nodeType&&!re._data(r,"parsedAttrs"))){for(i=a.length;i--;)0===(n=a[i].name).indexOf("data-")&&l(r,n=re.camelCase(n.slice(5)),o[n]);re._data(r,"parsedAttrs",!0)}return o},removeData:function(e){return this.each(function(){re.removeData(this,e)})}}),re.extend({queue:function(e,t,i){var n;if(e)return t=(t||"fx")+"queue",n=re._data(e,t),i&&(!n||re.isArray(i)?n=re._data(e,t,re.makeArray(i)):n.push(i)),n||[]},dequeue:function(e,t){t=t||"fx";var i=re.queue(e,t),n=i.length,o=i.shift(),r=re._queueHooks(e,t),a=function(){re.dequeue(e,t)};"inprogress"===o&&(o=i.shift(),n--),o&&("fx"===t&&i.unshift("inprogress"),delete r.stop,o.call(e,a,r)),!n&&r&&r.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return re._data(e,i)||re._data(e,i,{empty:re.Callbacks("once memory").add(function(){re._removeData(e,t+"queue"),re._removeData(e,i)})})}}),re.fn.extend({queue:function(t,i){var e=2;return"string"!=typeof t&&(i=t,t="fx",e--),arguments.length<e?re.queue(this[0],t):i===undefined?this:this.each(function(){var e=re.queue(this,t,i);re._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&re.dequeue(this,t)})},dequeue:function(e){return this.each(function(){re.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,n=1,o=re.Deferred(),r=this,a=this.length,s=function(){--n||o.resolveWith(r,[r])};for("string"!=typeof e&&(t=e,e=undefined),e=e||"fx";a--;)(i=re._data(r[a],e+"queueHooks"))&&i.empty&&(n++,i.empty.add(s));return s(),o.promise(t)}});var Te=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Pe=["Top","Right","Bottom","Left"],Ee=function(e,t){return e=t||e,"none"===re.css(e,"display")||!re.contains(e.ownerDocument,e)},Ne=re.access=function(e,t,i,n,o,r,a){var s=0,l=e.length,c=null==i;if("object"===re.type(i))for(s in o=!0,i)re.access(e,t,s,i[s],!0,r,a);else if(n!==undefined&&(o=!0,re.isFunction(n)||(a=!0),c&&(a?(t.call(e,n),t=null):(c=t,t=function(e,t,i){return c.call(re(e),i)})),t))for(;s<l;s++)t(e[s],i,a?n:n.call(e[s],s,t(e[s],i)));return o?e:c?t.call(e):l?t(e[0],i):r},Ae=/^(?:checkbox|radio)$/i;!function(){var e=me.createDocumentFragment(),t=me.createElement("div"),i=me.createElement("input");if(t.setAttribute("className","t"),t.innerHTML="  <link/><table></table><a href='/a'>a</a>",ne.leadingWhitespace=3===t.firstChild.nodeType,ne.tbody=!t.getElementsByTagName("tbody").length,ne.htmlSerialize=!!t.getElementsByTagName("link").length,ne.html5Clone="<:nav></:nav>"!==me.createElement("nav").cloneNode(!0).outerHTML,i.type="checkbox",i.checked=!0,e.appendChild(i),ne.appendChecked=i.checked,t.innerHTML="<textarea>x</textarea>",ne.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue,e.appendChild(t),t.innerHTML="<input type='radio' checked='checked' name='t'/>",ne.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,ne.noCloneEvent=!0,t.attachEvent&&(t.attachEvent("onclick",function(){ne.noCloneEvent=!1}),t.cloneNode(!0).click()),null==ne.deleteExpando){ne.deleteExpando=!0;try{delete t.test}catch(n){ne.deleteExpando=!1}}e=t=i=null}(),function(){var e,t,i=me.createElement("div");for(e in{submit:!0,change:!0,focusin:!0})t="on"+e,(ne[e+"Bubbles"]=t in m)||(i.setAttribute(t,"t"),
ne[e+"Bubbles"]=!1===i.attributes[t].expando);i=null}();var Se=/^(?:input|select|textarea)$/i,Ie=/^key/,Le=/^(?:mouse|contextmenu)|click/,Oe=/^(?:focusinfocus|focusoutblur)$/,je=/^([^.]*)(?:\.(.+)|)$/;re.event={global:{},add:function(e,t,i,n,o){var r,a,s,l,c,d,u,h,f,p,m,g=re._data(e);if(g){for(i.handler&&(i=(l=i).handler,o=l.selector),i.guid||(i.guid=re.guid++),(a=g.events)||(a=g.events={}),(d=g.handle)||((d=g.handle=function(e){return typeof re===$e||e&&re.event.triggered===e.type?undefined:re.event.dispatch.apply(d.elem,arguments)}).elem=e),s=(t=(t||"").match(ye)||[""]).length;s--;)f=m=(r=je.exec(t[s])||[])[1],p=(r[2]||"").split(".").sort(),f&&(c=re.event.special[f]||{},f=(o?c.delegateType:c.bindType)||f,c=re.event.special[f]||{},u=re.extend({type:f,origType:m,data:n,handler:i,guid:i.guid,selector:o,needsContext:o&&re.expr.match.needsContext.test(o),namespace:p.join(".")},l),(h=a[f])||((h=a[f]=[]).delegateCount=0,c.setup&&!1!==c.setup.call(e,n,p,d)||(e.addEventListener?e.addEventListener(f,d,!1):e.attachEvent&&e.attachEvent("on"+f,d))),c.add&&(c.add.call(e,u),u.handler.guid||(u.handler.guid=i.guid)),o?h.splice(h.delegateCount++,0,u):h.push(u),re.event.global[f]=!0);e=null}},remove:function(e,t,i,n,o){var r,a,s,l,c,d,u,h,f,p,m,g=re.hasData(e)&&re._data(e);if(g&&(d=g.events)){for(c=(t=(t||"").match(ye)||[""]).length;c--;)if(f=m=(s=je.exec(t[c])||[])[1],p=(s[2]||"").split(".").sort(),f){for(u=re.event.special[f]||{},h=d[f=(n?u.delegateType:u.bindType)||f]||[],s=s[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=r=h.length;r--;)a=h[r],!o&&m!==a.origType||i&&i.guid!==a.guid||s&&!s.test(a.namespace)||n&&n!==a.selector&&("**"!==n||!a.selector)||(h.splice(r,1),a.selector&&h.delegateCount--,u.remove&&u.remove.call(e,a));l&&!h.length&&(u.teardown&&!1!==u.teardown.call(e,p,g.handle)||re.removeEvent(e,f,g.handle),delete d[f])}else for(f in d)re.event.remove(e,f+t[c],i,n,!0);re.isEmptyObject(d)&&(delete g.handle,re._removeData(e,"events"))}},trigger:function(e,t,i,n){var o,r,a,s,l,c,d,u=[i||me],h=te.call(e,"type")?e.type:e,f=te.call(e,"namespace")?e.namespace.split("."):[];if(a=c=i=i||me,3!==i.nodeType&&8!==i.nodeType&&!Oe.test(h+re.event.triggered)&&(0<=h.indexOf(".")&&(h=(f=h.split(".")).shift(),f.sort()),r=h.indexOf(":")<0&&"on"+h,(e=e[re.expando]?e:new re.Event(h,"object"==typeof e&&e)).isTrigger=n?2:3,e.namespace=f.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=undefined,e.target||(e.target=i),t=null==t?[e]:re.makeArray(t,[e]),l=re.event.special[h]||{},n||!l.trigger||!1!==l.trigger.apply(i,t))){if(!n&&!l.noBubble&&!re.isWindow(i)){for(s=l.delegateType||h,Oe.test(s+h)||(a=a.parentNode);a;a=a.parentNode)u.push(a),c=a;c===(i.ownerDocument||me)&&u.push(c.defaultView||c.parentWindow||m)}for(d=0;(a=u[d++])&&!e.isPropagationStopped();)e.type=1<d?s:l.bindType||h,(o=(re._data(a,"events")||{})[e.type]&&re._data(a,"handle"))&&o.apply(a,t),(o=r&&a[r])&&o.apply&&re.acceptData(a)&&(e.result=o.apply(a,t),!1===e.result&&e.preventDefault());if(e.type=h,!n&&!e.isDefaultPrevented()&&(!l._default||!1===l._default.apply(u.pop(),t))&&re.acceptData(i)&&r&&i[h]&&!re.isWindow(i)){(c=i[r])&&(i[r]=null),re.event.triggered=h;try{i[h]()}catch(p){}re.event.triggered=undefined,c&&(i[r]=c)}return e.result}},dispatch:function(e){e=re.event.fix(e);var t,i,n,o,r,a=[],s=Q.call(arguments),l=(re._data(this,"events")||{})[e.type]||[],c=re.event.special[e.type]||{};if((s[0]=e).delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,e)){for(a=re.event.handlers.call(this,e,l),t=0;(o=a[t++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,r=0;(n=o.handlers[r++])&&!e.isImmediatePropagationStopped();)e.namespace_re&&!e.namespace_re.test(n.namespace)||(e.handleObj=n,e.data=n.data,(i=((re.event.special[n.origType]||{}).handle||n.handler).apply(o.elem,s))!==undefined&&!1===(e.result=i)&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,t){var i,n,o,r,a=[],s=t.delegateCount,l=e.target;if(s&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==e.type)){for(o=[],r=0;r<s;r++)o[i=(n=t[r]).selector+" "]===undefined&&(o[i]=n.needsContext?0<=re(i,this).index(l):re.find(i,this,null,[l]).length),o[i]&&o.push(n);o.length&&a.push({elem:l,handlers:o})}return s<t.length&&a.push({elem:this,handlers:t.slice(s)}),a},fix:function(e){if(e[re.expando])return e;var t,i,n,o=e.type,r=e,a=this.fixHooks[o];for(a||(this.fixHooks[o]=a=Le.test(o)?this.mouseHooks:Ie.test(o)?this.keyHooks:{}),n=a.props?this.props.concat(a.props):this.props,e=new re.Event(r),t=n.length;t--;)e[i=n[t]]=r[i];return e.target||(e.target=r.srcElement||me),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,a.filter?a.filter(e,r):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var i,n,o,r=t.button,a=t.fromElement;return null==e.pageX&&null!=t.clientX&&(o=(n=e.target.ownerDocument||me).documentElement,i=n.body,e.pageX=t.clientX+(o&&o.scrollLeft||i&&i.scrollLeft||0)-(o&&o.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(o&&o.scrollTop||i&&i.scrollTop||0)-(o&&o.clientTop||i&&i.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?t.toElement:a),e.which||r===undefined||(e.which=1&r?1:2&r?3:4&r?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==f()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){if(this===f()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(re.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1},_default:function(e){return re.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,n){var o=re.extend(new re.Event,i,{type:e,isSimulated:!0,originalEvent:{}});n?re.event.trigger(o,null,t):re.event.dispatch.call(t,o),o.isDefaultPrevented()&&i.preventDefault()}},re.removeEvent=me.removeEventListener?function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)}:function(e,t,i){var n="on"+t;e.detachEvent&&(typeof e[n]===$e&&(e[n]=null),e.detachEvent(n,i))},re.Event=function(e,t){if(!(this instanceof re.Event))return new re.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.defaultPrevented===undefined&&(!1===e.returnValue||e.getPreventDefault&&e.getPreventDefault())?d:u):this.type=e,t&&re.extend(this,t),this.timeStamp=e&&e.timeStamp||re.now(),this[re.expando]=!0},re.Event.prototype={isDefaultPrevented:u,isPropagationStopped:u,isImmediatePropagationStopped:u,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=d,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=d,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=d,this.stopPropagation()}},re.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,r){re.event.special[e]={delegateType:r,bindType:r,handle:function(e){var t,i=this,n=e.relatedTarget,o=e.handleObj;return n&&(n===i||re.contains(i,n))||(e.type=o.origType,t=o.handler.apply(this,arguments),e.type=r),t}}}),ne.submitBubbles||(re.event.special.submit={setup:function(){if(re.nodeName(this,"form"))return!1;re.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,i=re.nodeName(t,"input")||re.nodeName(t,"button")?t.form:undefined;i&&!re._data(i,"submitBubbles")&&(re.event.add(i,"submit._submit",function(e){e._submit_bubble=!0}),re._data(i,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&re.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(re.nodeName(this,"form"))return!1;re.event.remove(this,"._submit")}}),ne.changeBubbles||(re.event.special.change={setup:function(){if(Se.test(this.nodeName))return"checkbox"!==this.type&&"radio"!==this.type||(re.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),re.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),re.event.simulate("change",this,e,!0)})),!1;re.event.add(this,"beforeactivate._change",function(e){var t=e.target;Se.test(t.nodeName)&&!re._data(t,"changeBubbles")&&(re.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||re.event.simulate("change",this.parentNode,e,!0)}),re._data(t,"changeBubbles",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type)return e.handleObj.handler.apply(this,arguments)},teardown:function(){return re.event.remove(this,"._change"),!Se.test(this.nodeName)}}),ne.focusinBubbles||re.each({focus:"focusin",blur:"focusout"},function(i,n){var o=function(e){re.event.simulate(n,e.target,re.event.fix(e),!0)};re.event.special[n]={setup:function(){var e=this.ownerDocument||this,t=re._data(e,n);t||e.addEventListener(i,o,!0),re._data(e,n,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this,t=re._data(e,n)-1;t?re._data(e,n,t):(e.removeEventListener(i,o,!0),re._removeData(e,n))}}}),re.fn.extend({on:function(e,t,i,n,o){var r,a;if("object"==typeof e){for(r in"string"!=typeof t&&(i=i||t,t=undefined),e)this.on(r,t,i,e[r],o);return this}if(null==i&&null==n?(n=t,i=t=undefined):null==n&&("string"==typeof t?(n=i,i=undefined):(n=i,i=t,t=undefined)),!1===n)n=u;else if(!n)return this;return 1===o&&(a=n,(n=function(e){return re().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=re.guid++)),this.each(function(){re.event.add(this,e,n,i,t)})},one:function(e,t,i,n){return this.on(e,t,i,n,1)},off:function(e,t,i){var n,o;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,re(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"!=typeof e)return!1!==t&&"function"!=typeof t||(i=t,t=undefined),!1===i&&(i=u),this.each(function(){re.event.remove(this,e,i,t)});for(o in e)this.off(o,t,e[o]);return this},trigger:function(e,t){return this.each(function(){re.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];if(i)return re.event.trigger(e,t,i,!0)}});var De="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",He=/ jQuery\d+="(?:null|\d+)"/g,ze=new RegExp("<(?:"+De+")[\\s/>]","i"),We=/^\s+/,Re=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Me=/<([\w:]+)/,qe=/<tbody/i,Fe=/<|&#?\w+;/,Be=/<(?:script|style|link)/i,Ue=/checked\s*(?:[^=]|=\s*.checked.)/i,Ye=/^$|\/(?:java|ecma)script/i,Xe=/^true\/(.*)/,Ge=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Qe={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:ne.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},Ve=g(me).appendChild(me.createElement("div"));Qe.optgroup=Qe.option,Qe.tbody=Qe.tfoot=Qe.colgroup=Qe.caption=Qe.thead,Qe.th=Qe.td,re.extend({clone:function(e,t,i){var n,o,r,a,s,l=re.contains(e.ownerDocument,e);if(ne.html5Clone||re.isXMLDoc(e)||!ze.test("<"+e.nodeName+">")?r=e.cloneNode(!0):(Ve.innerHTML=e.outerHTML,Ve.removeChild(r=Ve.firstChild)),!(ne.noCloneEvent&&ne.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||re.isXMLDoc(e)))for(n=_(r),s=_(e),a=0;null!=(o=s[a]);++a)n[a]&&$(o,n[a]);if(t)if(i)for(s=s||_(e),n=n||_(r),a=0;null!=(o=s[a]);a++)k(o,n[a]);else k(e,r);return 0<(n=_(r,"script")).length&&w(n,!l&&_(e,"script")),n=s=o=null,r},buildFragment:function(e,t,i,n){for(var o,r,a,s,l,c,d,u=e.length,h=g(t),f=[],p=0;p<u;p++)if((r=e[p])||0===r)if("object"===re.type(r))re.merge(f,r.nodeType?[r]:r);else if(Fe.test(r)){for(s=s||h.appendChild(t.createElement("div")),l=(Me.exec(r)||["",""])[1].toLowerCase(),d=Qe[l]||Qe._default,s.innerHTML=d[1]+r.replace(Re,"<$1></$2>")+d[2],o=d[0];o--;)s=s.lastChild;if(!ne.leadingWhitespace&&We.test(r)&&f.push(t.createTextNode(We.exec(r)[0])),!ne.tbody)for(o=(r="table"!==l||qe.test(r)?"<table>"!==d[1]||qe.test(r)?0:s:s.firstChild)&&r.childNodes.length;o--;)re.nodeName(c=r.childNodes[o],"tbody")&&!c.childNodes.length&&r.removeChild(c);for(re.merge(f,s.childNodes),s.textContent="";s.firstChild;)s.removeChild(s.firstChild);s=h.lastChild}else f.push(t.createTextNode(r));for(s&&h.removeChild(s),ne.appendChecked||re.grep(_(f,"input"),v),p=0;r=f[p++];)if((!n||-1===re.inArray(r,n))&&(a=re.contains(r.ownerDocument,r),s=_(h.appendChild(r),"script"),a&&w(s),i))for(o=0;r=s[o++];)Ye.test(r.type||"")&&i.push(r);return s=null,h},cleanData:function(e,t){for(var i,n,o,r,a=0,s=re.expando,l=re.cache,c=ne.deleteExpando,d=re.event.special;null!=(i=e[a]);a++)if((t||re.acceptData(i))&&(r=(o=i[s])&&l[o])){if(r.events)for(n in r.events)d[n]?re.event.remove(i,n):re.removeEvent(i,n,r.handle);l[o]&&(delete l[o],c?delete i[s]:typeof i.removeAttribute!==$e?i.removeAttribute(s):i[s]=null,G.push(o))}}}),re.fn.extend({text:function(e){return Ne(this,function(e){return e===undefined?re.text(this):this.empty().append((this[0]&&this[0].ownerDocument||me).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||p(this,e).appendChild(e)})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=p(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var i,n=e?re.filter(e,this):this,o=0;null!=(i=n[o]);o++)t||1!==i.nodeType||re.cleanData(_(i)),i.parentNode&&(t&&re.contains(i.ownerDocument,i)&&w(_(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&re.cleanData(_(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&re.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return re.clone(this,e,t)})},html:function(e){return Ne(this,function(e){var t=this[0]||{},i=0,n=this.length;if(e===undefined)return 1===t.nodeType?t.innerHTML.replace(He,""):undefined;if("string"==typeof e&&!Be.test(e)&&(ne.htmlSerialize||!ze.test(e))&&(ne.leadingWhitespace||!We.test(e))&&!Qe[(Me.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Re,"<$1></$2>");try{for(;i<n;i++)1===(t=this[i]||{}).nodeType&&(re.cleanData(_(t,!1)),t.innerHTML=e);t=0}catch(o){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){var t=e;return this.domManip(arguments,function(e){t=this.parentNode,re.cleanData(_(this)),t&&t.replaceChild(e,this)}),t&&(t.length||t.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(i,n){i=V.apply([],i);var e,t,o,r,a,s,l=0,c=this.length,d=this,u=c-1,h=i[0],f=re.isFunction(h);if(f||1<c&&"string"==typeof h&&!ne.checkClone&&Ue.test(h))return this.each(function(e){var t=d.eq(e);f&&(i[0]=h.call(this,e,t.html())),t.domManip(i,n)});if(c&&(e=(s=re.buildFragment(i,this[0].ownerDocument,!1,this)).firstChild,1===s.childNodes.length&&(s=e),e)){for(o=(r=re.map(_(s,"script"),b)).length;l<c;l++)t=s,l!==u&&(t=re.clone(t,!0,!0),o&&re.merge(r,_(t,"script"))),n.call(this[l],t,l);if(o)for(a=r[r.length-1].ownerDocument,re.map(r,y),l=0;l<o;l++)t=r[l],Ye.test(t.type||"")&&!re._data(t,"globalEval")&&re.contains(a,t)&&(t.src?re._evalUrl&&re._evalUrl(t.src):re.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Ge,"")));s=e=null}return this}}),re.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){re.fn[e]=function(e){for(var t,i=0,n=[],o=re(e),r=o.length-1;i<=r;i++)t=i===r?this:this.clone(!0),re(o[i])[a](t),K.apply(n,t.get());return this.pushStack(n)}});var Ke,Je,Ze,et,tt,it={};et=me.createElement("div"),tt="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0",et.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",(Je=et.getElementsByTagName("a")[0]).style.cssText="float:left;opacity:.5",ne.opacity=/^0.5/.test(Je.style.opacity),ne.cssFloat=!!Je.style.cssFloat,et.style.backgroundClip="content-box",et.cloneNode(!0).style.backgroundClip="",ne.clearCloneStyle="content-box"===et.style.backgroundClip,Je=et=null,ne.shrinkWrapBlocks=function(){var e,t,i;if(null==Ze){if(!(e=me.getElementsByTagName("body")[0]))return;t=me.createElement("div"),i=me.createElement("div"),e.appendChild(t).appendChild(i),Ze=!1,typeof i.style.zoom!==$e&&(i.style.cssText=tt+";width:1px;padding:1px;zoom:1",i.innerHTML="<div></div>",i.firstChild.style.width="5px",Ze=3!==i.offsetWidth),e.removeChild(t),e=t=i=null}return Ze};var nt,ot,rt=/^margin/,at=new RegExp("^("+Te+")(?!px)[a-z%]+$","i"),st=/^(top|right|bottom|left)$/;m.getComputedStyle?(nt=function(e){return e.ownerDocument.defaultView.getComputedStyle(e,null)},ot=function(e,t,i){var n,o,r,a,s=e.style;return a=(i=i||nt(e))?i.getPropertyValue(t)||i[t]:undefined,i&&(""!==a||re.contains(e.ownerDocument,e)||(a=re.style(e,t)),at.test(a)&&rt.test(t)&&(n=s.width,o=s.minWidth,r=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=i.width,s.width=n,s.minWidth=o,s.maxWidth=r)),a===undefined?a:a+""}):me.documentElement.currentStyle&&(nt=function(e){return e.currentStyle},ot=function(e,t,i){var n,o,r,a,s=e.style;return null==(a=(i=i||nt(e))?i[t]:undefined)&&s&&s[t]&&(a=s[t]),at.test(a)&&!st.test(t)&&(n=s.left,(r=(o=e.runtimeStyle)&&o.left)&&(o.left=e.currentStyle.left),s.left="fontSize"===t?"1em":a,a=s.pixelLeft+"px",s.left=n,r&&(o.left=r)),a===undefined?a:a+""||"auto"}),function(){function e(){var e,t,i=me.getElementsByTagName("body")[0];i&&(e=me.createElement("div"),t=me.createElement("div"),e.style.cssText=l,i.appendChild(e).appendChild(t),t.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%",re.swap(i,null!=i.style.zoom?{zoom:1}:{},function(){n=4===t.offsetWidth}),s=!(a=!(o=!0)),m.getComputedStyle&&(a="1%"!==(m.getComputedStyle(t,null)||{}).top,o="4px"===(m.getComputedStyle(t,null)||{width:"4px"}).width),i.removeChild(e),t=i=null)}var t,r,n,o,a,s,i=me.createElement("div"),l="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",c="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";i.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",(t=i.getElementsByTagName("a")[0]).style.cssText="float:left;opacity:.5",ne.opacity=/^0.5/.test(t.style.opacity),ne.cssFloat=!!t.style.cssFloat,i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",ne.clearCloneStyle="content-box"===i.style.backgroundClip,t=i=null,re.extend(ne,{reliableHiddenOffsets:function(){if(null!=r)return r;var e,t,i,n=me.createElement("div"),o=me.getElementsByTagName("body")[0];return o?(n.setAttribute("className","t"),n.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",(e=me.createElement("div")).style.cssText=l,o.appendChild(e).appendChild(n),n.innerHTML="<table><tr><td></td><td>t</td></tr></table>",(t=n.getElementsByTagName("td"))[0].style.cssText="padding:0;margin:0;border:0;display:none",i=0===t[0].offsetHeight,t[0].style.display="",t[1].style.display="none",r=i&&0===t[0].offsetHeight,o.removeChild(e),n=o=null,r):void 0},boxSizing:function(){return null==n&&e(),n},boxSizingReliable:function(){return null==o&&e(),o},pixelPosition:function(){return null==a&&e(),a},reliableMarginRight:function(){var e,t,i,n;if(null==s&&m.getComputedStyle){if(!(e=me.getElementsByTagName("body")[0]))return;t=me.createElement("div"),i=me.createElement("div"),t.style.cssText=l,e.appendChild(t).appendChild(i),(n=i.appendChild(me.createElement("div"))).style.cssText=i.style.cssText=c,n.style.marginRight=n.style.width="0",i.style.width="1px",s=!parseFloat((m.getComputedStyle(n,null)||{}).marginRight),e.removeChild(t)}return s}})}(),re.swap=function(e,t,i,n){var o,r,a={};for(r in t)a[r]=e.style[r],e.style[r]=t[r];for(r in o=i.apply(e,n||[]),t)e.style[r]=a[r];return o};var lt=/alpha\([^)]*\)/i,ct=/opacity\s*=\s*([^)]*)/,dt=/^(none|table(?!-c[ea]).+)/,ut=new RegExp("^("+Te+")(.*)$","i"),ht=new RegExp("^([+-])=("+Te+")","i"),ft={position:"absolute",visibility:"hidden",display:"block"},pt={letterSpacing:0,fontWeight:400},mt=["Webkit","O","Moz","ms"];re.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=ot(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":ne.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,i,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,r,a,s=re.camelCase(t),l=e.style;if(t=re.cssProps[s]||(re.cssProps[s]=P(l,s)),a=re.cssHooks[t]||re.cssHooks[s],i===undefined)return a&&"get"in a&&(o=a.get(e,!1,n))!==undefined?o:l[t];if("string"===(r=typeof i)&&(o=ht.exec(i))&&(i=(o[1]+1)*o[2]+parseFloat(re.css(e,t)),r="number"),null!=i&&i==i&&("number"!==r||re.cssNumber[s]||(i+="px"),ne.clearCloneStyle||""!==i||0!==t.indexOf("background")||(l[t]="inherit"),!(a&&"set"in a&&(i=a.set(e,i,n))===undefined)))try{l[t]="",l[t]=i}catch(c){}}},css:function(e,t,i,n){var o,r,a,s=re.camelCase(t);return t=re.cssProps[s]||(re.cssProps[s]=P(e.style,s)),(a=re.cssHooks[t]||re.cssHooks[s])&&"get"in a&&(r=a.get(e,!0,i)),r===undefined&&(r=ot(e,t,n)),"normal"===r&&t in pt&&(r=pt[t]),""===i||i?(o=parseFloat(r),!0===i||re.isNumeric(o)?o||0:r):r}}),re.each(["height","width"],function(e,o){re.cssHooks[o]={get:function(e,t,i){if(t)return 0===e.offsetWidth&&dt.test(re.css(e,"display"))?re.swap(e,ft,function(){return S(e,o,i)}):S(e,o,i)},set:function(e,t,i){var n=i&&nt(e);return N(e,t,i?A(e,o,i,ne.boxSizing()&&"border-box"===re.css(e,"boxSizing",!1,n),n):0)}}}),ne.opacity||(re.cssHooks.opacity={get:function(e,t){return ct.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var i=e.style,n=e.currentStyle,o=re.isNumeric(t)?"alpha(opacity="+100*t+")":"",r=n&&n.filter||i.filter||"";((i.zoom=1)<=t||""===t)&&""===re.trim(r.replace(lt,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===t||n&&!n.filter)||(i.filter=lt.test(r)?r.replace(lt,o):r+" "+o)}}),re.cssHooks.marginRight=T(ne.reliableMarginRight,function(e,t){if(t)return re.swap(e,{display:"inline-block"},ot,[e,"marginRight"])}),re.each({margin:"",padding:"",border:"Width"},function(o,r){re.cssHooks[o+r]={expand:function(e){for(var t=0,i={},n="string"==typeof e?e.split(" "):[e];t<4;t++)i[o+Pe[t]+r]=n[t]||n[t-2]||n[0];return i}},rt.test(o)||(re.cssHooks[o+r].set=N)}),re.fn.extend({css:function(e,t){return Ne(this,function(e,t,i){var n,o,r={},a=0;if(re.isArray(t)){for(n=nt(e),o=t.length;a<o;a++)r[t[a]]=re.css(e,t[a],!1,n);return r}return i!==undefined?re.style(e,t,i):re.css(e,t)},e,t,1<arguments.length)},show:function(){return E(this,!0)},hide:function(){return E(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Ee(this)?re(this).show():re(this).hide()})}}),(re.Tween=I).prototype={constructor:I,init:function(e,t,i,n,o,r){this.elem=e,this.prop=i,this.easing=o||"swing",this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=r||(re.cssNumber[i]?"":"px")},cur:function(){var e=I.propHooks[this.prop];return e&&e.get?e.get(this):I.propHooks._default.get(this)},run:function(e){var t,i=I.propHooks[this.prop];return this.options.duration?this.pos=t=re.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):I.propHooks._default.set(this),this}},I.prototype.init.prototype=I.prototype,I.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=re.css(e.elem,e.prop,""))&&"auto"!==t?t:0:e.elem[e.prop]},set:function(e){re.fx.step[e.prop]?re.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[re.cssProps[e.prop]]||re.cssHooks[e.prop])?re.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},I.propHooks.scrollTop=I.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},re.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},re.fx=I.prototype.init,re.fx.step={};var gt,_t,vt,bt,yt,wt,kt,$t=/^(?:toggle|show|hide)$/,xt=new RegExp("^(?:([+-])=|)("+Te+")([a-z%]*)$","i"),Ct=/queueHooks$/,Tt=[D],Pt={"*":[function(e,t){var i=this.createTween(e,t),n=i.cur(),o=xt.exec(t),r=o&&o[3]||(re.cssNumber[e]?"":"px"),a=(re.cssNumber[e]||"px"!==r&&+n)&&xt.exec(re.css(i.elem,e)),s=1,l=20;if(a&&a[3]!==r)for(r=r||a[3],o=o||[],a=+n||1;a/=s=s||".5",re.style(i.elem,e,a+r),s!==(s=i.cur()/n)&&1!==s&&--l;);return o&&(a=i.start=+a||+n||0,i.unit=r,i.end=o[1]?a+(o[1]+1)*o[2]:+o[2]),i}]};re.Animation=re.extend(z,{tweener:function(e,t){re.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,n=0,o=e.length;n<o;n++)i=e[n],Pt[i]=Pt[i]||[],Pt[i].unshift(t)},prefilter:function(e,t){t?Tt.unshift(e):Tt.push(e)}}),re.speed=function(e,t,i){var n=e&&"object"==typeof e?re.extend({},e):{complete:i||!i&&t||re.isFunction(e)&&e,duration:e,easing:i&&t||t&&!re.isFunction(t)&&t};return n.duration=re.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in re.fx.speeds?re.fx.speeds[n.duration]:re.fx.speeds._default,null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){re.isFunction(n.old)&&n.old.call(this),n.queue&&re.dequeue(this,n.queue)},n},re.fn.extend({fadeTo:function(e,t,i,n){return this.filter(Ee).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(t,e,i,n){var o=re.isEmptyObject(t),r=re.speed(e,i,n),a=function(){var e=z(this,re.extend({},t),r);(o||re._data(this,"finish"))&&e.stop(!0)};return a.finish=a,o||!1===r.queue?this.each(a):this.queue(r.queue,a)},stop:function(o,e,r){var a=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof o&&(r=e,e=o,o=undefined),e&&!1!==o&&this.queue(o||"fx",[]),this.each(function(){var e=!0,t=null!=o&&o+"queueHooks",i=re.timers,n=re._data(this);if(t)n[t]&&n[t].stop&&a(n[t]);else for(t in n)n[t]&&n[t].stop&&Ct.test(t)&&a(n[t]);for(t=i.length;t--;)i[t].elem!==this||null!=o&&i[t].queue!==o||(i[t].anim.stop(r),e=!1,i.splice(t,1));!e&&r||re.dequeue(this,o)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=re._data(this),i=t[a+"queue"],n=t[a+"queueHooks"],o=re.timers,r=i?i.length:0;for(t.finish=!0,re.queue(this,a,[]),n&&n.stop&&n.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===a&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<r;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete t.finish})}}),re.each(["toggle","show","hide"],function(e,n){var o=re.fn[n];re.fn[n]=function(e,t,i){return null==e||"boolean"==typeof e?o.apply(this,arguments):this.animate(O(n,!0),e,t,i)}}),re.each({slideDown:O("show"),slideUp:O("hide"),slideToggle:O("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,n){re.fn[e]=function(e,t,i){return this.animate(n,e,t,i)}}),re.timers=[],re.fx.tick=function(){var e,t=re.timers,i=0;for(gt=re.now();i<t.length;i++)(e=t[i])()||t[i]!==e||t.splice(i--,1);t.length||re.fx.stop(),gt=undefined},re.fx.timer=function(e){re.timers.push(e),e()?re.fx.start():re.timers.pop()},re.fx.interval=13,re.fx.start=function(){_t||(_t=setInterval(re.fx.tick,re.fx.interval))},re.fx.stop=function(){clearInterval(_t),_t=null},re.fx.speeds={slow:600,fast:200,_default:400},re.fn.delay=function(n,e){return n=re.fx&&re.fx.speeds[n]||n,e=e||"fx",this.queue(e,function(e,t){var i=setTimeout(e,n);t.stop=function(){clearTimeout(i)}})},(kt=me.createElement("div")).setAttribute("className","t"),kt.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",vt=kt.getElementsByTagName("a")[0],wt=(yt=me.createElement("select")).appendChild(me.createElement("option")),bt=kt.getElementsByTagName("input")[0],vt.style.cssText="top:1px",ne.getSetAttribute="t"!==kt.className,ne.style=/top/.test(vt.getAttribute("style")),ne.hrefNormalized="/a"===vt.getAttribute("href"),ne.checkOn=!!bt.value,ne.optSelected=wt.selected,ne.enctype=!!me.createElement("form").enctype,yt.disabled=!0,ne.optDisabled=!wt.disabled,(bt=me.createElement("input")).setAttribute("value",""),ne.input=""===bt.getAttribute("value"),bt.value="t",bt.setAttribute("type","radio"),ne.radioValue="t"===bt.value,vt=bt=yt=wt=kt=null;var Et=/\r/g;re.fn.extend({val:function(i){var n,e,o,t=this[0];return arguments.length?(o=re.isFunction(i),this.each(function(e){var t;1===this.nodeType&&(null==(t=o?i.call(this,e,re(this).val()):i)?t="":"number"==typeof t?t+="":re.isArray(t)&&(t=re.map(t,function(e){return null==e?"":e+""})),(n=re.valHooks[this.type]||re.valHooks[this.nodeName.toLowerCase()])&&"set"in n&&n.set(this,t,"value")!==undefined||(this.value=t))})):t?(n=re.valHooks[t.type]||re.valHooks[t.nodeName.toLowerCase()])&&"get"in n&&(e=n.get(t,"value"))!==undefined?e:"string"==typeof(e=t.value)?e.replace(Et,""):null==e?"":e:void 0}}),re.extend({valHooks:{option:{get:function(e){var t=re.find.attr(e,"value");return null!=t?t:re.text(e)}},select:{get:function(e){for(var t,i,n=e.options,o=e.selectedIndex,r="select-one"===e.type||o<0,a=r?null:[],s=r?o+1:n.length,l=o<0?s:r?o:0;l<s;l++)if(((i=n[l]).selected||l===o)&&(ne.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!re.nodeName(i.parentNode,"optgroup"))){if(t=re(i).val(),r)return t;a.push(t)}return a},set:function(e,t){for(var i,n,o=e.options,r=re.makeArray(t),a=o.length;a--;)if(n=o[a],0<=re.inArray(re.valHooks.option.get(n),r))try{n.selected=i=!0}catch(s){n.scrollHeight}else n.selected=!1;return i||(e.selectedIndex=-1),o}}}}),re.each(["radio","checkbox"],function(){re.valHooks[this]={set:function(e,t){if(re.isArray(t))return e.checked=0<=re.inArray(re(e).val(),t)}},ne.checkOn||(re.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Nt,At,St=re.expr.attrHandle,It=/^(?:checked|selected)$/i,Lt=ne.getSetAttribute,Ot=ne.input;re.fn.extend({attr:function(e,t){return Ne(this,re.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){re.removeAttr(this,e)})}}),re.extend({attr:function(e,t,i){var n,o,r=e.nodeType;if(e&&3!==r&&8!==r&&2!==r)return typeof e.getAttribute===$e?re.prop(e,t,i):(1===r&&re.isXMLDoc(e)||(t=t.toLowerCase(),n=re.attrHooks[t]||(re.expr.match.bool.test(t)?At:Nt)),i===undefined?n&&"get"in n&&null!==(o=n.get(e,t))?o:null==(o=re.find.attr(e,t))?undefined:o:null!==i?n&&"set"in n&&(o=n.set(e,i,t))!==undefined?o:(e.setAttribute(t,i+""),i):void re.removeAttr(e,t))},removeAttr:function(e,t){var i,n,o=0,r=t&&t.match(ye);if(r&&1===e.nodeType)for(;i=r[o++];)n=re.propFix[i]||i,re.expr.match.bool.test(i)?Ot&&Lt||!It.test(i)?e[n]=!1:e[re.camelCase("default-"+i)]=e[n]=!1:re.attr(e,i,""),e.removeAttribute(Lt?i:n)},attrHooks:{type:{set:function(e,t){if(!ne.radioValue&&"radio"===t&&re.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}}}),At={set:function(e,t,i){return!1===t?re.removeAttr(e,i):Ot&&Lt||!It.test(i)?e.setAttribute(!Lt&&re.propFix[i]||i,i):e[re.camelCase("default-"+i)]=e[i]=!0,i}},re.each(re.expr.match.bool.source.match(/\w+/g),function(e,t){var r=St[t]||re.find.attr;St[t]=Ot&&Lt||!It.test(t)?function(e,t,i){var n,o;return i||(o=St[t],St[t]=n,
n=null!=r(e,t,i)?t.toLowerCase():null,St[t]=o),n}:function(e,t,i){if(!i)return e[re.camelCase("default-"+t)]?t.toLowerCase():null}}),Ot&&Lt||(re.attrHooks.value={set:function(e,t,i){if(!re.nodeName(e,"input"))return Nt&&Nt.set(e,t,i);e.defaultValue=t}}),Lt||(Nt={set:function(e,t,i){var n=e.getAttributeNode(i);if(n||e.setAttributeNode(n=e.ownerDocument.createAttribute(i)),n.value=t+="","value"===i||t===e.getAttribute(i))return t}},St.id=St.name=St.coords=function(e,t,i){var n;if(!i)return(n=e.getAttributeNode(t))&&""!==n.value?n.value:null},re.valHooks.button={get:function(e,t){var i=e.getAttributeNode(t);if(i&&i.specified)return i.value},set:Nt.set},re.attrHooks.contenteditable={set:function(e,t,i){Nt.set(e,""!==t&&t,i)}},re.each(["width","height"],function(e,i){re.attrHooks[i]={set:function(e,t){if(""===t)return e.setAttribute(i,"auto"),t}}})),ne.style||(re.attrHooks.style={get:function(e){return e.style.cssText||undefined},set:function(e,t){return e.style.cssText=t+""}});var jt=/^(?:input|select|textarea|button|object)$/i,Dt=/^(?:a|area)$/i;re.fn.extend({prop:function(e,t){return Ne(this,re.prop,e,t,1<arguments.length)},removeProp:function(t){return t=re.propFix[t]||t,this.each(function(){try{this[t]=undefined,delete this[t]}catch(e){}})}}),re.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,i){var n,o,r=e.nodeType;if(e&&3!==r&&8!==r&&2!==r)return(1!==r||!re.isXMLDoc(e))&&(t=re.propFix[t]||t,o=re.propHooks[t]),i!==undefined?o&&"set"in o&&(n=o.set(e,i,t))!==undefined?n:e[t]=i:o&&"get"in o&&null!==(n=o.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){var t=re.find.attr(e,"tabindex");return t?parseInt(t,10):jt.test(e.nodeName)||Dt.test(e.nodeName)&&e.href?0:-1}}}}),ne.hrefNormalized||re.each(["href","src"],function(e,t){re.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),ne.optSelected||(re.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),re.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){re.propFix[this.toLowerCase()]=this}),ne.enctype||(re.propFix.enctype="encoding");var Ht=/[\t\r\n\f]/g;re.fn.extend({addClass:function(t){var e,i,n,o,r,a,s=0,l=this.length,c="string"==typeof t&&t;if(re.isFunction(t))return this.each(function(e){re(this).addClass(t.call(this,e,this.className))});if(c)for(e=(t||"").match(ye)||[];s<l;s++)if(n=1===(i=this[s]).nodeType&&(i.className?(" "+i.className+" ").replace(Ht," "):" ")){for(r=0;o=e[r++];)n.indexOf(" "+o+" ")<0&&(n+=o+" ");a=re.trim(n),i.className!==a&&(i.className=a)}return this},removeClass:function(t){var e,i,n,o,r,a,s=0,l=this.length,c=0===arguments.length||"string"==typeof t&&t;if(re.isFunction(t))return this.each(function(e){re(this).removeClass(t.call(this,e,this.className))});if(c)for(e=(t||"").match(ye)||[];s<l;s++)if(n=1===(i=this[s]).nodeType&&(i.className?(" "+i.className+" ").replace(Ht," "):"")){for(r=0;o=e[r++];)for(;0<=n.indexOf(" "+o+" ");)n=n.replace(" "+o+" "," ");a=t?re.trim(n):"",i.className!==a&&(i.className=a)}return this},toggleClass:function(o,t){var r=typeof o;return"boolean"==typeof t&&"string"===r?t?this.addClass(o):this.removeClass(o):re.isFunction(o)?this.each(function(e){re(this).toggleClass(o.call(this,e,this.className,t),t)}):this.each(function(){if("string"===r)for(var e,t=0,i=re(this),n=o.match(ye)||[];e=n[t++];)i.hasClass(e)?i.removeClass(e):i.addClass(e);else r!==$e&&"boolean"!==r||(this.className&&re._data(this,"__className__",this.className),this.className=this.className||!1===o?"":re._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,n=this.length;i<n;i++)if(1===this[i].nodeType&&0<=(" "+this[i].className+" ").replace(Ht," ").indexOf(t))return!0;return!1}}),re.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,i){re.fn[i]=function(e,t){return 0<arguments.length?this.on(i,null,e,t):this.trigger(i)}}),re.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}});var zt=re.now(),Wt=/\?/,Rt=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;re.parseJSON=function(e){if(m.JSON&&m.JSON.parse)return m.JSON.parse(e+"");var o,r=null,t=re.trim(e+"");return t&&!re.trim(t.replace(Rt,function(e,t,i,n){return o&&t&&(r=0),0===r?e:(o=i||t,r+=!n-!i,"")}))?Function("return "+t)():re.error("Invalid JSON: "+e)},re.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{m.DOMParser?t=(new DOMParser).parseFromString(e,"text/xml"):((t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e))}catch(i){t=undefined}return t&&t.documentElement&&!t.getElementsByTagName("parsererror").length||re.error("Invalid XML: "+e),t};var Mt,qt,Ft=/#.*$/,Bt=/([?&])_=[^&]*/,Ut=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Yt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Xt=/^(?:GET|HEAD)$/,Gt=/^\/\//,Qt=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Vt={},Kt={},Jt="*/".concat("*");try{qt=location.href}catch(fi){(qt=me.createElement("a")).href="",qt=qt.href}Mt=Qt.exec(qt.toLowerCase())||[],re.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:qt,type:"GET",isLocal:Yt.test(Mt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Jt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":re.parseJSON,"text xml":re.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?M(M(e,re.ajaxSettings),t):M(re.ajaxSettings,e)},ajaxPrefilter:W(Vt),ajaxTransport:W(Kt),ajax:function(e,t){function i(e,t,i,n){var o,r,a,s,l,c=t;2!==w&&(w=2,h&&clearTimeout(h),p=undefined,u=n||"",k.readyState=0<e?4:0,o=200<=e&&e<300||304===e,i&&(s=q(m,k,i)),s=F(m,s,k,o),o?(m.ifModified&&((l=k.getResponseHeader("Last-Modified"))&&(re.lastModified[d]=l),(l=k.getResponseHeader("etag"))&&(re.etag[d]=l)),204===e||"HEAD"===m.type?c="nocontent":304===e?c="notmodified":(c=s.state,r=s.data,o=!(a=s.error))):(a=c,!e&&c||(c="error",e<0&&(e=0))),k.status=e,k.statusText=(t||c)+"",o?v.resolveWith(g,[r,c,k]):v.rejectWith(g,[k,c,a]),k.statusCode(y),y=undefined,f&&_.trigger(o?"ajaxSuccess":"ajaxError",[k,m,o?r:a]),b.fireWith(g,[k,c]),f&&(_.trigger("ajaxComplete",[k,m]),--re.active||re.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=undefined),t=t||{};var n,o,d,u,h,f,p,r,m=re.ajaxSetup({},t),g=m.context||m,_=m.context&&(g.nodeType||g.jquery)?re(g):re.event,v=re.Deferred(),b=re.Callbacks("once memory"),y=m.statusCode||{},a={},s={},w=0,l="canceled",k={readyState:0,getResponseHeader:function(e){var t;if(2===w){if(!r)for(r={};t=Ut.exec(u);)r[t[1].toLowerCase()]=t[2];t=r[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===w?u:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return w||(e=s[i]=s[i]||e,a[e]=t),this},overrideMimeType:function(e){return w||(m.mimeType=e),this},statusCode:function(e){var t;if(e)if(w<2)for(t in e)y[t]=[y[t],e[t]];else k.always(e[k.status]);return this},abort:function(e){var t=e||l;return p&&p.abort(t),i(0,t),this}};if(v.promise(k).complete=b.add,k.success=k.done,k.error=k.fail,m.url=((e||m.url||qt)+"").replace(Ft,"").replace(Gt,Mt[1]+"//"),m.type=t.method||t.type||m.method||m.type,m.dataTypes=re.trim(m.dataType||"*").toLowerCase().match(ye)||[""],null==m.crossDomain&&(n=Qt.exec(m.url.toLowerCase()),m.crossDomain=!(!n||n[1]===Mt[1]&&n[2]===Mt[2]&&(n[3]||("http:"===n[1]?"80":"443"))===(Mt[3]||("http:"===Mt[1]?"80":"443")))),m.data&&m.processData&&"string"!=typeof m.data&&(m.data=re.param(m.data,m.traditional)),R(Vt,m,t,k),2===w)return k;for(o in(f=m.global)&&0==re.active++&&re.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!Xt.test(m.type),d=m.url,m.hasContent||(m.data&&(d=m.url+=(Wt.test(d)?"&":"?")+m.data,delete m.data),!1===m.cache&&(m.url=Bt.test(d)?d.replace(Bt,"$1_="+zt++):d+(Wt.test(d)?"&":"?")+"_="+zt++)),m.ifModified&&(re.lastModified[d]&&k.setRequestHeader("If-Modified-Since",re.lastModified[d]),re.etag[d]&&k.setRequestHeader("If-None-Match",re.etag[d])),(m.data&&m.hasContent&&!1!==m.contentType||t.contentType)&&k.setRequestHeader("Content-Type",m.contentType),k.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+Jt+"; q=0.01":""):m.accepts["*"]),m.headers)k.setRequestHeader(o,m.headers[o]);if(m.beforeSend&&(!1===m.beforeSend.call(g,k,m)||2===w))return k.abort();for(o in l="abort",{success:1,error:1,complete:1})k[o](m[o]);if(p=R(Kt,m,t,k)){k.readyState=1,f&&_.trigger("ajaxSend",[k,m]),m.async&&0<m.timeout&&(h=setTimeout(function(){k.abort("timeout")},m.timeout));try{w=1,p.send(a,i)}catch(fi){if(!(w<2))throw fi;i(-1,fi)}}else i(-1,"No Transport");return k},getJSON:function(e,t,i){return re.get(e,t,i,"json")},getScript:function(e,t){return re.get(e,undefined,t,"script")}}),re.each(["get","post"],function(e,o){re[o]=function(e,t,i,n){return re.isFunction(t)&&(n=n||i,i=t,t=undefined),re.ajax({url:e,type:o,dataType:n,data:t,success:i})}}),re.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){re.fn[t]=function(e){return this.on(t,e)}}),re._evalUrl=function(e){return re.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},re.fn.extend({wrapAll:function(t){if(re.isFunction(t))return this.each(function(e){re(this).wrapAll(t.call(this,e))});if(this[0]){var e=re(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(i){return re.isFunction(i)?this.each(function(e){re(this).wrapInner(i.call(this,e))}):this.each(function(){var e=re(this),t=e.contents();t.length?t.wrapAll(i):e.append(i)})},wrap:function(t){var i=re.isFunction(t);return this.each(function(e){re(this).wrapAll(i?t.call(this,e):t)})},unwrap:function(){return this.parent().each(function(){re.nodeName(this,"body")||re(this).replaceWith(this.childNodes)}).end()}}),re.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!ne.reliableHiddenOffsets()&&"none"===(e.style&&e.style.display||re.css(e,"display"))},re.expr.filters.visible=function(e){return!re.expr.filters.hidden(e)};var Zt=/%20/g,ei=/\[\]$/,ti=/\r?\n/g,ii=/^(?:submit|button|image|reset|file)$/i,ni=/^(?:input|select|textarea|keygen)/i;re.param=function(e,t){var i,n=[],o=function(e,t){t=re.isFunction(t)?t():null==t?"":t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(t===undefined&&(t=re.ajaxSettings&&re.ajaxSettings.traditional),re.isArray(e)||e.jquery&&!re.isPlainObject(e))re.each(e,function(){o(this.name,this.value)});else for(i in e)B(i,e[i],t,o);return n.join("&").replace(Zt,"+")},re.fn.extend({serialize:function(){return re.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=re.prop(this,"elements");return e?re.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!re(this).is(":disabled")&&ni.test(this.nodeName)&&!ii.test(e)&&(this.checked||!Ae.test(e))}).map(function(e,t){var i=re(this).val();return null==i?null:re.isArray(i)?re.map(i,function(e){return{name:t.name,value:e.replace(ti,"\r\n")}}):{name:t.name,value:i.replace(ti,"\r\n")}}).get()}}),re.ajaxSettings.xhr=m.ActiveXObject!==undefined?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&U()||Y()}:U;var oi=0,ri={},ai=re.ajaxSettings.xhr();m.ActiveXObject&&re(m).on("unload",function(){for(var e in ri)ri[e](undefined,!0)}),ne.cors=!!ai&&"withCredentials"in ai,(ai=ne.ajax=!!ai)&&re.ajaxTransport(function(l){var c;if(!l.crossDomain||ne.cors)return{send:function(e,r){var t,a=l.xhr(),s=++oi;if(a.open(l.type,l.url,l.async,l.username,l.password),l.xhrFields)for(t in l.xhrFields)a[t]=l.xhrFields[t];for(t in l.mimeType&&a.overrideMimeType&&a.overrideMimeType(l.mimeType),l.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)e[t]!==undefined&&a.setRequestHeader(t,e[t]+"");a.send(l.hasContent&&l.data||null),c=function(e,t){var i,n,o;if(c&&(t||4===a.readyState))if(delete ri[s],c=undefined,a.onreadystatechange=re.noop,t)4!==a.readyState&&a.abort();else{o={},i=a.status,"string"==typeof a.responseText&&(o.text=a.responseText);try{n=a.statusText}catch(fi){n=""}i||!l.isLocal||l.crossDomain?1223===i&&(i=204):i=o.text?200:404}o&&r(i,n,o,a.getAllResponseHeaders())},l.async?4===a.readyState?setTimeout(c):a.onreadystatechange=ri[s]=c:c()},abort:function(){c&&c(undefined,!0)}}}),re.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return re.globalEval(e),e}}}),re.ajaxPrefilter("script",function(e){e.cache===undefined&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),re.ajaxTransport("script",function(t){if(t.crossDomain){var n,o=me.head||re("head")[0]||me.documentElement;return{send:function(e,i){(n=me.createElement("script")).async=!0,t.scriptCharset&&(n.charset=t.scriptCharset),n.src=t.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,"success"))},o.insertBefore(n,o.firstChild)},abort:function(){n&&n.onload(undefined,!0)}}}});var si=[],li=/(=)\?(?=&|$)|\?\?/;re.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=si.pop()||re.expando+"_"+zt++;return this[e]=!0,e}}),re.ajaxPrefilter("json jsonp",function(e,t,i){var n,o,r,a=!1!==e.jsonp&&(li.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&li.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return n=e.jsonpCallback=re.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(li,"$1"+n):!1!==e.jsonp&&(e.url+=(Wt.test(e.url)?"&":"?")+e.jsonp+"="+n),e.converters["script json"]=function(){return r||re.error(n+" was not called"),r[0]},e.dataTypes[0]="json",o=m[n],m[n]=function(){r=arguments},i.always(function(){m[n]=o,e[n]&&(e.jsonpCallback=t.jsonpCallback,si.push(n)),r&&re.isFunction(o)&&o(r[0]),r=o=undefined}),"script"}),re.parseHTML=function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||me;var n=he.exec(e),o=!i&&[];return n?[t.createElement(n[1])]:(n=re.buildFragment([e],t,o),o&&o.length&&re(o).remove(),re.merge([],n.childNodes))};var ci=re.fn.load;re.fn.load=function(e,t,i){if("string"!=typeof e&&ci)return ci.apply(this,arguments);var n,o,r,a=this,s=e.indexOf(" ");return 0<=s&&(n=e.slice(s,e.length),e=e.slice(0,s)),re.isFunction(t)?(i=t,t=undefined):t&&"object"==typeof t&&(r="POST"),0<a.length&&re.ajax({url:e,type:r,dataType:"html",data:t}).done(function(e){o=arguments,a.html(n?re("<div>").append(re.parseHTML(e)).find(n):e)}).complete(i&&function(e,t){a.each(i,o||[e.responseText,t,e])}),this},re.expr.filters.animated=function(t){return re.grep(re.timers,function(e){return t===e.elem}).length};var di=m.document.documentElement;re.offset={setOffset:function(e,t,i){var n,o,r,a,s,l,c=re.css(e,"position"),d=re(e),u={};"static"===c&&(e.style.position="relative"),s=d.offset(),r=re.css(e,"top"),l=re.css(e,"left"),("absolute"===c||"fixed"===c)&&-1<re.inArray("auto",[r,l])?(a=(n=d.position()).top,o=n.left):(a=parseFloat(r)||0,o=parseFloat(l)||0),re.isFunction(t)&&(t=t.call(e,i,s)),null!=t.top&&(u.top=t.top-s.top+a),null!=t.left&&(u.left=t.left-s.left+o),"using"in t?t.using.call(e,u):d.css(u)}},re.fn.extend({offset:function(t){if(arguments.length)return t===undefined?this:this.each(function(e){re.offset.setOffset(this,t,e)});var e,i,n={top:0,left:0},o=this[0],r=o&&o.ownerDocument;return r?(e=r.documentElement,re.contains(e,o)?(typeof o.getBoundingClientRect!==$e&&(n=o.getBoundingClientRect()),i=X(r),{top:n.top+(i.pageYOffset||e.scrollTop)-(e.clientTop||0),left:n.left+(i.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}):n):void 0},position:function(){if(this[0]){var e,t,i={top:0,left:0},n=this[0];return"fixed"===re.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),re.nodeName(e[0],"html")||(i=e.offset()),i.top+=re.css(e[0],"borderTopWidth",!0),i.left+=re.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-re.css(n,"marginTop",!0),left:t.left-i.left-re.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||di;e&&!re.nodeName(e,"html")&&"static"===re.css(e,"position");)e=e.offsetParent;return e||di})}}),re.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,o){var r=/Y/.test(o);re.fn[t]=function(e){return Ne(this,function(e,t,i){var n=X(e);if(i===undefined)return n?o in n?n[o]:n.document.documentElement[t]:e[t];n?n.scrollTo(r?re(n).scrollLeft():i,r?i:re(n).scrollTop()):e[t]=i},t,e,arguments.length,null)}}),re.each(["top","left"],function(e,i){re.cssHooks[i]=T(ne.pixelPosition,function(e,t){if(t)return t=ot(e,i),at.test(t)?re(e).position()[i]+"px":t})}),re.each({Height:"height",Width:"width"},function(r,a){re.each({padding:"inner"+r,content:a,"":"outer"+r},function(n,e){re.fn[e]=function(e,t){var i=arguments.length&&(n||"boolean"!=typeof e),o=n||(!0===e||!0===t?"margin":"border");return Ne(this,function(e,t,i){var n;return re.isWindow(e)?e.document.documentElement["client"+r]:9===e.nodeType?(n=e.documentElement,Math.max(e.body["scroll"+r],n["scroll"+r],e.body["offset"+r],n["offset"+r],n["client"+r])):i===undefined?re.css(e,t,o):re.style(e,t,i,o)},a,i?e:undefined,i,null)}})}),re.fn.size=function(){return this.length},re.fn.andSelf=re.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return re});var ui=m.jQuery,hi=m.$;return re.noConflict=function(e){return m.$===re&&(m.$=hi),e&&m.jQuery===re&&(m.jQuery=ui),re},typeof e===$e&&(m.jQuery=m.$=re),re}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(s){function n(e,t){var i,n,o,r=e.nodeName.toLowerCase();return"area"===r?(n=(i=e.parentNode).name,!(!e.href||!n||"map"!==i.nodeName.toLowerCase())&&(!!(o=s("img[usemap='#"+n+"']")[0])&&a(o))):(/input|select|textarea|button|object/.test(r)?!e.disabled:"a"===r&&e.href||t)&&a(e)}function a(e){return s.expr.filters.visible(e)&&!s(e).parents().addBack().filter(function(){return"hidden"===s.css(this,"visibility")}).length}var e,t,i,o;s.ui=s.ui||{},s.extend(s.ui,{version:"1.11.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),s.fn.extend({scrollParent:function(e){var t=this.css("position"),i="absolute"===t,n=e?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter(function(){var e=s(this);return(!i||"static"!==e.css("position"))&&n.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==t&&o.length?o:s(this[0].ownerDocument||document)},uniqueId:(e=0,function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&s(this).removeAttr("id")})}}),s.extend(s.expr[":"],{data:s.expr.createPseudo?s.expr.createPseudo(function(t){return function(e){return!!s.data(e,t)}}):function(e,t,i){return!!s.data(e,i[3])},focusable:function(e){return n(e,!isNaN(s.attr(e,"tabindex")))},tabbable:function(e){var t=s.attr(e,"tabindex"),i=isNaN(t);return(i||0<=t)&&n(e,!i)}}),s("<a>").outerWidth(1).jquery||s.each(["Width","Height"],function(e,i){function n(e,t,i,n){return s.each(o,function(){t-=parseFloat(s.css(e,"padding"+this))||0,i&&(t-=parseFloat(s.css(e,"border"+this+"Width"))||0),n&&(t-=parseFloat(s.css(e,"margin"+this))||0)}),t}var o="Width"===i?["Left","Right"]:["Top","Bottom"],r=i.toLowerCase(),a={innerWidth:s.fn.innerWidth,innerHeight:s.fn.innerHeight,outerWidth:s.fn.outerWidth,outerHeight:s.fn.outerHeight};s.fn["inner"+i]=function(e){return e===undefined?a["inner"+i].call(this):this.each(function(){s(this).css(r,n(this,e)+"px")})},s.fn["outer"+i]=function(e,t){return"number"!=typeof e?a["outer"+i].call(this,e):this.each(function(){s(this).css(r,n(this,e,!0,t)+"px")})}}),s.fn.addBack||(s.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),s("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(s.fn.removeData=(t=s.fn.removeData,function(e){return arguments.length?t.call(this,s.camelCase(e)):t.call(this)})),s.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),s.fn.extend({focus:(o=s.fn.focus,function(t,i){return"number"==typeof t?this.each(function(){var e=this;setTimeout(function(){s(e).focus(),i&&i.call(e)},t)}):o.apply(this,arguments)}),disableSelection:(i="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.bind(i+".ui-disableSelection",function(e){e.preventDefault()})}),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(e!==undefined)return this.css("zIndex",e);if(this.length)for(var t,i,n=s(this[0]);n.length&&n[0]!==document;){if(("absolute"===(t=n.css("position"))||"relative"===t||"fixed"===t)&&(i=parseInt(n.css("zIndex"),10),!isNaN(i)&&0!==i))return i;n=n.parent()}return 0}}),s.ui.plugin={add:function(e,t,i){var n,o=s.ui[e].prototype;for(n in i)o.plugins[n]=o.plugins[n]||[],o.plugins[n].push([t,i[n]])},call:function(e,t,i,n){var o,r=e.plugins[t];if(r&&(n||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(o=0;o<r.length;o++)e.options[r[o][0]]&&r[o][1].apply(e.element,i)}}}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(d){var r,i=0,s=Array.prototype.slice;return d.cleanData=(r=d.cleanData,function(e){var t,i,n;for(n=0;null!=(i=e[n]);n++)try{(t=d._data(i,"events"))&&t.remove&&d(i).triggerHandler("remove")}catch(o){}r(e)}),d.widget=function(e,i,t){var n,o,r,a,s={},l=e.split(".")[0];return e=e.split(".")[1],n=l+"-"+e,t||(t=i,i=d.Widget),d.expr[":"][n.toLowerCase()]=function(e){return!!d.data(e,n)},d[l]=d[l]||{},o=d[l][e],r=d[l][e]=function(e,t){if(!this._createWidget)return new r(e,t);arguments.length&&this._createWidget(e,t)},d.extend(r,o,{version:t.version,_proto:d.extend({},t),_childConstructors:[]}),(a=new i).options=d.widget.extend({},a.options),d.each(t,function(t,n){var o,r;d.isFunction(n)?s[t]=(o=function(){return i.prototype[t].apply(this,arguments)},r=function(e){return i.prototype[t].apply(this,e)},function(){var e,t=this._super,i=this._superApply;return this._super=o,this._superApply=r,e=n.apply(this,arguments),this._super=t,this._superApply=i,e}):s[t]=n}),r.prototype=d.widget.extend(a,{widgetEventPrefix:o&&a.widgetEventPrefix||e},s,{constructor:r,namespace:l,widgetName:e,widgetFullName:n}),o?(d.each(o._childConstructors,function(e,t){var i=t.prototype;d.widget(i.namespace+"."+i.widgetName,r,t._proto)}),delete o._childConstructors):i._childConstructors.push(r),d.widget.bridge(e,r),r},d.widget.extend=function(e){for(var t,i,n=s.call(arguments,1),o=0,r=n.length;o<r;o++)for(t in n[o])i=n[o][t],n[o].hasOwnProperty(t)&&i!==undefined&&(d.isPlainObject(i)?e[t]=d.isPlainObject(e[t])?d.widget.extend({},e[t],i):d.widget.extend({},i):e[t]=i);return e},d.widget.bridge=function(r,t){var a=t.prototype.widgetFullName||r;d.fn[r]=function(i){var e="string"==typeof i,n=s.call(arguments,1),o=this;return i=!e&&n.length?d.widget.extend.apply(null,[i].concat(n)):i,e?this.each(function(){var e,t=d.data(this,a);return"instance"===i?(o=t,!1):t?d.isFunction(t[i])&&"_"!==i.charAt(0)?(e=t[i].apply(t,n))!==t&&e!==undefined?(o=e&&e.jquery?o.pushStack(e.get()):e,!1):void 0:d.error("no such method '"+i+"' for "+r+" widget instance"):d.error("cannot call methods on "+r+" prior to initialization; attempted to call method '"+i+"'")}):this.each(function(){var e=d.data(this,a);e?(e.option(i||{}),e._init&&e._init()):d.data(this,a,new t(i,this))}),o}},d.Widget=function(){},d.Widget._childConstructors=[],d.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,t){t=d(t||this.defaultElement||this)[0],this.element=d(t),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=d(),this.hoverable=d(),this.focusable=d(),t!==this&&(d.data(t,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===t&&this.destroy()}}),this.document=d(t.style?t.ownerDocument:t.document||t),this.window=d(this.document[0].defaultView||this.document[0].parentWindow)),this.options=d.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:d.noop,_getCreateEventData:d.noop,_create:d.noop,_init:d.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(d.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:d.noop,widget:function(){return this.element},option:function(e,t){var i,n,o,r=e;if(0===arguments.length)return d.widget.extend({},this.options);if("string"==typeof e)if(r={},e=(i=e.split(".")).shift(),i.length){for(n=r[e]=d.widget.extend({},this.options[e]),o=0;o<i.length-1;o++)n[i[o]]=n[i[o]]||{},n=n[i[o]];if(e=i.pop(),1===arguments.length)return n[e]===undefined?null:n[e];n[e]=t}else{if(1===arguments.length)return this.options[e]===undefined?null:this.options[e];r[e]=t}return this._setOptions(r),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(a,s,e){var l,c=this;"boolean"!=typeof a&&(e=s,s=a,a=!1),e?(s=l=d(s),this.bindings=this.bindings.add(s)):(e=s,s=this.element,l=this.widget()),d.each(e,function(e,t){function i(){if(a||!0!==c.options.disabled&&!d(this).hasClass("ui-state-disabled"))return("string"==typeof t?c[t]:t).apply(c,arguments)}"string"!=typeof t&&(i.guid=t.guid=t.guid||i.guid||d.guid++);var n=e.match(/^([\w:-]*)\s*(.*)$/),o=n[1]+c.eventNamespace,r=n[2];r?l.delegate(r,o,i):s.bind(o,i)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t),this.bindings=d(this.bindings.not(e).get()),this.focusable=d(this.focusable.not(e).get()),this.hoverable=d(this.hoverable.not(e).get())},_delay:function(e,t){function i(){return("string"==typeof e?n[e]:e).apply(n,arguments)}var n=this;return setTimeout(i,t||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){d(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){d(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){d(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){d(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,t,i){var n,o,r=this.options[e];if(i=i||{},(t=d.Event(t)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),t.target=this.element[0],o=t.originalEvent)for(n in o)n in t||(t[n]=o[n]);return this.element.trigger(t,i),!(d.isFunction(r)&&!1===r.apply(this.element[0],[t].concat(i))||t.isDefaultPrevented())}},d.each({show:"fadeIn",hide:"fadeOut"},function(r,a){d.Widget.prototype["_"+r]=function(t,e,i){"string"==typeof e&&(e={effect:e});var n,o=e?!0===e||"number"==typeof e?a:e.effect||a:r;"number"==typeof(e=e||{})&&(e={duration:e}),n=!d.isEmptyObject(e),e.complete=i,e.delay&&t.delay(e.delay),n&&d.effects&&d.effects.effect[o]?t[r](e):o!==r&&t[o]?t[o](e.duration,e.easing,i):t.queue(function(e){d(this)[r](),i&&i.call(t[0]),e()})}}),d.widget}),function(e){"function"==typeof define&&define.amd?define(["jquery","./widget"],e):e(jQuery)}(function(o){var r=!1;return o(document).mouseup(function(){r=!1}),o.widget("ui.mouse",{version:"1.11.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(e){if(!0===o.data(e.target,t.widgetName+".preventClickEvent"))return o.removeData(e.target,t.widgetName+".preventClickEvent"),e.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!r){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var t=this,i=1===e.which,n=!("string"!=typeof this.options.cancel||!e.target.nodeName)&&o(e.target).closest(this.options.cancel).length;return!(i&&!n&&this._mouseCapture(e))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){t.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(e),!this._mouseStarted)?(e.preventDefault(),!0):(!0===o.data(e.target,this.widgetName+".preventClickEvent")&&o.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return t._mouseMove(e)},this._mouseUpDelegate=function(e){return t._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),r=!0))}},_mouseMove:function(e){if(this._mouseMoved){if(o.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button)return this._mouseUp(e);if(!e.which)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,e),this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&o.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),r=!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}),function(e){"function"==typeof define&&define.amd?define(["jquery","./core","./mouse","./widget"],e):e(jQuery)}(function(f){return f.widget("ui.sortable",f.ui.mouse,{version:"1.11.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,i){return t<=e&&e<t+i},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(
e.css("display"))},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=!!this.items.length&&("x"===e.axis||this._isFloating(this.items[0].item)),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),f.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var e=this.items.length-1;0<=e;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(e,t){var i=null,n=!1,o=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(e),f(e.target).parents().each(function(){if(f.data(this,o.widgetName+"-item")===o)return i=f(this),!1}),f.data(e.target,o.widgetName+"-item")===o&&(i=f(e.target)),!!i&&(!(this.options.handle&&!t&&(f(this.options.handle,i).find("*").addBack().each(function(){this===e.target&&(n=!0)}),!n))&&(this.currentItem=i,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(e,t,i){var n,o,r=this.options;if((this.currentContainer=this).refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},f.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,r.cursorAt&&this._adjustOffsetFromHelper(r.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),r.containment&&this._setContainment(),r.cursor&&"auto"!==r.cursor&&(o=this.document.find("body"),this.storedCursor=o.css("cursor"),o.css("cursor",r.cursor),this.storedStylesheet=f("<style>*{ cursor: "+r.cursor+" !important; }</style>").appendTo(o)),r.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",r.opacity)),r.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",r.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!i)for(n=this.containers.length-1;0<=n;n--)this.containers[n]._trigger("activate",e,this._uiHash(this));return f.ui.ddmanager&&(f.ui.ddmanager.current=this),f.ui.ddmanager&&!r.dropBehaviour&&f.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var t,i,n,o,r=this.options,a=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<r.scrollSensitivity?this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop+r.scrollSpeed:e.pageY-this.overflowOffset.top<r.scrollSensitivity&&(this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop-r.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<r.scrollSensitivity?this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft+r.scrollSpeed:e.pageX-this.overflowOffset.left<r.scrollSensitivity&&(this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft-r.scrollSpeed)):(e.pageY-f(document).scrollTop()<r.scrollSensitivity?a=f(document).scrollTop(f(document).scrollTop()-r.scrollSpeed):f(window).height()-(e.pageY-f(document).scrollTop())<r.scrollSensitivity&&(a=f(document).scrollTop(f(document).scrollTop()+r.scrollSpeed)),e.pageX-f(document).scrollLeft()<r.scrollSensitivity?a=f(document).scrollLeft(f(document).scrollLeft()-r.scrollSpeed):f(window).width()-(e.pageX-f(document).scrollLeft())<r.scrollSensitivity&&(a=f(document).scrollLeft(f(document).scrollLeft()+r.scrollSpeed))),!1!==a&&f.ui.ddmanager&&!r.dropBehaviour&&f.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),t=this.items.length-1;0<=t;t--)if(n=(i=this.items[t]).item[0],(o=this._intersectsWithPointer(i))&&i.instance===this.currentContainer&&!(n===this.currentItem[0]||this.placeholder[1===o?"next":"prev"]()[0]===n||f.contains(this.placeholder[0],n)||"semi-dynamic"===this.options.type&&f.contains(this.element[0],n))){if(this.direction=1===o?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(i))break;this._rearrange(e,i),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),f.ui.ddmanager&&f.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,t){if(e){if(f.ui.ddmanager&&!this.options.dropBehaviour&&f.ui.ddmanager.drop(this,e),this.options.revert){var i=this,n=this.placeholder.offset(),o=this.options.axis,r={};o&&"x"!==o||(r.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),o&&"y"!==o||(r.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,f(this.helper).animate(r,parseInt(this.options.revert,10)||500,function(){i._clear(e)})}else this._clear(e,t);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;0<=e;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),f.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?f(this.domPosition.prev).after(this.currentItem):f(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var e=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},f(e).each(function(){var e=(f(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);e&&i.push((t.key||e[1]+"[]")+"="+(t.key&&t.expression?e[1]:e[2]))}),!i.length&&t.key&&i.push(t.key+"="),i.join("&")},toArray:function(e){var t=this._getItemsAsjQuery(e&&e.connected),i=[];return e=e||{},t.each(function(){i.push(f(e.item||this).attr(e.attribute||"id")||"")}),i},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,n=this.positionAbs.top,o=n+this.helperProportions.height,r=e.left,a=r+e.width,s=e.top,l=s+e.height,c=this.offset.click.top,d=this.offset.click.left,u="x"===this.options.axis||s<n+c&&n+c<l,h="y"===this.options.axis||r<t+d&&t+d<a,f=u&&h;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?f:r<t+this.helperProportions.width/2&&i-this.helperProportions.width/2<a&&s<n+this.helperProportions.height/2&&o-this.helperProportions.height/2<l},_intersectsWithPointer:function(e){var t="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),i="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),n=t&&i,o=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return!!n&&(this.floating?r&&"right"===r||"down"===o?2:1:o&&("down"===o?2:1))},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),n=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return this.floating&&o?"right"===o&&i||"left"===o&&!i:n&&("down"===n&&t||"up"===n&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(0<e?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(0<e?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(e){function t(){a.push(this)}var i,n,o,r,a=[],s=[],l=this._connectWith();if(l&&e)for(i=l.length-1;0<=i;i--)for(n=(o=f(l[i])).length-1;0<=n;n--)(r=f.data(o[n],this.widgetFullName))&&r!==this&&!r.options.disabled&&s.push([f.isFunction(r.options.items)?r.options.items.call(r.element):f(r.options.items,r.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),r]);for(s.push([f.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):f(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),i=s.length-1;0<=i;i--)s[i][0].each(t);return f(a)},_removeCurrentsFromItems:function(){var i=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=f.grep(this.items,function(e){for(var t=0;t<i.length;t++)if(i[t]===e.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var t,i,n,o,r,a,s,l,c=this.items,d=[[f.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):f(this.options.items,this.element),this]],u=this._connectWith();if(u&&this.ready)for(t=u.length-1;0<=t;t--)for(i=(n=f(u[t])).length-1;0<=i;i--)(o=f.data(n[i],this.widgetFullName))&&o!==this&&!o.options.disabled&&(d.push([f.isFunction(o.options.items)?o.options.items.call(o.element[0],e,{item:this.currentItem}):f(o.options.items,o.element),o]),this.containers.push(o));for(t=d.length-1;0<=t;t--)for(r=d[t][1],i=0,l=(a=d[t][0]).length;i<l;i++)(s=f(a[i])).data(this.widgetName+"-item",r),c.push({item:s,instance:r,width:0,height:0,left:0,top:0})},refreshPositions:function(e){var t,i,n,o;for(this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset()),t=this.items.length-1;0<=t;t--)(i=this.items[t]).instance!==this.currentContainer&&this.currentContainer&&i.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?f(this.options.toleranceElement,i.item):i.item,e||(i.width=n.outerWidth(),i.height=n.outerHeight()),o=n.offset(),i.left=o.left,i.top=o.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(t=this.containers.length-1;0<=t;t--)o=this.containers[t].element.offset(),this.containers[t].containerCache.left=o.left,this.containers[t].containerCache.top=o.top,this.containers[t].containerCache.width=this.containers[t].element.outerWidth(),this.containers[t].containerCache.height=this.containers[t].element.outerHeight();return this},_createPlaceholder:function(i){var n,o=(i=i||this).options;o.placeholder&&o.placeholder.constructor!==String||(n=o.placeholder,o.placeholder={element:function(){var e=i.currentItem[0].nodeName.toLowerCase(),t=f("<"+e+">",i.document[0]).addClass(n||i.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===e?i.currentItem.children().each(function(){f("<td>&#160;</td>",i.document[0]).attr("colspan",f(this).attr("colspan")||1).appendTo(t)}):"img"===e&&t.attr("src",i.currentItem.attr("src")),n||t.css("visibility","hidden"),t},update:function(e,t){n&&!o.forcePlaceholderSize||(t.height()||t.height(i.currentItem.innerHeight()-parseInt(i.currentItem.css("paddingTop")||0,10)-parseInt(i.currentItem.css("paddingBottom")||0,10)),t.width()||t.width(i.currentItem.innerWidth()-parseInt(i.currentItem.css("paddingLeft")||0,10)-parseInt(i.currentItem.css("paddingRight")||0,10)))}}),i.placeholder=f(o.placeholder.element.call(i.element,i.currentItem)),i.currentItem.after(i.placeholder),o.placeholder.update(i,i.placeholder)},_contactContainers:function(e){var t,i,n,o,r,a,s,l,c,d,u=null,h=null;for(t=this.containers.length-1;0<=t;t--)if(!f.contains(this.currentItem[0],this.containers[t].element[0]))if(this._intersectsWith(this.containers[t].containerCache)){if(u&&f.contains(this.containers[t].element[0],u.element[0]))continue;u=this.containers[t],h=t}else this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",e,this._uiHash(this)),this.containers[t].containerCache.over=0);if(u)if(1===this.containers.length)this.containers[h].containerCache.over||(this.containers[h]._trigger("over",e,this._uiHash(this)),this.containers[h].containerCache.over=1);else{for(n=1e4,o=null,r=(c=u.floating||this._isFloating(this.currentItem))?"left":"top",a=c?"width":"height",d=c?"clientX":"clientY",i=this.items.length-1;0<=i;i--)f.contains(this.containers[h].element[0],this.items[i].item[0])&&this.items[i].item[0]!==this.currentItem[0]&&(s=this.items[i].item.offset()[r],l=!1,e[d]-s>this.items[i][a]/2&&(l=!0),Math.abs(e[d]-s)<n&&(n=Math.abs(e[d]-s),o=this.items[i],this.direction=l?"up":"down"));if(!o&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[h])return void(this.currentContainer.containerCache.over||(this.containers[h]._trigger("over",e,this._uiHash()),this.currentContainer.containerCache.over=1));o?this._rearrange(e,o,null,!0):this._rearrange(e,null,this.containers[h].element,!0),this._trigger("change",e,this._uiHash()),this.containers[h]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[h],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[h]._trigger("over",e,this._uiHash(this)),this.containers[h].containerCache.over=1}},_createHelper:function(e){var t=this.options,i=f.isFunction(t.helper)?f(t.helper.apply(this.element[0],[e,this.currentItem])):"clone"===t.helper?this.currentItem.clone():this.currentItem;return i.parents("body").length||f("parent"!==t.appendTo?t.appendTo:this.currentItem[0].parentNode)[0].appendChild(i[0]),i[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),i[0].style.width&&!t.forceHelperSize||i.width(this.currentItem.width()),i[0].style.height&&!t.forceHelperSize||i.height(this.currentItem.height()),i},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),f.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&f.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&f.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,t,i,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),"document"!==n.containment&&"window"!==n.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,f("document"===n.containment?document:window).width()-this.helperProportions.width-this.margins.left,(f("document"===n.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(e=f(n.containment)[0],t=f(n.containment).offset(),i="hidden"!==f(e).css("overflow"),this.containment=[t.left+(parseInt(f(e).css("borderLeftWidth"),10)||0)+(parseInt(f(e).css("paddingLeft"),10)||0)-this.margins.left,t.top+(parseInt(f(e).css("borderTopWidth"),10)||0)+(parseInt(f(e).css("paddingTop"),10)||0)-this.margins.top,t.left+(i?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(f(e).css("borderLeftWidth"),10)||0)-(parseInt(f(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,t.top+(i?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(f(e).css("borderTopWidth"),10)||0)-(parseInt(f(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,t){t||(t=this.position);var i="absolute"===e?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&f.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(n[0].tagName);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():o?0:n.scrollTop())*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:n.scrollLeft())*i}},_generatePosition:function(e){var t,i,n=this.options,o=e.pageX,r=e.pageY,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&f.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(a[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(o=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(r=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(o=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(r=this.containment[3]+this.offset.click.top)),n.grid&&(t=this.originalPageY+Math.round((r-this.originalPageY)/n.grid[1])*n.grid[1],r=this.containment?t-this.offset.click.top>=this.containment[1]&&t-this.offset.click.top<=this.containment[3]?t:t-this.offset.click.top>=this.containment[1]?t-n.grid[1]:t+n.grid[1]:t,i=this.originalPageX+Math.round((o-this.originalPageX)/n.grid[0])*n.grid[0],o=this.containment?i-this.offset.click.left>=this.containment[0]&&i-this.offset.click.left<=this.containment[2]?i:i-this.offset.click.left>=this.containment[0]?i-n.grid[0]:i+n.grid[0]:i)),{top:r-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():s?0:a.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():s?0:a.scrollLeft())}},_rearrange:function(e,t,i,n){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var o=this.counter;this._delay(function(){o===this.counter&&this.refreshPositions(!n)})},_clear:function(e,t){function i(t,i,n){return function(e){n._trigger(t,e,i._uiHash(i))}}this.reverting=!1;var n,o=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)"auto"!==this._storedCSS[n]&&"static"!==this._storedCSS[n]||(this._storedCSS[n]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&o.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||o.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(o.push(function(e){this._trigger("remove",e,this._uiHash())}),o.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),o.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),n=this.containers.length-1;0<=n;n--)t||o.push(i("deactivate",this,this.containers[n])),this.containers[n].containerCache.over&&(o.push(i("out",this,this.containers[n])),this.containers[n].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!t){for(n=0;n<o.length;n++)o[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===f.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(e){var t=e||this;return{helper:t.helper,placeholder:t.placeholder||f([]),position:t.position,originalPosition:t.originalPosition,offset:t.positionAbs,item:t.currentItem,sender:e?e.element:null}}})}),function(e){"function"==typeof define&&define.amd?define(["jquery","./core","./mouse","./widget"],e):e(jQuery)}(function(b){return b.widget("ui.draggable",b.ui.mouse,{version:"1.11.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){(this.helper||this.element).is(".ui-draggable-dragging")?this.destroyOnClear=!0:(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),this._mouseDestroy())},_mouseCapture:function(e){var t=this.options;return this._blurActiveElement(e),!(this.helper||t.disabled||0<b(e.target).closest(".ui-resizable-handle").length)&&(this.handle=this._getHandle(e),!!this.handle&&(this._blockFrames(!0===t.iframeFix?"iframe":t.iframeFix),!0))},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map(function(){var e=b(this);return b("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var t=this.document[0];if(this.handleElement.is(e.target))try{t.activeElement&&"body"!==t.activeElement.nodeName.toLowerCase()&&b(t.activeElement).blur()}catch(i){}},_mouseStart:function(e){var t=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),b.ui.ddmanager&&(b.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=0<this.helper.parents().filter(function(){return"fixed"===b(this).css("position")}).length,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,t.cursorAt&&this._adjustOffsetFromHelper(t.cursorAt),this._setContainment(),!1===this._trigger("start",e)?(this._clear(),!1):(this._cacheHelperProportions(),b.ui.ddmanager&&!t.dropBehaviour&&b.ui.ddmanager.prepareOffsets(this,e),this._normalizeRightBottom(),this._mouseDrag(e,!0),b.ui.ddmanager&&b.ui.ddmanager.dragStart(this,e),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(e,t){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!t){var i=this._uiHash();if(!1===this._trigger("drag",e,i))return this._mouseUp({}),!1;this.position=i.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",b.ui.ddmanager&&b.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var t=this,i=!1;return b.ui.ddmanager&&!this.options.dropBehaviour&&(i=b.ui.ddmanager.drop(this,e)),this.dropped&&(i=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!i||"valid"===this.options.revert&&i||!0===this.options.revert||b.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)?b(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==t._trigger("stop",e)&&t._clear()}):!1!==this._trigger("stop",e)&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),b.ui.ddmanager&&b.ui.ddmanager.dragStop(this,e),this.handleElement.is(e.target)&&this.element.focus(),b.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return!this.options.handle||!!b(e.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(e){var t=this.options,i=b.isFunction(t.helper),n=i?b(t.helper.apply(this.element[0],[e])):"clone"===t.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===t.appendTo?this.element[0].parentNode:t.appendTo),i&&n[0]===this.element[0]&&this._setPositionRelative(),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),b.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),t=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==t&&b.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,t,i,n=this.options,o=this.document[0];this.relativeContainer=null,n.containment?"window"!==n.containment?"document"!==n.containment?n.containment.constructor!==Array?("parent"===n.containment&&(n.containment=this.helper[0].parentNode),(i=(t=b(n.containment))[0])&&(e=/(scroll|auto)/.test(t.css("overflow")),this.containment=[(parseInt(t.css("borderLeftWidth"),10)||0)+(parseInt(t.css("paddingLeft"),10)||0),(parseInt(t.css("borderTopWidth"),10)||0)+(parseInt(t.css("paddingTop"),10)||0),(e?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(t.css("borderRightWidth"),10)||0)-(parseInt(t.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(t.css("borderBottomWidth"),10)||0)-(parseInt(t.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=t)):this.containment=n.containment:this.containment=[0,0,b(o).width()-this.helperProportions.width-this.margins.left,(b(o).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=[b(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,b(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,b(window).scrollLeft()+b(window).width()-this.helperProportions.width-this.margins.left,b(window).scrollTop()+(b(window).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=null},_convertPositionTo:function(e,t){t||(t=this.position);var i="absolute"===e?1:-1,n=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:n?0:this.offset.scroll.top)*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:n?0:this.offset.scroll.left)*i}},_generatePosition:function(e,t){var i,n,o,
r,a=this.options,s=this._isRootNode(this.scrollParent[0]),l=e.pageX,c=e.pageY;return s&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(n=this.relativeContainer.offset(),i=[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(c=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(c=i[3]+this.offset.click.top)),a.grid&&(o=a.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,c=i?o-this.offset.click.top>=i[1]||o-this.offset.click.top>i[3]?o:o-this.offset.click.top>=i[1]?o-a.grid[1]:o+a.grid[1]:o,r=a.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,l=i?r-this.offset.click.left>=i[0]||r-this.offset.click.left>i[2]?r:r-this.offset.click.left>=i[0]?r-a.grid[0]:r+a.grid[0]:r),"y"===a.axis&&(l=this.originalPageX),"x"===a.axis&&(c=this.originalPageY)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(e,t,i){return i=i||this._uiHash(),b.ui.plugin.call(this,e,[t,i,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo("absolute"),i.offset=this.positionAbs),b.Widget.prototype._trigger.call(this,e,t,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),b.ui.plugin.add("draggable","connectToSortable",{start:function(t,e,i){var n=b.extend({},e,{item:i.element});i.sortables=[],b(i.options.connectToSortable).each(function(){var e=b(this).sortable("instance");e&&!e.options.disabled&&(i.sortables.push(e),e.refreshPositions(),e._trigger("activate",t,n))})},stop:function(t,e,i){var n=b.extend({},e,{item:i.element});i.cancelHelperRemoval=!1,b.each(i.sortables,function(){var e=this;e.isOver?(e.isOver=0,i.cancelHelperRemoval=!0,e.cancelHelperRemoval=!1,e._storedCSS={position:e.placeholder.css("position"),top:e.placeholder.css("top"),left:e.placeholder.css("left")},e._mouseStop(t),e.options.helper=e.options._helper):(e.cancelHelperRemoval=!0,e._trigger("deactivate",t,n))})},drag:function(i,n,o){b.each(o.sortables,function(){var e=!1,t=this;t.positionAbs=o.positionAbs,t.helperProportions=o.helperProportions,t.offset.click=o.offset.click,t._intersectsWith(t.containerCache)&&(e=!0,b.each(o.sortables,function(){return this.positionAbs=o.positionAbs,this.helperProportions=o.helperProportions,this.offset.click=o.offset.click,this!==t&&this._intersectsWith(this.containerCache)&&b.contains(t.element[0],this.element[0])&&(e=!1),e})),e?(t.isOver||(t.isOver=1,t.currentItem=n.helper.appendTo(t.element).data("ui-sortable-item",!0),t.options._helper=t.options.helper,t.options.helper=function(){return n.helper[0]},i.target=t.currentItem[0],t._mouseCapture(i,!0),t._mouseStart(i,!0,!0),t.offset.click.top=o.offset.click.top,t.offset.click.left=o.offset.click.left,t.offset.parent.left-=o.offset.parent.left-t.offset.parent.left,t.offset.parent.top-=o.offset.parent.top-t.offset.parent.top,o._trigger("toSortable",i),o.dropped=t.element,b.each(o.sortables,function(){this.refreshPositions()}),o.currentItem=o.element,t.fromOutside=o),t.currentItem&&(t._mouseDrag(i),n.position=t.position)):t.isOver&&(t.isOver=0,t.cancelHelperRemoval=!0,t.options._revert=t.options.revert,t.options.revert=!1,t._trigger("out",i,t._uiHash(t)),t._mouseStop(i,!0),t.options.revert=t.options._revert,t.options.helper=t.options._helper,t.placeholder&&t.placeholder.remove(),o._refreshOffsets(i),n.position=o._generatePosition(i,!0),o._trigger("fromSortable",i),o.dropped=!1,b.each(o.sortables,function(){this.refreshPositions()}))})}}),b.ui.plugin.add("draggable","cursor",{start:function(e,t,i){var n=b("body"),o=i.options;n.css("cursor")&&(o._cursor=n.css("cursor")),n.css("cursor",o.cursor)},stop:function(e,t,i){var n=i.options;n._cursor&&b("body").css("cursor",n._cursor)}}),b.ui.plugin.add("draggable","opacity",{start:function(e,t,i){var n=b(t.helper),o=i.options;n.css("opacity")&&(o._opacity=n.css("opacity")),n.css("opacity",o.opacity)},stop:function(e,t,i){var n=i.options;n._opacity&&b(t.helper).css("opacity",n._opacity)}}),b.ui.plugin.add("draggable","scroll",{start:function(e,t,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(e,t,i){var n=i.options,o=!1,r=i.scrollParentNotHidden[0],a=i.document[0];r!==a&&"HTML"!==r.tagName?(n.axis&&"x"===n.axis||(i.overflowOffset.top+r.offsetHeight-e.pageY<n.scrollSensitivity?r.scrollTop=o=r.scrollTop+n.scrollSpeed:e.pageY-i.overflowOffset.top<n.scrollSensitivity&&(r.scrollTop=o=r.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(i.overflowOffset.left+r.offsetWidth-e.pageX<n.scrollSensitivity?r.scrollLeft=o=r.scrollLeft+n.scrollSpeed:e.pageX-i.overflowOffset.left<n.scrollSensitivity&&(r.scrollLeft=o=r.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(e.pageY-b(a).scrollTop()<n.scrollSensitivity?o=b(a).scrollTop(b(a).scrollTop()-n.scrollSpeed):b(window).height()-(e.pageY-b(a).scrollTop())<n.scrollSensitivity&&(o=b(a).scrollTop(b(a).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(e.pageX-b(a).scrollLeft()<n.scrollSensitivity?o=b(a).scrollLeft(b(a).scrollLeft()-n.scrollSpeed):b(window).width()-(e.pageX-b(a).scrollLeft())<n.scrollSensitivity&&(o=b(a).scrollLeft(b(a).scrollLeft()+n.scrollSpeed)))),!1!==o&&b.ui.ddmanager&&!n.dropBehaviour&&b.ui.ddmanager.prepareOffsets(i,e)}}),b.ui.plugin.add("draggable","snap",{start:function(e,t,i){var n=i.options;i.snapElements=[],b(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var e=b(this),t=e.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:t.top,left:t.left})})},drag:function(e,t,i){var n,o,r,a,s,l,c,d,u,h,f=i.options,p=f.snapTolerance,m=t.offset.left,g=m+i.helperProportions.width,_=t.offset.top,v=_+i.helperProportions.height;for(u=i.snapElements.length-1;0<=u;u--)l=(s=i.snapElements[u].left-i.margins.left)+i.snapElements[u].width,d=(c=i.snapElements[u].top-i.margins.top)+i.snapElements[u].height,g<s-p||l+p<m||v<c-p||d+p<_||!b.contains(i.snapElements[u].item.ownerDocument,i.snapElements[u].item)?(i.snapElements[u].snapping&&i.options.snap.release&&i.options.snap.release.call(i.element,e,b.extend(i._uiHash(),{snapItem:i.snapElements[u].item})),i.snapElements[u].snapping=!1):("inner"!==f.snapMode&&(n=Math.abs(c-v)<=p,o=Math.abs(d-_)<=p,r=Math.abs(s-g)<=p,a=Math.abs(l-m)<=p,n&&(t.position.top=i._convertPositionTo("relative",{top:c-i.helperProportions.height,left:0}).top),o&&(t.position.top=i._convertPositionTo("relative",{top:d,left:0}).top),r&&(t.position.left=i._convertPositionTo("relative",{top:0,left:s-i.helperProportions.width}).left),a&&(t.position.left=i._convertPositionTo("relative",{top:0,left:l}).left)),h=n||o||r||a,"outer"!==f.snapMode&&(n=Math.abs(c-_)<=p,o=Math.abs(d-v)<=p,r=Math.abs(s-m)<=p,a=Math.abs(l-g)<=p,n&&(t.position.top=i._convertPositionTo("relative",{top:c,left:0}).top),o&&(t.position.top=i._convertPositionTo("relative",{top:d-i.helperProportions.height,left:0}).top),r&&(t.position.left=i._convertPositionTo("relative",{top:0,left:s}).left),a&&(t.position.left=i._convertPositionTo("relative",{top:0,left:l-i.helperProportions.width}).left)),!i.snapElements[u].snapping&&(n||o||r||a||h)&&i.options.snap.snap&&i.options.snap.snap.call(i.element,e,b.extend(i._uiHash(),{snapItem:i.snapElements[u].item})),i.snapElements[u].snapping=n||o||r||a||h)}}),b.ui.plugin.add("draggable","stack",{start:function(e,t,i){var n,o=i.options,r=b.makeArray(b(o.stack)).sort(function(e,t){return(parseInt(b(e).css("zIndex"),10)||0)-(parseInt(b(t).css("zIndex"),10)||0)});r.length&&(n=parseInt(b(r[0]).css("zIndex"),10)||0,b(r).each(function(e){b(this).css("zIndex",n+e)}),this.css("zIndex",n+r.length))}}),b.ui.plugin.add("draggable","zIndex",{start:function(e,t,i){var n=b(t.helper),o=i.options;n.css("zIndex")&&(o._zIndex=n.css("zIndex")),n.css("zIndex",o.zIndex)},stop:function(e,t,i){var n=i.options;n._zIndex&&b(t.helper).css("zIndex",n._zIndex)}}),b.ui.draggable}),function(e){"function"==typeof define&&define.amd?define(["jquery","./core","./widget","./mouse","./draggable"],e):e(jQuery)}(function(s){return s.widget("ui.droppable",{version:"1.11.2",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,e=this.options,i=e.accept;this.isover=!1,this.isout=!0,this.accept=s.isFunction(i)?i:function(e){return e.is(i)},this.proportions=function(e){if(!arguments.length)return t||(t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight});t=e},this._addToManager(e.scope),e.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(e){s.ui.ddmanager.droppables[e]=s.ui.ddmanager.droppables[e]||[],s.ui.ddmanager.droppables[e].push(this)},_splice:function(e){for(var t=0;t<e.length;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var e=s.ui.ddmanager.droppables[this.options.scope];this._splice(e),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,t){if("accept"===e)this.accept=s.isFunction(t)?t:function(e){return e.is(t)};else if("scope"===e){var i=s.ui.ddmanager.droppables[this.options.scope];this._splice(i),this._addToManager(t)}this._super(e,t)},_activate:function(e){var t=s.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),t&&this._trigger("activate",e,this.ui(t))},_deactivate:function(e){var t=s.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),t&&this._trigger("deactivate",e,this.ui(t))},_over:function(e){var t=s.ui.ddmanager.current;t&&(t.currentItem||t.element)[0]!==this.element[0]&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",e,this.ui(t)))},_out:function(e){var t=s.ui.ddmanager.current;t&&(t.currentItem||t.element)[0]!==this.element[0]&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(t)))},_drop:function(t,e){var i=e||s.ui.ddmanager.current,n=!1;return!(!i||(i.currentItem||i.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var e=s(this).droppable("instance");if(e.options.greedy&&!e.options.disabled&&e.options.scope===i.options.scope&&e.accept.call(e.element[0],i.currentItem||i.element)&&s.ui.intersect(i,s.extend(e,{offset:e.element.offset()}),e.options.tolerance,t))return!(n=!0)}),!n&&(!!this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(i)),this.element)))},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),s.ui.intersect=function(){function h(e,t,i){return t<=e&&e<t+i}return function(e,t,i,n){if(!t.offset)return!1;var o=(e.positionAbs||e.position.absolute).left+e.margins.left,r=(e.positionAbs||e.position.absolute).top+e.margins.top,a=o+e.helperProportions.width,s=r+e.helperProportions.height,l=t.offset.left,c=t.offset.top,d=l+t.proportions().width,u=c+t.proportions().height;switch(i){case"fit":return l<=o&&a<=d&&c<=r&&s<=u;case"intersect":return l<o+e.helperProportions.width/2&&a-e.helperProportions.width/2<d&&c<r+e.helperProportions.height/2&&s-e.helperProportions.height/2<u;case"pointer":return h(n.pageY,c,t.proportions().height)&&h(n.pageX,l,t.proportions().width);case"touch":return(c<=r&&r<=u||c<=s&&s<=u||r<c&&u<s)&&(l<=o&&o<=d||l<=a&&a<=d||o<l&&d<a);default:return!1}}}(),s.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(e,t){var i,n,o=s.ui.ddmanager.droppables[e.options.scope]||[],r=t?t.type:null,a=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();e:for(i=0;i<o.length;i++)if(!(o[i].options.disabled||e&&!o[i].accept.call(o[i].element[0],e.currentItem||e.element))){for(n=0;n<a.length;n++)if(a[n]===o[i].element[0]){o[i].proportions().height=0;continue e}o[i].visible="none"!==o[i].element.css("display"),o[i].visible&&("mousedown"===r&&o[i]._activate.call(o[i],t),o[i].offset=o[i].element.offset(),o[i].proportions({width:o[i].element[0].offsetWidth,height:o[i].element[0].offsetHeight}))}},drop:function(e,t){var i=!1;return s.each((s.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&s.ui.intersect(e,this,this.options.tolerance,t)&&(i=this._drop.call(this,t)||i),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,t)))}),i},dragStart:function(e,t){e.element.parentsUntil("body").bind("scroll.droppable",function(){e.options.refreshPositions||s.ui.ddmanager.prepareOffsets(e,t)})},drag:function(r,a){r.options.refreshPositions&&s.ui.ddmanager.prepareOffsets(r,a),s.each(s.ui.ddmanager.droppables[r.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var e,t,i,n=s.ui.intersect(r,this,this.options.tolerance,a),o=!n&&this.isover?"isout":n&&!this.isover?"isover":null;o&&(this.options.greedy&&(t=this.options.scope,(i=this.element.parents(":data(ui-droppable)").filter(function(){return s(this).droppable("instance").options.scope===t})).length&&((e=s(i[0]).droppable("instance")).greedyChild="isover"===o)),e&&"isover"===o&&(e.isover=!1,e.isout=!0,e._out.call(e,a)),this[o]=!0,this["isout"===o?"isover":"isout"]=!1,this["isover"===o?"_over":"_out"].call(this,a),e&&"isout"===o&&(e.isout=!1,e.isover=!0,e._over.call(e,a)))}})},dragStop:function(e,t){e.element.parentsUntil("body").unbind("scroll.droppable"),e.options.refreshPositions||s.ui.ddmanager.prepareOffsets(e,t)}},s.ui.droppable}),function(e){function t(){}function i(c){function i(e){e.prototype.option||(e.prototype.option=function(e){c.isPlainObject(e)&&(this.options=c.extend(!0,this.options,e))})}function n(s,l){c.fn[s]=function(t){if("string"!=typeof t)return this.each(function(){var e=c.data(this,s);e?(e.option(t),e._init()):(e=new l(this,t),c.data(this,s,e))});for(var e=u.call(arguments,1),i=0,n=this.length;i<n;i++){var o=this[i],r=c.data(o,s);if(r)if(c.isFunction(r[t])&&"_"!==t.charAt(0)){var a=r[t].apply(r,e);if(a!==undefined)return a}else d("no such method '"+t+"' for "+s+" instance");else d("cannot call methods on "+s+" prior to initialization; attempted to call '"+t+"'")}return this}}if(c){var d="undefined"==typeof console?t:function(e){console.error(e)};return c.bridget=function(e,t){i(t),n(e,t)},c.bridget}}var u=Array.prototype.slice;"function"==typeof define&&define.amd?define("jquery-bridget/jquery.bridget",["jquery"],i):i(e.jQuery)}(window),function(i){function n(e){var t=i.event;return t.target=t.target||t.srcElement||e,t}var e=document.documentElement,t=function(){};e.addEventListener?t=function(e,t,i){e.addEventListener(t,i,!1)}:e.attachEvent&&(t=function(t,e,i){t[e+i]=i.handleEvent?function(){var e=n(t);i.handleEvent.call(i,e)}:function(){var e=n(t);i.call(t,e)},t.attachEvent("on"+e,t[e+i])});var o=function(){};e.removeEventListener?o=function(e,t,i){e.removeEventListener(t,i,!1)}:e.detachEvent&&(o=function(e,t,i){e.detachEvent("on"+t,e[t+i]);try{delete e[t+i]}catch(n){e[t+i]=undefined}});var r={bind:t,unbind:o};"function"==typeof define&&define.amd?define("eventie/eventie",r):"object"==typeof exports?module.exports=r:i.eventie=r}(this),function(t){function o(e){"function"==typeof e&&(o.isReady?e():a.push(e))}function i(e){var t="readystatechange"===e.type&&"complete"!==r.readyState;if(!o.isReady&&!t){o.isReady=!0;for(var i=0,n=a.length;i<n;i++){(0,a[i])()}}}function e(e){return e.bind(r,"DOMContentLoaded",i),e.bind(r,"readystatechange",i),e.bind(t,"load",i),o}var r=t.document,a=[];o.isReady=!1,"function"==typeof define&&define.amd?(o.isReady="function"==typeof requirejs,define("doc-ready/doc-ready",["eventie/eventie"],e)):t.docReady=e(t.eventie)}(this),function(){function e(){}function r(e,t){for(var i=e.length;i--;)if(e[i].listener===t)return i;return-1}function t(e){return function t(){return this[e].apply(this,arguments)}}var i=e.prototype,n=this,o=n.EventEmitter;i.getListeners=function a(e){var t,i,n=this._getEvents();if(e instanceof RegExp)for(i in t={},n)n.hasOwnProperty(i)&&e.test(i)&&(t[i]=n[i]);else t=n[e]||(n[e]=[]);return t},i.flattenListeners=function s(e){var t,i=[];for(t=0;t<e.length;t+=1)i.push(e[t].listener);return i},i.getListenersAsObject=function l(e){var t,i=this.getListeners(e);return i instanceof Array&&((t={})[e]=i),t||i},i.addListener=function c(e,t){var i,n=this.getListenersAsObject(e),o="object"==typeof t;for(i in n)n.hasOwnProperty(i)&&-1===r(n[i],t)&&n[i].push(o?t:{listener:t,once:!1});return this},i.on=t("addListener"),i.addOnceListener=function d(e,t){return this.addListener(e,{listener:t,once:!0})},i.once=t("addOnceListener"),i.defineEvent=function u(e){return this.getListeners(e),this},i.defineEvents=function h(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},i.removeListener=function f(e,t){var i,n,o=this.getListenersAsObject(e);for(n in o)o.hasOwnProperty(n)&&-1!==(i=r(o[n],t))&&o[n].splice(i,1);return this},i.off=t("removeListener"),i.addListeners=function p(e,t){return this.manipulateListeners(!1,e,t)},i.removeListeners=function m(e,t){return this.manipulateListeners(!0,e,t)},i.manipulateListeners=function g(e,t,i){var n,o,r=e?this.removeListener:this.addListener,a=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(n=i.length;n--;)r.call(this,t,i[n]);else for(n in t)t.hasOwnProperty(n)&&(o=t[n])&&("function"==typeof o?r.call(this,n,o):a.call(this,n,o));return this},i.removeEvent=function _(e){var t,i=typeof e,n=this._getEvents();if("string"===i)delete n[e];else if(e instanceof RegExp)for(t in n)n.hasOwnProperty(t)&&e.test(t)&&delete n[t];else delete this._events;return this},i.removeAllListeners=t("removeEvent"),i.emitEvent=function v(e,t){var i,n,o,r=this.getListenersAsObject(e);for(o in r)if(r.hasOwnProperty(o))for(n=r[o].length;n--;)!0===(i=r[o][n]).once&&this.removeListener(e,i.listener),i.listener.apply(this,t||[])===this._getOnceReturnValue()&&this.removeListener(e,i.listener);return this},i.trigger=t("emitEvent"),i.emit=function b(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},i.setOnceReturnValue=function y(e){return this._onceReturnValue=e,this},i._getOnceReturnValue=function w(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},i._getEvents=function k(){return this._events||(this._events={})},e.noConflict=function $(){return n.EventEmitter=o,e},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return e}):"object"==typeof module&&module.exports?module.exports=e:this.EventEmitter=e}.call(this),function(e){function t(e){if(e){if("string"==typeof r[e])return e;var t;e=e.charAt(0).toUpperCase()+e.slice(1);for(var i=0,n=o.length;i<n;i++)if(t=o[i]+e,"string"==typeof r[t])return t}}var o="Webkit Moz ms Ms O".split(" "),r=document.documentElement.style;"function"==typeof define&&define.amd?define("get-style-property/get-style-property",[],function(){return t}):"object"==typeof exports?module.exports=t:e.getStyleProperty=t}(window),function(e){function w(e){var t=parseFloat(e);return-1===e.indexOf("%")&&!isNaN(t)&&t}function k(){for(var e={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},t=0,i=x.length;t<i;t++){e[x[t]]=0}return e}function t(e){function t(e){if("string"==typeof e&&(e=document.querySelector(e)),e&&"object"==typeof e&&e.nodeType){var t=$(e);if("none"===t.display)return k();var i={};i.width=e.offsetWidth,i.height=e.offsetHeight;for(var n=i.isBorderBox=!(!y||!t[y]||"border-box"!==t[y]),o=0,r=x.length;o<r;o++){var a=x[o],s=t[a];s=v(e,s);var l=parseFloat(s);i[a]=isNaN(l)?0:l}var c=i.paddingLeft+i.paddingRight,d=i.paddingTop+i.paddingBottom,u=i.marginLeft+i.marginRight,h=i.marginTop+i.marginBottom,f=i.borderLeftWidth+i.borderRightWidth,p=i.borderTopWidth+i.borderBottomWidth,m=n&&b,g=w(t.width);!1!==g&&(i.width=g+(m?0:c+f));var _=w(t.height);return!1!==_&&(i.height=_+(m?0:d+p)),i.innerWidth=i.width-(c+f),i.innerHeight=i.height-(d+p),i.outerWidth=i.width+u,i.outerHeight=i.height+h,i}}function v(e,t){if(a||-1===t.indexOf("%"))return t;var i=e.style,n=i.left,o=e.runtimeStyle,r=o&&o.left;return r&&(o.left=e.currentStyle.left),i.left=t,t=i.pixelLeft,i.left=n,r&&(o.left=r),t}var b,y=e("boxSizing");return function(){if(y){var e=document.createElement("div");e.style.width="200px",e.style.padding="1px 2px 3px 4px",e.style.borderStyle="solid",e.style.borderWidth="1px 2px 3px 4px",e.style[y]="border-box";var t=document.body||document.documentElement;t.appendChild(e);var i=$(e);b=200===w(i.width),t.removeChild(e)}}(),t}var a=e.getComputedStyle,$=a?function(e){return a(e,null)}:function(e){return e.currentStyle},x=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"];"function"==typeof define&&define.amd?define("get-size/get-size",["get-style-property/get-style-property"],t):"object"==typeof exports?module.exports=t(require("get-style-property")):e.getSize=t(e.getStyleProperty)}(window),function(e,o){function i(e,t){return e[s](t)}function r(e){e.parentNode||document.createDocumentFragment().appendChild(e)}function t(e,t){r(e);for(var i=e.parentNode.querySelectorAll(t),n=0,o=i.length;n<o;n++)if(i[n]===e)return!0;return!1}function n(e,t){return r(e),i(e,t)}var a,s=function(){if(o.matchesSelector)return"matchesSelector";for(var e=["webkit","moz","ms","o"],t=0,i=e.length;t<i;t++){var n=e[t]+"MatchesSelector";if(o[n])return n}}();if(s){var l=i(document.createElement("div"),"div");a=l?i:n}else a=t;"function"==typeof define&&define.amd?define("matches-selector/matches-selector",[],function(){return a}):window.matchesSelector=a}(0,Element.prototype),function(e){function m(e,t){for(var i in t)e[i]=t[i];return e}function g(e){for(var t in e)return!1;return!null}function _(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}function t(e,t,r){function i(e,t){e&&(this.element=e,this.layout=t,this.position={x:0,y:0},this._create())}var n=r("transition"),o=r("transform"),a=n&&o,s=!!r("perspective"),l={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"}[n],c=["transform","transition","transitionDuration","transitionProperty"],d=function(){for(var e={},t=0,i=c.length;t<i;t++){var n=c[t],o=r(n);o&&o!==n&&(e[n]=o)}return e}();m(i.prototype,e.prototype),i.prototype._create=function(){this._transn={ingProperties:{},clean:{},onEnd:{}},this.css({position:"absolute"})},i.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},i.prototype.getSize=function(){this.size=t(this.element)},i.prototype.css=function(e){var t=this.element.style;for(var i in e){t[d[i]||i]=e[i]}},i.prototype.getPosition=function(){var e=v(this.element),t=this.layout.options,i=t.isOriginLeft,n=t.isOriginTop,o=parseInt(e[i?"left":"right"],10),r=parseInt(e[n?"top":"bottom"],10);o=isNaN(o)?0:o,r=isNaN(r)?0:r;var a=this.layout.size;o-=i?a.paddingLeft:a.paddingRight,r-=n?a.paddingTop:a.paddingBottom,this.position.x=o,this.position.y=r},i.prototype.layoutPosition=function(){var e=this.layout.size,t=this.layout.options,i={};t.isOriginLeft?(i.left=this.position.x+e.paddingLeft+"px",i.right=""):(i.right=this.position.x+e.paddingRight+"px",i.left=""),t.isOriginTop?(i.top=this.position.y+e.paddingTop+"px",i.bottom=""):(i.bottom=this.position.y+e.paddingBottom+"px",i.top=""),this.css(i),this.emitEvent("layout",[this])};var u=s?function(e,t){return"translate3d("+e+"px, "+t+"px, 0)"}:function(e,t){return"translate("+e+"px, "+t+"px)"};i.prototype._transitionTo=function(e,t){this.getPosition();var i=this.position.x,n=this.position.y,o=parseInt(e,10),r=parseInt(t,10),a=o===this.position.x&&r===this.position.y;if(this.setPosition(e,t),!a||this.isTransitioning){var s=e-i,l=t-n,c={},d=this.layout.options;s=d.isOriginLeft?s:-s,l=d.isOriginTop?l:-l,c.transform=u(s,l),this.transition({to:c,onTransitionEnd:{transform:this.layoutPosition},isCleaning:!0})}else this.layoutPosition()},i.prototype.goTo=function(e,t){this.setPosition(e,t),this.layoutPosition()},i.prototype.moveTo=a?i.prototype._transitionTo:i.prototype.goTo,i.prototype.setPosition=function(e,t){this.position.x=parseInt(e,10),this.position.y=parseInt(t,10)},i.prototype._nonTransition=function(e){for(var t in this.css(e.to),e.isCleaning&&this._removeStyles(e.to),e.onTransitionEnd)e.onTransitionEnd[t].call(this)},i.prototype._transition=function(e){if(parseFloat(this.layout.options.transitionDuration)){var t=this._transn;for(var i in e.onTransitionEnd)t.onEnd[i]=e.onTransitionEnd[i];for(i in e.to)t.ingProperties[i]=!0,e.isCleaning&&(t.clean[i]=!0);if(e.from){this.css(e.from);this.element.offsetHeight;null}this.enableTransition(e.to),this.css(e.to),this.isTransitioning=!0}else this._nonTransition(e)};var h=o&&_(o)+",opacity";i.prototype.enableTransition=function(){this.isTransitioning||(this.css({transitionProperty:h,transitionDuration:this.layout.options.transitionDuration}),this.element.addEventListener(l,this,!1))},i.prototype.transition=i.prototype[n?"_transition":"_nonTransition"],i.prototype.onwebkitTransitionEnd=function(e){this.ontransitionend(e)},i.prototype.onotransitionend=function(e){this.ontransitionend(e)};var f={"-webkit-transform":"transform","-moz-transform":"transform","-o-transform":"transform"};i.prototype.ontransitionend=function(e){if(e.target===this.element){var t=this._transn,i=f[e.propertyName]||e.propertyName;if(delete t.ingProperties[i],g(t.ingProperties)&&this.disableTransition(),i in t.clean&&(this.element.style[e.propertyName]="",delete t.clean[i]),i in t.onEnd)t.onEnd[i].call(this),delete t.onEnd[i];this.emitEvent("transitionEnd",[this])}},i.prototype.disableTransition=function(){this.removeTransitionStyles(),this.element.removeEventListener(l,this,!1),this.isTransitioning=!1},i.prototype._removeStyles=function(e){var t={};for(var i in e)t[i]="";this.css(t)};var p={transitionProperty:"",transitionDuration:""};return i.prototype.removeTransitionStyles=function(){this.css(p)},i.prototype.removeElem=function(){this.element.parentNode.removeChild(this.element),this.emitEvent("remove",[this])},i.prototype.remove=function(){if(n&&parseFloat(this.layout.options.transitionDuration)){var e=this;this.on("transitionEnd",function(){return e.removeElem(),!0}),this.hide()}else this.removeElem()},i.prototype.reveal=function(){delete this.isHidden,this.css({display:""});var e=this.layout.options;this.transition({from:e.hiddenStyle,to:e.visibleStyle,isCleaning:!0})},i.prototype.hide=function(){this.isHidden=!0,this.css({display:""});var e=this.layout.options;this.transition({from:e.visibleStyle,to:e.hiddenStyle,isCleaning:!0,onTransitionEnd:{opacity:function(){this.isHidden&&this.css({display:"none"})}}})},i.prototype.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})},i}var i=e.getComputedStyle,v=i?function(e){return i(e,null)}:function(e){return e.currentStyle};"function"==typeof define&&define.amd?define("outlayer/item",["eventEmitter/EventEmitter","get-size/get-size","get-style-property/get-style-property"],t):(e.Outlayer={},e.Outlayer.Item=t(e.EventEmitter,e.getSize,e.getStyleProperty))}(window),function(l){function h(e,t){for(var i in t)e[i]=t[i];return e}function o(e){return"[object Array]"===t.call(e)}function d(e){var t=[];if(o(e))t=e;else if(e&&"number"==typeof e.length)for(var i=0,n=e.length;i<n;i++)t.push(e[i]);else t.push(e);return t}function u(e,t){var i=n(t,e);-1!==i&&t.splice(i,1)}function f(e){return e.replace(/(.)([A-Z])/g,function(e,t,i){return t+"-"+i}).toLowerCase()}function e(e,i,t,o,c,n){function r(e,t){if("string"==typeof e&&(e=p.querySelector(e)),e&&v(e)){this.element=e,this.options=h({},this.constructor.defaults),this.option(t);var i=++a;this.element.outlayerGUID=i,(s[i]=this)._create(),this.options.isInitLayout&&this.layout()}else m&&m.error("Bad "+this.constructor.namespace+" element: "+e)}var a=0,s={};return r.namespace="outlayer",r.Item=n,r.defaults={containerStyle:{position:"relative"},isInitLayout:!0,isOriginLeft:!0,isOriginTop:!0,isResizeBound:!0,isResizingContainer:!0,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}},h(r.prototype,t.prototype),r.prototype.option=function(e){h(this.options,e)},r.prototype._create=function(){this.reloadItems(),this.stamps=[],this.stamp(this.options.stamp),h(this.element.style,this.options.containerStyle),this.options.isResizeBound&&this.bindResize()},r.prototype.reloadItems=function(){this.items=this._itemize(this.element.children)},r.prototype._itemize=function(e){for(var t=this._filterFindItemElements(e),i=this.constructor.Item,n=[],o=0,r=t.length;o<r;o++){var a=new i(t[o],this);n.push(a)}return n},r.prototype._filterFindItemElements=function(e){e=d(e);for(var t=this.options.itemSelector,i=[],n=0,o=e.length;n<o;n++){var r=e[n];if(v(r))if(t){c(r,t)&&i.push(r);for(var a=r.querySelectorAll(t),s=0,l=a.length;s<l;s++)i.push(a[s])}else i.push(r)}return i},r.prototype.getItemElements=function(){for(var e=[],t=0,i=this.items.length;t<i;t++)e.push(this.items[t].element);return e},r.prototype.layout=function(){this._resetLayout(),this._manageStamps();var e=this.options.isLayoutInstant!==undefined?this.options.isLayoutInstant:!this._isLayoutInited;this.layoutItems(this.items,e),this._isLayoutInited=!0},r.prototype._init=r.prototype.layout,r.prototype._resetLayout=function(){this.getSize()},r.prototype.getSize=function(){this.size=o(this.element)},r.prototype._getMeasurement=function(e,t){var i,n=this.options[e];n?("string"==typeof n?i=this.element.querySelector(n):v(n)&&(i=n),this[e]=i?o(i)[t]:n):this[e]=0},r.prototype.layoutItems=function(e,t){e=this._getItemsForLayout(e),this._layoutItems(e,t),this._postLayout()},r.prototype._getItemsForLayout=function(e){for(var t=[],i=0,n=e.length;i<n;i++){var o=e[i];o.isIgnored||t.push(o)}return t},r.prototype._layoutItems=function(e,t){function i(){n.emitEvent("layoutComplete",[n,e])}var n=this;if(e&&e.length){this._itemsOn(e,"layout",i);for(var o=[],r=0,a=e.length;r<a;r++){var s=e[r],l=this._getItemLayoutPosition(s);l.item=s,l.isInstant=t||s.isLayoutInstant,o.push(l)}this._processLayoutQueue(o)}else i()},r.prototype._getItemLayoutPosition=function(){return{x:0,y:0}},r.prototype._processLayoutQueue=function(e){for(var t=0,i=e.length;t<i;t++){var n=e[t];this._positionItem(n.item,n.x,n.y,n.isInstant)}},r.prototype._positionItem=function(e,t,i,n){n?e.goTo(t,i):e.moveTo(t,i)},r.prototype._postLayout=function(){this.resizeContainer()},r.prototype.resizeContainer=function(){if(this.options.isResizingContainer){var e=this._getContainerSize();e&&(this._setContainerMeasure(e.width,!0),this._setContainerMeasure(e.height,!1))}},r.prototype._getContainerSize=_,r.prototype._setContainerMeasure=function(e,t){if(e!==undefined){var i=this.size;i.isBorderBox&&(
e+=t?i.paddingLeft+i.paddingRight+i.borderLeftWidth+i.borderRightWidth:i.paddingBottom+i.paddingTop+i.borderTopWidth+i.borderBottomWidth),e=Math.max(e,0),this.element.style[t?"width":"height"]=e+"px"}},r.prototype._itemsOn=function(e,t,i){function n(){return++o===r&&i.call(a),!0}for(var o=0,r=e.length,a=this,s=0,l=e.length;s<l;s++){e[s].on(t,n)}},r.prototype.ignore=function(e){var t=this.getItem(e);t&&(t.isIgnored=!0)},r.prototype.unignore=function(e){var t=this.getItem(e);t&&delete t.isIgnored},r.prototype.stamp=function(e){if(e=this._find(e)){this.stamps=this.stamps.concat(e);for(var t=0,i=e.length;t<i;t++){var n=e[t];this.ignore(n)}}},r.prototype.unstamp=function(e){if(e=this._find(e))for(var t=0,i=e.length;t<i;t++){var n=e[t];u(n,this.stamps),this.unignore(n)}},r.prototype._find=function(e){if(e)return"string"==typeof e&&(e=this.element.querySelectorAll(e)),e=d(e)},r.prototype._manageStamps=function(){if(this.stamps&&this.stamps.length){this._getBoundingRect();for(var e=0,t=this.stamps.length;e<t;e++){var i=this.stamps[e];this._manageStamp(i)}}},r.prototype._getBoundingRect=function(){var e=this.element.getBoundingClientRect(),t=this.size;this._boundingRect={left:e.left+t.paddingLeft+t.borderLeftWidth,top:e.top+t.paddingTop+t.borderTopWidth,right:e.right-(t.paddingRight+t.borderRightWidth),bottom:e.bottom-(t.paddingBottom+t.borderBottomWidth)}},r.prototype._manageStamp=_,r.prototype._getElementOffset=function(e){var t=e.getBoundingClientRect(),i=this._boundingRect,n=o(e);return{left:t.left-i.left-n.marginLeft,top:t.top-i.top-n.marginTop,right:i.right-t.right-n.marginRight,bottom:i.bottom-t.bottom-n.marginBottom}},r.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},r.prototype.bindResize=function(){this.isResizeBound||(e.bind(l,"resize",this),this.isResizeBound=!0)},r.prototype.unbindResize=function(){this.isResizeBound&&e.unbind(l,"resize",this),this.isResizeBound=!1},r.prototype.onresize=function(){function e(){t.resize(),delete t.resizeTimeout}this.resizeTimeout&&clearTimeout(this.resizeTimeout);var t=this;this.resizeTimeout=setTimeout(e,100)},r.prototype.resize=function(){this.isResizeBound&&this.needsResizeLayout()&&this.layout()},r.prototype.needsResizeLayout=function(){var e=o(this.element);return this.size&&e&&e.innerWidth!==this.size.innerWidth},r.prototype.addItems=function(e){var t=this._itemize(e);return t.length&&(this.items=this.items.concat(t)),t},r.prototype.appended=function(e){var t=this.addItems(e);t.length&&(this.layoutItems(t,!0),this.reveal(t))},r.prototype.prepended=function(e){var t=this._itemize(e);if(t.length){var i=this.items.slice(0);this.items=t.concat(i),this._resetLayout(),this._manageStamps(),this.layoutItems(t,!0),this.reveal(t),this.layoutItems(i)}},r.prototype.reveal=function(e){var t=e&&e.length;if(t)for(var i=0;i<t;i++){e[i].reveal()}},r.prototype.hide=function(e){var t=e&&e.length;if(t)for(var i=0;i<t;i++){e[i].hide()}},r.prototype.getItem=function(e){for(var t=0,i=this.items.length;t<i;t++){var n=this.items[t];if(n.element===e)return n}},r.prototype.getItems=function(e){if(e&&e.length){for(var t=[],i=0,n=e.length;i<n;i++){var o=e[i],r=this.getItem(o);r&&t.push(r)}return t}},r.prototype.remove=function(e){e=d(e);var t=this.getItems(e);if(t&&t.length){this._itemsOn(t,"remove",function(){this.emitEvent("removeComplete",[this,t])});for(var i=0,n=t.length;i<n;i++){var o=t[i];o.remove(),u(o,this.items)}}},r.prototype.destroy=function(){var e=this.element.style;e.height="",e.position="",e.width="";for(var t=0,i=this.items.length;t<i;t++){this.items[t].destroy()}this.unbindResize(),delete this.element.outlayerGUID,g&&g.removeData(this.element,this.constructor.namespace)},r.data=function(e){var t=e&&e.outlayerGUID;return t&&s[t]},r.create=function(d,e){function u(){r.apply(this,arguments)}return Object.create?u.prototype=Object.create(r.prototype):h(u.prototype,r.prototype),(u.prototype.constructor=u).defaults=h({},r.defaults),h(u.defaults,e),u.prototype.settings={},u.namespace=d,u.data=r.data,u.Item=function t(){n.apply(this,arguments)},u.Item.prototype=new n,i(function(){for(var e=f(d),t=p.querySelectorAll(".js-"+e),i="data-"+e+"-options",n=0,o=t.length;n<o;n++){var r,a=t[n],s=a.getAttribute(i);try{r=s&&JSON.parse(s)}catch(c){m&&m.error("Error parsing "+i+" on "+a.nodeName.toLowerCase()+(a.id?"#"+a.id:"")+": "+c);continue}var l=new u(a,r);g&&g.data(a,d,l)}}),g&&g.bridget&&g.bridget(d,u),u},r.Item=n,r}var p=l.document,m=l.console,g=l.jQuery,_=function(){},t=Object.prototype.toString,v="object"==typeof HTMLElement?function i(e){return e instanceof HTMLElement}:function r(e){return e&&"object"==typeof e&&1===e.nodeType&&"string"==typeof e.nodeName},n=Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1};"function"==typeof define&&define.amd?define("outlayer/outlayer",["eventie/eventie","doc-ready/doc-ready","eventEmitter/EventEmitter","get-size/get-size","matches-selector/matches-selector","./item"],e):l.Outlayer=e(l.eventie,l.docReady,l.EventEmitter,l.getSize,l.matchesSelector,l.Outlayer.Item)}(window),function(e){function t(e,c){var t=e.create("masonry");return t.prototype._resetLayout=function(){this.getSize(),this._getMeasurement("columnWidth","outerWidth"),this._getMeasurement("gutter","outerWidth"),this.measureColumns();var e=this.cols;for(this.colYs=[];e--;)this.colYs.push(0);this.maxY=0},t.prototype.measureColumns=function(){if(this.getContainerWidth(),!this.columnWidth){var e=this.items[0],t=e&&e.element;this.columnWidth=t&&c(t).outerWidth||this.containerWidth}this.columnWidth+=this.gutter,this.cols=Math.floor((this.containerWidth+this.gutter)/this.columnWidth),this.cols=Math.max(this.cols,1)},t.prototype.getContainerWidth=function(){var e=this.options.isFitWidth?this.element.parentNode:this.element,t=c(e);this.containerWidth=t&&t.innerWidth},t.prototype._getItemLayoutPosition=function(e){e.getSize();var t=e.size.outerWidth%this.columnWidth,i=Math[t&&t<1?"round":"ceil"](e.size.outerWidth/this.columnWidth);i=Math.min(i,this.cols);for(var n=this._getColGroup(i),o=Math.min.apply(Math,n),r=d(n,o),a={x:this.columnWidth*r,y:o},s=o+e.size.outerHeight,l=this.cols+1-n.length,c=0;c<l;c++)this.colYs[r+c]=s;return a},t.prototype._getColGroup=function(e){if(e<2)return this.colYs;for(var t=[],i=this.cols+1-e,n=0;n<i;n++){var o=this.colYs.slice(n,n+e);t[n]=Math.max.apply(Math,o)}return t},t.prototype._manageStamp=function(e){var t=c(e),i=this._getElementOffset(e),n=this.options.isOriginLeft?i.left:i.right,o=n+t.outerWidth,r=Math.floor(n/this.columnWidth);r=Math.max(0,r);var a=Math.floor(o/this.columnWidth);a-=o%this.columnWidth?0:1,a=Math.min(this.cols-1,a);for(var s=(this.options.isOriginTop?i.top:i.bottom)+t.outerHeight,l=r;l<=a;l++)this.colYs[l]=Math.max(s,this.colYs[l])},t.prototype._getContainerSize=function(){this.maxY=Math.max.apply(Math,this.colYs);var e={height:this.maxY};return this.options.isFitWidth&&(e.width=this._getContainerFitWidth()),e},t.prototype._getContainerFitWidth=function(){for(var e=0,t=this.cols;--t&&0===this.colYs[t];)e++;return(this.cols-e)*this.columnWidth-this.gutter},t.prototype.needsResizeLayout=function(){var e=this.containerWidth;return this.getContainerWidth(),e!==this.containerWidth},t}var d=Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){for(var i=0,n=e.length;i<n;i++){if(e[i]===t)return i}return-1};"function"==typeof define&&define.amd?define(["outlayer/outlayer","get-size/get-size"],t):e.Masonry=t(e.Outlayer,e.getSize)}(window);var HOST_HTTPS="",FLASH_NOTICE_COUNT=0,CSRF_TOKEN=null,CURRENT_BOARD_ID=null;load_auth_token(),jQuery.fn.flashlight=function(e,t){var i=$(this);return flash_color(i,i.css("background-color"),"#FFFFDD",3,50,t),i};var PAPALY_VERSION_SERVER=undefined;load_papaly_version(),$(document).ajaxComplete(function(e,t){var i=t.getResponseHeader("papaly-version-server");i!=undefined&&(PAPALY_VERSION_SERVER==undefined?PAPALY_VERSION_SERVER=i:i!=PAPALY_VERSION_SERVER&&check_and_reload_papaly(PAPALY_VERSION_SERVER))});var ga_user_id,GLOBAL_MOBILE=undefined;jQuery.fn.register_item_listeners=function(){return $(this).filter(".item-bookmark, .shortcut-module, .social-link-module").find("a").each(function(e,t){this.item_bookmark_click||($(t).on("click",function(e){1==e.button||e.ctrlKey||e.metaKey||click_item(e,$(this))}).on("mouseup",function(e){(1==e.button||e.ctrlKey||e.metaKey)&&send_item_click(e,$(this))}),this.item_bookmark_click=!0)}),this},register_click_listeners(),$.debounce=function(o,r,a){var s;return function(){var e=this,t=arguments,i=function(){s=null,a||r.apply(e,t)},n=a&&!s;clearTimeout(s),s=setTimeout(i,o),n&&r.apply(e,t)}},$.throttle=function(r,a,s,l){function e(){function e(){d=+new Date,s.apply(i,o)}function t(){c=undefined}var i=this,n=+new Date-d,o=arguments;l&&!c&&e(),c&&clearTimeout(c),l===undefined&&r<n?e():!0!==a&&(c=setTimeout(l?t:e,l===undefined?r-n:r))}var c,d=0;return"boolean"!=typeof a&&(l=s,s=a,a=undefined),$.guid&&(e.guid=s.guid=s.guid||$.guid++),e},$.debounce=function(e,t,i){return i===undefined?$.throttle(e,t,!1):$.throttle(e,i,!1!==t)},DropDown.prototype={initEvents:function(){var o=this;o.dropdown.on("click",function(){return $(this).toggleClass("active"),!1}),o.dropdown.on("click","ul.dropdown-list > li",function(e){var t=$(e.delegateTarget),i=$(this),n=t.find("span");n.html(i.clone()),n.children().children().unwrap(),o.choiceMade(n.children()),o.dropdown.has(i).addClass("active")}),o.dropdown.on("mouseleave",function(){o.mouse=setTimeout(function(){o.dropdown.removeClass("active"),o.mouse},500)}),o.dropdown.on("mouseenter",function(){o.mouse&&clearInterval(o.mouse)})},choiceMade:function(){}},setTimeout(function(){console.debug("\nJoin and hack with us!\n\nfounders@papaly.com\npapaly.com/careers\n")},1e3);var version,update_weather_interval,update_weather_end_time,update_time_interval,last_weather_location,last_weather_call_time,TOOLTIP_WAIT=1200,TOOLTIP=$("#tooltip"),dialog_tracking_url=undefined,dialog_tracking_millis=undefined,PAPALY_APP_AUTHENTICATION_CALLBACK_SUCCESS=papaly_app_authentication_success,PAPALY_APP_AUTHENTICATION_CALLBACK_FAILURE=papaly_app_authentication_failure,PAPALY_APP_AUTHENTICATION_WINDOW=undefined;jQuery.expr[":"].contains=function(e,t,i){return 0<=jQuery(e).text().toUpperCase().indexOf(i[3].toUpperCase())},jQuery.fn.register_favorite_category_sortable=function(){return jQuery.ui&&jQuery.ui.sortable&&$(this).sortable({distance:10,handle:".title-description-container",zIndex:2e3,revert:100,placeholder:"favorite-category-placeholder",tolerance:"intersect",cancel:".card.category-editing",helper:"clone",start:function(){$("#main").addClass("drag-initiated-card")},stop:function(){$("#main").removeClass("drag-initiated-card")},update:function(e,t){if($(this)[0]===t.item.parent()[0]){var i=t.item.attr("category-index"),n=t.item.index(),o=0<=n-1?$("#favorite-category-list").find(".card").eq(n-1).attr("category-index"):undefined,r=n+1<$("#favorite-category-list").find(".card").length?$("#favorite-category-list").find(".card").eq(n+1).attr("category-index"):undefined;$.ajax({type:"PUT",url:"/categories/move_favorite",data:{category_id:i,behind_id:o,ahead_id:r},statusCode:{0:networkerror_status0,401:redirect_401},success:function(){},error:function(){show_flash_notice("Error when updating category's position","error")}})}}}),this};var adjust_speed_dial_styles_with_throttle=$.throttle(50,adjust_speed_dial_styles_without_throttle),adjust_speed_dial_styles=function(){"speeddial"==$("#main").attr("board-state")&&adjust_speed_dial_styles_with_throttle()};jQuery.fn.register_tab_sortable=function(){return jQuery.ui&&jQuery.ui.sortable&&$(this).sortable({distance:20,axis:"y",containment:"parent",zIndex:2e3,revert:100,placeholder:"tab-placeholder",tolerance:"pointer",items:".nav-section-item",start:function(){$(this).closest(".nav-section").addClass("sorting")},stop:function(){$(this).closest(".nav-section").removeClass("sorting")},update:function(e,t){var i=t.item.attr("board-id"),n=t.item.index(),o=0<=n-1?$(this).find(".nav-section-item").eq(n-1).attr("board-id"):undefined,r=n+1<$(this).find(".nav-section-item").length?$(this).find(".nav-section-item").eq(n+1).attr("board-id"):undefined;$.ajax({type:"PUT",url:"/boards/move",data:{authenticity_token:CSRF_TOKEN,board_id:i,behind_board_id:o,ahead_board_id:r},statusCode:{0:networkerror_status0,401:redirect_401},success:function(){ga("send","event","board","move","success")},error:function(){ga("send","event","board","move","error"),show_flash_notice("Error when updating board's position","error")}})}}),this},jQuery.fn.register_tab_droppable=function(){if(!jQuery.ui||!jQuery.ui.droppable)return this;var d=$(this);return d.droppable({accept:".board:not([co-owner-limit=true]) .category-container, .board:not([co-owner-limit=true]) .child-category, .board:not([co-owner-limit=true]) .item-bookmark",hoverClass:"drop-hover",tolerance:"pointer",over:function(e,t){show_float_sidebar(),t.helper.hasClass("item-bookmark")?(t.helper.addClass("transparent-item"),$(this).addClass("drop-hover-item"),$(this).siblings().removeClass("drop-hover-item")):t.helper.is(".category-container, .child-category")&&t.helper.addClass("transparent-card"),t.helper.current_board_id=e.target.getAttribute("board-id"),t.helper.placeholder=t.helper.placeholder||$(".shortcut-placeholder:visible, .bookmark-placeholder:visible, .category-placeholder:visible").hide()},out:function(e,t){var i=$(this);setTimeout(function(){i.removeClass("drop-hover-item"),t.helper.current_board_id==e.target.getAttribute("board-id")&&(t.helper.current_board_id=undefined,t.helper.removeClass("transparent-card transparent-item"),d.removeClass("drop-hover-item"),t.helper.placeholder&&(t.helper.placeholder.show(),t.helper.placeholder=undefined))},10)},deactivate:function(){$("div.collapsed-your-boards").removeClass("visible"),hide_float_sidebar()},drop:function(e,t){if(t.helper.removeClass("transparent-card transparent-item"),t.draggable.hasClass("item-bookmark"))d.removeClass("drop-hover-item");else{t.draggable.current_board_id=$(this).attr("board-id");var i=t.draggable.removeClass("transparent-card"),n=i.closest(".board");i.remove();var r=$(this).attr("name"),a=$(this).attr("board-id"),o=0,s=null,l=.9*$('.board[board-id="'+a+'"]').find(".slot-"+o).find(".category-container:first .parent-category").attr("category-position")||1;n.each(update_board_excess_links_toggle);var c=i.hasClass("category-container")?i.find(".parent-category").attr("category-index"):i.attr("category-index");$.ajax({type:"PUT",url:"/categories/move",data:{category_ids:[c],to_board_id:a,to_slot:o,behind:s,ahead:l},statusCode:{0:networkerror_status0,401:redirect_401},success:function(e,t,i){if(e&&"success"==e.status){update_categories_with_replacement(e.categories),ga("send","event","category","move","sidebar");var n=$('.nav-section-item[board-id="'+a+'"]').find(".nav-item-categories"),o=$('.nav-item-category[category-index="'+c+'"]');n.prepend(o),show_flash_notice('Category moved to board "'+r+'"',"ok")}else this.error(i,t,e.message)},error:function(){ga("send","event","category","move","error"),show_flash_notice("Error while moving category","error")}})}}}),d.find(".nav-item-categories li").register_tab_category_droppable(),this},jQuery.fn.register_tab_category_droppable=function(){return jQuery.ui&&jQuery.ui.droppable&&$(this).filter("li").droppable({accept:".board:not([co-owner-limit=true]) .item-bookmark",hoverClass:"drop-hover",tolerance:"pointer",drop:function(e,t){var i=t.draggable;$("#main").hasClass("editing-on")&&(i=$(".item-bookmark.selected")),t.draggable.current_category_id=$(this).attr("category-index"),t.draggable.detach(),t.helper.detach(),i.removeClass(".selected newly-created").remove();var n=i.map(function(e,t){return t.getAttribute("item-index")}).toArray(),o=$(this).attr("category-index"),r=$(this).text();$.ajax({type:"PUT",url:"/items/move",data:{item_ids:n,to_category:o},statusCode:{0:networkerror_status0,401:redirect_401},success:function(){ga("send","event","item","move","sidebar",n.length),$("#boards-container").find('.card[category-index="'+o+'"]').find(".item-container").prepend(i.show()),show_flash_notice("Item moved to "+r,"ok")},error:function(){ga("send","event","item","move","error",n.length),show_flash_notice("Error when updating item's position","error")}})}}),this},jQuery.fn.register_board_edit_listeners=function(){var e=$(this).filter(".board");return e.find(".category-slot").register_category_sortable(),e.filter(":not([co-owner-limit=true])").find('.card[category-type="category"][pinned="false"]').register_item_sortable(),e.filter("[co-owner-limit=true]").find('.card[category-type="category"][pinned="false"]').register_item_sortable("#boards-container "),e.find(".item-bookmark, .shortcut-module").find(".delete-icon").click(function(e){stop_default_and_propagation(e),trash_item(e)}),this},jQuery.fn.register_trash_droppable=function(){return jQuery.ui&&jQuery.ui.droppable&&$(this).filter(".delete-dropbox").droppable({accept:".card, .category-container, .item-bookmark, .shortcut-module",hoverClass:"trash-drop-hover",tolerance:"touch",over:function(e,t){t.helper.addClass("over-trash"),t.helper.placeholder=$(".bookmark-placeholder:visible, .category-placeholder:visible").hide()},out:function(e,t){t.helper.removeClass("over-trash"),t.helper.placeholder&&t.helper.placeholder.show()},drop:function(e,t){var i=t.draggable;t.draggable!=t.helper&&t.helper.detach(),i.hasClass("item-bookmark")?(t.helper.hasClass("edit-mode-ui-helper")&&(i=i.add($(".item-bookmark.selected")),$(".card.selected").removeClass("selected")),trash_item(e,i),$(".ui-sortable-helper").remove()):i.hasClass("category-container")?trash_category(e,i.find(".parent-category")):i.hasClass("child-category")?trash_category(e,i):i.hasClass("smart-card")?remove_favorite_category(i.detach()):i.hasClass("shortcut-module")&&(trash_item(e,i),adjust_shortcuts_size(),0===$("#speed-dial-section .shortcut-module").length&&$("#speed-dial-section").addClass("shortcut-empty"))}}),this},jQuery.fn.register_category_sortable=function(){return jQuery.ui&&jQuery.ui.sortable&&$(this).sortable({items:'.category-container, .parent-category:not([pinned="true"]) ~ .child-category',distance:10,handle:".title-description-container",zIndex:2e3,revert:100,placeholder:"category-placeholder",connectWith:".category-slot",tolerance:"intersect",cancel:".card.category-editing, .toggle-child-category, .add-item-controls, .overflow-menu",refreshPositions:!0,sort:function(e,t){var n=t.placeholder;if(n.is(":visible")){var i;n.hide(),n.old.show(),i=n.closest(this).length?$(this):n.closest($(this).sortable("option","connectWith"));var o=n.old.prev(".category-container");o.length&&o.append(n.old);var r=e.clientY;if("true"==t.item.find(".parent-category").attr("pinned")){var a=n.closest(".category-container");if(a.length){var s=a.offset().top,l=s+a.outerHeight();r<(s+l)/2?n.insertBefore(a):n.insertAfter(a)}}else i.find(".category-container").find(".child-category, .category-placeholder").each(function(){var e=$(this);if(e.hasClass("ui-sortable-helper")||e.hasClass("category-placeholder:not(.old)"))return!0;var t=e.offset().top,i=t+e.outerHeight();return e.is(".category-placeholder.old:last-child")&&t<r?(r<(t+i)/2?n.insertAfter(e):n.insertAfter(e.closest(".category-container")),!1):t<r&&r<i?(n.insertAfter(e),!1):void 0});n.next()[0]!==n.old[0]&&n.prev()[0]!==n.old[0]&&setTimeout(adjust_slot_height,30),n.show(),n.old.remove(),n.next().is(".ui-sortable-helper, .child-category.placeholder")&&n.insertAfter(n.next()),n.old=n.clone().addClass("old").hide(),n.after(n.old)}},start:function(e,t){var i=t.placeholder,n=t.item.height();i.css("height",n),$("#main").addClass("drag-initiated-card"),checkLimitations(),adjust_slot_height(),$(".overflow-menu").hide(),i.old=i.clone().addClass("old").hide(),i.after(i.old)},beforeStop:function(e,t){t.placeholder.old.remove()},stop:function(e,t){if(restoreLimitations(),adjust_slot_height(),$("#main").removeClass("drag-initiated-card"),t.item.current_board_id){var i,n=t.item.closest(".board"),o=t.item.current_board_id,r=$('.board[board-id="'+o+'"]');return i=t.item.detach().hasClass("category-container")?t.item:$("#template-container").find(".category-container").clone().empty().append(t.item.addClass("parent-category").removeClass("child-category")),r.find(".category-slot").first().prepend(i),void n.add(r).each(update_board_excess_links_toggle)}},over:function(){adjust_slot_height()},update:function(e,t){if(restoreLimitations(),$(this)[0]===t.item.closest(".category-slot")[0])if(t.item.current_board_id)t.item.detach();else{var i,n,o,r=!1,a=t.item.prev(),s=a.hasClass("category-container")?a.find(".parent-category").attr("category-position"):a.attr("category-position"),l=t.item.next(),c=l.hasClass("category-container")?l.find(".parent-category").attr("category-position"):l.attr("category-position");if(t.item.hasClass("child-category")&&!t.item.closest(".category-container").length)i=t.item.addClass("parent-category").removeClass("child-category"),n=$("#template-container").find(".category-container").clone().empty(),i.replaceWith(n).remove(),n.append(i),t.item=n;else if(t.item.hasClass("category-container")&&t.item.parents(".category-container").length){var d=t.item.find(".child-category:not(.placeholder)");r=r||!!d.length,i=t.item,n=t.item.find(".parent-category"),i.after(d).replaceWith(n).remove(),t.item=n.addClass("child-category").removeClass("parent-category")}(o=t.item.hasClass("category-container")?{category_ids:[t.item.find(".parent-category").attr("category-index")],to_slot:t.item.parent().index()}:{category_ids:[t.item.attr("category-index")],to_parent_category_id:t.item.siblings(".parent-category").attr("category-index")}).behind=s,o.ahead=c,r?(select_and_refresh_board(t.item.closest(".board").attr("board-id"),!0),load_dialog(null,"dialog/unnest_categories_confirmation?category_id="+o.category_ids[0],function u(){$("#unnest-categories-confirmation").attr("params",JSON.stringify(o))})):move_category_within_board(o)}}}),this},jQuery.fn.register_item_sortable=function(e){return jQuery.ui&&jQuery.ui.sortable&&(e=e||"",$(this).find(".item-container").sortable({items:".item-bookmark",distance:10,zIndex:2e3,helper:function(e,t){if($("#main").hasClass("editing-on")){t.addClass("selected");var i=$(".item-bookmark.selected");if(1==i.length)return t.clone();var n=$('<li class="item-bookmark ui-sortable-handle ui-sortable-helper edit-mode-ui-helper" ></li>');return n.append($('<a>  <div class="item-name">'+i.length+" Items</div></a>")),n}return t.clone().addClass("ui-sortable-helper").css("height",30)},cancel:".separator,.item-editing,.new-item-template,.item-editor,input",revert:100,placeholder:"bookmark-placeholder",connectWith:e+".item-container,"+e+"#speed-dial-section ul",tolerance:"pointer",refreshPositions:!0,start:function(e,t){t.placeholder.css("min-width",t.helper.width()),t.item.closest('[board-state="speeddial"] #inbox-section').length?$("#main").addClass("drag-initiated-inbox"):$("#main").addClass("drag-initiated-item"),$("#main").hasClass("editing-on")&&t.helper.hasClass("edit-mode-ui-helper")&&(t.item=$(".item-bookmark.selected").hide()),t.item.closest(".card, #inbox-items-container").attr("category-index")==t.item.closest("#inbox-items-container").attr("category-index")&&try_call("inbox_tutorial_completed"),checkLimitations(),$(".overflow-menu").hide()},over:function(e,t){adjust_slot_height(),t.placeholder.css("min-width",t.helper.width()),t.helper&&t.helper.removeClass("transparent-item")},beforeStop:function(e,t){restoreLimitations(),$("#main").removeClass("drag-initiated-item drag-initiated-inbox"),$(".item-bookmark.selected").show();var i=t.placeholder.parent();i.closest(".card").length&&i.children().last()[0]==t.placeholder[0]&&i.append(i.find(".show-excess-links-button, .hide-excess-links-button"))},stop:function(e,t){if(t.item.current_category_id){var i=t.item.detach(),n=t.item.current_category_id;return $('.card[category-index="'+n+'"]').find(".item-container").prepend(i),void(t.item.current_category_id=undefined)}},update:function(e,t){if($(this)[0]===t.item.parent()[0]){if(t.item.current_category_id){var i=t.item.detach(),n=t.item.current_category_id;return(o=$('.card[category-index="'+n+'"]')).find(".item-container").prepend(i),void(t.item.current_category_id=undefined)}var o,r=t.item,a=[r.attr("item-index")],s=(o=t.item.closest(".card, #inbox-section")).filter(".card").add($(t.sender).closest(".card")),l=0<t.item.filter(".shortcut-module").length;$("#main").hasClass("editing-on")&&t.item.hasClass("item-bookmark")&&(r=$(".item-bookmark.selected"),a=r.map(function(e,t){return t.getAttribute("item-index")}).toArray(),s=r.add(s).closest(".card"),t.item.after(r),$(".card.selected").removeClass("selected"),o.is(".card")&&o.addClass("selected"));var c=o.attr("category-index");c==t.item.closest("#inbox-section").attr("category-index")&&try_call("inbox_tutorial_completed");var d=t.item.index(),u=t.item.prev().attr("item-position"),h=t.item.next().attr("item-position");t.item.removeClass("newly-created");var f={item_ids:a,to_category:c,to_position:d,behind:h,ahead:u};l&&(t.item.hide(),placeholder=$('<div style="height: 30px;"></div>'),t.item.after(placeholder),t.item.detach(),f.render_item="true",adjust_shortcuts_size()),update_board_excess_links(s),$.ajax({type:"PUT",url:"/items/move",data:f,statusCode:{0:networkerror_status0,401:redirect_401},success:function(e){if(ga("send","event","item","move","card",a.length),e){var t=$(e);placeholder.after(t).remove(),$("#main").hasClass("editing-on")&&t.addClass("selected")}},error:function(){ga("send","event","item","move","error",a.length),show_flash_notice("Error when updating item's position","error")}})}}})),this},jQuery.fn.register_new_category_listeners=function(){var e=$(this),t=e.filter(".card").add(e.find(".card"));return t.find(".item-bookmark").register_item_listeners().end().filter(":not(.feed)").register_item_sortable(),update_board_excess_links(t),load_all_feeds(),e.closest(".board").find(".selected").removeClass("selected"),e};var hide_board_overflow_menu_timeout,flash_notice_count=0,rand_notice_count=0,RAND_NOTICE_DURATION=3e4;$(document).ready(function(){run_all_really_once_jobs()}),jQuery.fn.register_board_listeners=function(){return $(this).filter(".board").each(function(){this.registered_listeners||(this.registered_listeners=!0,$board=$(this),$board.find(".item-bookmark").register_item_listeners(),$board.filter("[own-board='true']").register_board_edit_listeners(),load_all_feeds($board),$board.each(update_board_excess_links_toggle))}),this},$(document).ready(function(){register_login_listeners(),$("#user_email").focus()});//# sourceURL=application.js
