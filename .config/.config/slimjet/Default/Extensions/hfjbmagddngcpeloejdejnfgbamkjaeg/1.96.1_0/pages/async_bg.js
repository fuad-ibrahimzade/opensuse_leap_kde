"use strict";__filename="pages/async_bg.js",define(["require","exports"],function(n,e){var t,u,o,r,i,c,l,a,f,s,m,d,v,h,p,g,b,y,w,K,q,C,M;Object.defineProperty(e,"__esModule",{value:true}),e.simulateClick=e.h=e.$t=e.a=e.import2=e.K=e.m=e.toggleReduceMotion=e.toggleDark=e.$$=e.$=e.an=e.d=e.fn=e.nn=e.wt=e.mn=e.pt=e.sn=e.OnSafari=e.OnEdge=e.OnFirefox=e.OnChrome=void 0,e.OnChrome=!0,e.OnFirefox=!!0,e.OnEdge=!!0,e.OnSafari=false,t=navigator.userAgentData,e.sn=t?!!t.brands.find(function(n){return n.brand.includes("Edge")||n.brand.includes("Microsoft")}):matchMedia("(-ms-high-contrast)").matches,e.pt=t?(u=t.brands.find(function(n){return n.brand.includes("Chromium")}))?u.version:90:(K=navigator.userAgent.match(/\bChrom(?:e|ium)\/(\d+)/))?75==+K[1]&&matchMedia("(prefers-color-scheme)").matches?81:0|K[1]:998,e.mn=999,e.wt=chrome,e.nn=new Promise(function(n){addEventListener("VimiumC",function t(){e.pt<55&&removeEventListener("VimiumC",t,{capture:true}),e.K(n)},{once:true,capture:true})}),o=0,r=new Map,i=null,c=null,l=Object.create(null),a=1,f=null,e.fn=-1,s=function(n){var e,t,u;if(false!==n){for(e=l[n.i],delete l[n.i],t=n.a,u=0;u<e.length;u++)e[u](t[u]);VApi&&f&&0===Object.keys(l).length&&h()}else alert("Can not send info to the background: not trusted")},m=function(){var n,e,t;for(n in f=null,i=[],c=[],l)for(t of(e=l[n],delete l[n],e))try{t(null)}catch(n){}i=c=null},d=function(n){var t,u,o,r,v;i&&(t=VApi,(u=i.length)>(n||1)?p(d.bind(null,u)):(t&&f&&0===Object.keys(l).length&&h(),0!==n?(o=a++,l[o]=c,c=null,(v=(r=e.wt.extension.getBackgroundPage)&&r())&&v.onPagesReq?v.onPagesReq({i:o,q:i}).then(s):t?t.r[0](37,{i:o,q:i},s):(f||((f=e.wt.runtime.connect({name:"64"})).onMessage.addListener(s),f.onDisconnect.addListener(m)),f.postMessage({H:37,i:o,q:i})),i=null):i=c=null))},e.d=function(n,e){return new Promise(function(t){i||v(),i.push({n:n,q:void 0!==e?e:null}),c.push(t)})},e.an=v=function(){i||(i=[],c=[],p(d))},h=function(){var n=f;f=null,n&&(n.onDisconnect.removeListener(m),n.onMessage.removeListener(s),n.disconnect())},p=function(n){Promise.resolve().then(n)},e.$=function(n){return document.querySelector(n)},e.$$=function(n,t){var u=(t||document).querySelectorAll(n);return e.pt<51?[].slice.call(u):u},e.toggleDark=function(n){var e=document.head.querySelector("meta[name=color-scheme]"),t=n?"light dark":"light";e.content!==t&&(e.content=t,document.documentElement.classList.toggle("no-dark",!n))},e.toggleReduceMotion=function(n){document.documentElement.classList.toggle("less-motion",n)},e.K=(q=function(){var n,e=C.length;for(n=0;n<e;n++)C[n]();C.length>e?(C.splice(0,e),p(q)):C.length=0},C=[],e.m=function(n,e){3==(o=(o|n)&~(e||0))&&p(q)},function(n,e){C.length<=0&&3===o&&p(q),9===e?C.unshift(n):C.push(e?n.bind(null,e):n)}),e.import2=function(n){return define([n])},e.a=function(n,e){var t=r.get(n);return null!=e&&t&&(t=t.replace(/\$\d/g,function(n){return e[+n[1]-1]})),t},g=function(n,e){return n&&n.split(" ").reduce(function(n,t){return n||(t.includes("=")?t.startsWith(e)?t.slice(e.length+1):n:t)},"")},e.$t=e.wt.i18n.getMessage,b=location.pathname.replace("/pages/","").split(".")[0],y=e.$t("lang1"),e.h=g(e.$t("i18n"),b)||y||"en",Promise.all(e.h.split(",").map(function(n){var e="/i18n/".concat(n,"/").concat("show"===b?"popup":b,".json");return fetch(e).then(function(n){return n.json()}).catch(function(n){return console.log("Can not load the language file:",e,":",n),null})})).then(function(n){var t,u,o=r;for(t of n.reverse())if(t)for(u in t)o.set(u,t[u]);e.m(2)}),M=function(n,e){return new Promise(function(t){var u=t.bind(0,void 0),o=n.call(e),r=function(n){var e=o.next(n);Promise.resolve(e.value).then(e.done?t:r,u)};r()})},globalThis.__awaiter=function(n,e,t,u){return M(u,n)},e.pt>75&&e.wt.storage.local.get("autoDarkMode",function(n){return false===n.autoDarkMode&&e.toggleDark(false),e.wt.runtime.lastError}),y&&"popup"!==b&&(w=e.$t("v"+b))&&(document.title="Vimium C "+w),"options"===b&&e.nn.then(function(){VApi.r[0](37,{i:1,q:[{n:26,q:null}]},function(n){false!==n&&(e.fn=n.a[0])})}),e.simulateClick=function(n,e){var t;return e=e||{ctrlKey:true,altKey:true,shiftKey:true,metaKey:true},t=new MouseEvent("click",{bubbles:true,cancelable:true,composed:!0,view:window,detail:1,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey,button:0,buttons:1,relatedTarget:null}),n.dispatchEvent(t)},"undefined"==typeof VApi&&(globalThis.VApi=void 0)});