"use strict";__filename="pages/options_base.js",define(["require","exports","./async_bg"],function(t,i,n){var e,s,r,u,o;Object.defineProperty(i,"__esModule",{value:true}),i.t=i.n=i.e=i.s=i.r=i.u=i.o=i.showI18n=void 0,e=function(){var t,e,s,r,u,o;if("en"!==n.h){if(t=n.h.split(",")[0],e=navigator.language||t,(r=(s=n.$("#keyMappings"))&&i.t("keyMappingsP"))&&(s.placeholder=r),e&&(!t.startsWith("zh")||"zh-CN"!==e))for(s of n.$$("input[type=text], textarea"))s.lang=e;for(s of n.$$("[data-i]"))o=(u=s.dataset.i).endsWith("-t"),null!=(r=n.a(o?u.slice(0,-2):u))&&(o?s.title=r:s.innerText=r);document.documentElement.lang="zh"===t?"zh-CN":t}},i.showI18n=e,window.__extends=function(t,i){var n=function(){this.constructor=t};n.prototype=i.prototype,t.prototype=new n},i.o=function(t,i,n,e){var s,r=0,u=function(){var o=Date.now()-s;if(!(o<i-4&&o>=0))return r=0,s!==e?t.call(n):void 0;r=setTimeout(u,i-o)};return e=e?1:0,function(){if(s=Date.now(),!r)return r=setTimeout(u,i),e?(e=s,t.call(n)):void 0}},s=null,i.u=function(t){s=t},i.r={c:"",f:9,l:null,p:function(){s=null},v:function(){return s?s instanceof Promise?s:Promise.resolve():(i.r.l||n.d(0).then(function(t){i.r.l=t[0],i.r.f=t[1],i.r.c=t[2],n.m(1)}),s=n.d(1).then(function(t){s=t}))},y:function(t){var i,n=this;return null==s&&this.v(),s instanceof Promise?s.then(function(){return n.y(t)}):void 0!==(i=s[t])?i:this.l[t]},g:function(t,e){var r,u;return u=e,void 0!==(r=i.r.l[t])&&("object"==typeof r?JSON.stringify(e)===JSON.stringify(r):e===r)&&(u=null),n.d(2,{key:t,val:u}).then(function(i){s[t]=null!==i?i:e})},k:{__proto__:null,filterLinkHints:"f",ignoreCapsLock:"i",ignoreKeyboardLayout:"l",mapModifier:"a",mouseReachable:"e",keyboard:"k",linkHintCharacters:"c",linkHintNumbers:"n",passEsc:"p",regexFindMode:"r",smoothScroll:"s",scrollStepSize:"t",waitForEnter:"w"}},r=(function(){function t(t,n){this.b=t,this.x=t.id,this.S=this.w=null,this.N=false,this.x in i.r.k&&(n=this.O.bind(this,n)),this.w=i.o(n,330,this,1),this.P(t)}return t.prototype.z=function(){},t.prototype.J=function(){var i,e=this;if(this.N=true,(i=this.C())instanceof Promise)return i.then(t.prototype.J.bind(this));this.S=i,t.R||n.K(function(){e.M(e.S)})},t.prototype.C=function(){return i.r.y(this.x)},t.prototype.T=function(t){var i=this.j;return i?i.H(t):t},t.prototype.L=function(){return true},t.prototype.A=function(){return __awaiter(this,void 0,void 0,function*(){var t,i=this,e=this.D(),s="object"==typeof e,r=s?JSON.stringify(this.S):this.S,u=s?JSON.stringify(e):e;if(u!==r)return r=u,e=(t=this.T(e))instanceof Promise?yield t:t,e=yield this.E(e),this.S=e,this.N=true,(r!==(s?JSON.stringify(e):e)||this.F(e))&&n.K(function(){i.M(i.S,true)}),this.z()})},t.prototype.Z=function(){var t=this.C(),i=!this.q(this.S,t);return i&&this.q(this.D(),t)?(this.S=t,this.N=true,false):i},t.prototype.E=function(n){return __awaiter(this,void 0,void 0,function*(){return yield i.r.g(this.x,n),this.x in i.r.k&&t.B.push(this.x),this.C()})},t.prototype.F=function(){return false},t.G=function(t,i){return JSON.stringify(t)===JSON.stringify(i)},t.R=false,t})(),i.s=r,u=(function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.q=r.G,i}return __extends(e,t),e.prototype.P=function(t){var i=this;this.I=t.querySelector("#exclusionTemplate").content.querySelector(".exclusionRule"),this.Q=t.querySelector("tbody"),this.U=[],this.Q.addEventListener("input",e.V),this.Q.addEventListener("input",this.w),this.Q.addEventListener("click",function(t){return i.W(t)}),this.X=false,n.$("#exclusionAddButton").onclick=function(){return i.Y("")}},e.prototype.tt=function(){},e.V=function(t){var i=t.target,n=i.vnode;n&&(n.it|=i.classList.contains("pattern")?1:2)},e.prototype.Y=function(t,i){this.nt(this.Q,{pattern:t,passKeys:""});var e=this.U[this.U.length-1];false!==i&&n.K(function(){return e.et.focus()}),t&&this.w(),this.tt(1)},e.prototype.M=function(t){var i,e,s;if(!this.X)for(i of(this.X=true,r.B&&(this.I.draggable=true),"en"!==n.h?n.$$("[title]",this.I):[]))(e=n.a(i.title))&&(i.title=e);return this.Q.textContent="",this.U=[],t.length<=0||(1===t.length?this.nt(this.Q,t[0]):(s=document.createDocumentFragment(),t.forEach(this.nt.bind(this,s)),this.Q.appendChild(s))),this.tt(t.length)},e.prototype.st=function(){return true},e.prototype.nt=function(t,i){var n,e,s,r,u,o=i.pattern,h=i.passKeys,a={rt:{pattern:o,passKeys:h},ut:null,it:0,ot:false,et:null,ht:null};a.ot=this.st(a),a.ot?(e=(n=document.importNode(this.I,true)).querySelector(".pattern"),s=n.querySelector(".passKeys"),r=h.trimRight(),e.value=o,o&&(e.placeholder=""),s.value=r,r&&(s.placeholder=""),(u=a).et=e,u.ht=s,e.vnode=u,s.vnode=u,this.U.push(u),t.appendChild(n)):this.U.push(a)},e.at=function(t){t.rt.pattern&&t.ht.placeholder&&(t.ht.placeholder="")},e.prototype.W=function(t){var i,n=t.target;if("path"===n.localName&&(n=n.parentElement),"svg"===n.localName&&(n=n.parentElement),n.classList.contains("remove"))return(n=n.parentNode.parentNode).classList.contains("exclusionRule")?(i=n.querySelector(".pattern").vnode,n.remove(),this.U.splice(this.U.indexOf(i),1),this.w(),this.tt(0)):void 0},e.ct=function(t,i,n){var e=n.toLowerCase();return i||1!==n.length?n!==e?"<".concat(i,"s-").concat(e,">"):t:n},e.ft=function(t){return t&&t.replace(/<(?!<)((?:[acm]-){0,3})(\S|[A-Za-z]\w+)>/g,e.ct)},e.prototype.D=function(t){var n,s,r,u,h,a,c,f,l,p,v,d=[];for(n of(t=true===t,this.U))t&&!n.ot||((s=n.it)?(r=1&s?n.et.value.trim():n.rt.pattern,u=false,h=2&s?n.ht.value:n.rt.passKeys,r?(1&s&&((a=r.startsWith(":")?0:r.indexOf("://"))&&(/^[\^*]|[^\\][$()*+?\[\]{|}]/.test(r)?r.startsWith("`")||(r.startsWith("^")?(f=".*$".includes(r.slice(-2))?r.endsWith(".*$")?3:r.endsWith(".*")?2:0:0,r=0!==f&&"\\"!==r[r.length-f]?r.slice(0,-f):r):(u=!r.includes("/",a+3),r.endsWith("*")&&(r=r.slice(0,/^[^\\]\.\*$/.test(r.slice(-3))?-2:-1),u=false),c=(a<0?"^https?://":"^")+((c=r=r.startsWith(".*")&&!/[(\\[]/.test(r)?"*."+r.slice(2):r).startsWith("*")&&"."!==c[1]?"[^/]"+c:(c=c.replace(/\./g,"\\.")).startsWith("*")?c.replace("*\\.","(?:[^./]+\\.)*?"):c.replace("://*\\.","://(?:[^./]+\\.)*?")),r=o(c,"")?c:r.includes("*")||r.includes("/")?":"+r:":https://"+(r.startsWith(".")?r.slice(1):r))):(u=!r.includes("/",a+3)&&!r.startsWith("vimium:"),r=(a<0?":http://":":")+(r=r.replace(/\\(.)/g,"$1")))),u&&(r+="/")),2&s&&h&&((l=(h=e.ft(h)).match(/<(?!<)(?:a-)?(?:c-)?(?:m-)?(?:s-)?(?:[a-z]\w+|[^\sA-Z])>|\S/g))&&((p="^"===l[0]&&l.length>1)&&l.shift(),l.sort(),p?l.unshift("^"):"^"===l[0]&&(l.shift(),l.push("^"))),h=(h=l?l.join(" ")+" ":"").replace(/<escape>/gi,"<esc>")),v=h?h.length>1&&"^"===h[0]?i.t("onlyHook")||"only hook such keys":i.t("passThrough")||"pass through such keys":i.t("completelyDisabled")||"completely disabled",n.et.title!==r&&(n.et.title=r),n.ht.title!==v&&(n.ht.title=v),this.lt(n,r,h),d.push(n.rt)):(n.et.title&&(n.et.title=""),n.ht.title&&(n.ht.title=""),this.lt(n,"",h))):n.rt.pattern&&d.push(n.rt));return d},e.prototype.lt=function(t,i,n){var s=!t.rt.passKeys&&!!n;t.rt={pattern:i,passKeys:n},t.ut=null,t.it=0,s&&e.at(t)},e.prototype.z=function(){var t,i;for(t of this.U)t.ot&&(t.et.value!==t.rt.pattern&&(t.et.value=t.rt.pattern),i=t.rt.passKeys.trim(),t.ht.value!==i&&(t.ht.value=i))},e})(r),i.e=u,o=function(t,i){try{return new RegExp(t,i)}catch(t){return null}},i.n=n.pt<48||devicePixelRatio<2&&n.pt>=61?function(){var t=document.createElement("style"),i=devicePixelRatio,e=n.pt>=61&&i>=1,s=e||n.pt>=48?1/i:1;s=(""+(s+=999e-8)).slice(0,7).replace(/\.?0+$/,""),t.textContent=e?"html { --tiny: ".concat(s,"px; }"):"* { border-width: ".concat(s,"px !important; }"),document.head.appendChild(t)}:null,i.t=function(t,i){return n.a(t,i)||""}});