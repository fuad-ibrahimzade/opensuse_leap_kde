(()=>{var e={458:(e,t,r)=>{"use strict";const n=r(2589);e.exports=n},2589:(e,t,r)=>{"use strict";const n=r(1524);function s(e){return e.startsWith("system.")||e.startsWith("aria2.")||(e="aria2."+e),e}function o(e){return e.split("aria2.")[1]||e}class i extends n{addSecret(e){let t=this.secret?["token:"+this.secret]:[];return Array.isArray(e)&&(t=t.concat(e)),t}_onnotification(e){const{method:t,params:r}=e,n=o(t);return n!==t&&this.emit(n,r),super._onnotification(e)}async call(e,...t){return super.call(s(e),this.addSecret(t))}async multicall(e){const t=[e.map((([e,...t])=>({methodName:s(e),params:this.addSecret(t)})))];return super.call("system.multicall",t)}async batch(e){return super.batch(e.map((([e,...t])=>[s(e),this.addSecret(t)])))}async listNotifications(){return(await this.call("system.listNotifications")).map((e=>o(e)))}async listMethods(){return(await this.call("system.listMethods")).map((e=>o(e)))}}Object.assign(i,{prefix:s,unprefix:o}),i.defaultOptions=Object.assign({},n.defaultOptions,{secure:!1,host:"localhost",port:6800,secret:"",path:"/jsonrpc"}),e.exports=i},1222:e=>{"use strict";e.exports=function(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}},1524:(e,t,r)=>{"use strict";var n=r(8816);const s=r(1222),o=r(3810),i=r(832),a=r(4224),c=r(7274),l=r(343),u=n.WebSocket||a,m=n.fetch?n.fetch.bind(n):c;class g extends l{constructor(e){super(),this.deferreds=Object.create(null),this.lastId=0,Object.assign(this,this.constructor.defaultOptions,e)}id(){return this.lastId++}url(e){return e+(this.secure?"s":"")+"://"+this.host+":"+this.port+this.path}websocket(e){return new Promise(((t,r)=>{const s=e=>{e?r(e):t()};this.socket.send(JSON.stringify(e),s),n.WebSocket&&this.socket instanceof n.WebSocket&&s()}))}async http(e){const t=await this.fetch(this.url("http"),{method:"POST",body:JSON.stringify(e),headers:{Accept:"application/json","Content-Type":"application/json"}});return t.json().then((e=>this._onmessage(e))).catch((e=>{this.emit("error",e)})),t}_buildMessage(e,t){if("string"!=typeof e)throw new TypeError(e+" is not a string");const r={method:e,"json-rpc":"2.0",id:this.id()};return t&&Object.assign(r,{params:t}),r}async batch(e){const t=e.map((([e,t])=>this._buildMessage(e,t)));return await this._send(t),t.map((({id:e})=>{const{promise:t}=this.deferreds[e]=new s;return t}))}async call(e,t){const r=this._buildMessage(e,t);await this._send(r);const{promise:n}=this.deferreds[r.id]=new s;return n}async _send(e){this.emit("output",e);const{socket:t}=this;return t&&1===t.readyState?this.websocket(e):this.http(e)}_onresponse({id:e,error:t,result:r}){const n=this.deferreds[e];n&&(t?n.reject(new i(t)):n.resolve(r),delete this.deferreds[e])}_onrequest({method:e,params:t}){return this.onrequest(e,t)}_onnotification({method:e,params:t}){this.emit(e,t)}_onmessage(e){if(this.emit("input",e),Array.isArray(e))for(const t of e)this._onobject(t);else this._onobject(e)}_onobject(e){void 0===e.method?this._onresponse(e):void 0===e.id?this._onnotification(e):this._onrequest(e)}async open(){const e=this.socket=new this.WebSocket(this.url("ws"));return e.onclose=(...e)=>{this.emit("close",...e)},e.onmessage=e=>{let t;try{t=JSON.parse(e.data)}catch(e){return void this.emit("error",e)}this._onmessage(t)},e.onopen=(...e)=>{this.emit("open",...e)},e.onerror=(...e)=>{this.emit("error",...e)},o(this,"open")}async close(){const{socket:e}=this;return e.close(),o(this,"close")}}g.defaultOptions={secure:!1,host:"localhost",port:80,secret:"",path:"/jsonrpc",fetch:m,WebSocket:u},e.exports=g},832:e=>{"use strict";e.exports=class extends Error{constructor({message:e,code:t,data:r}){super(e),this.code=t,r&&(this.data=r),this.name=this.constructor.name}}},3810:e=>{"use strict";e.exports=function(e,t){return new Promise(((r,n)=>{function s(){e.removeListener(t,o),e.removeListener("error",i)}function o(e){r(e),s()}function i(e){n(e),s()}e.addListener(t,o),e.addListener("error",i)}))}},343:e=>{"use strict";var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(r,n){function s(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",s),r([].slice.call(arguments))}d(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&d(e,"error",t,{once:!0})}(e,s)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var i=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function l(e,t,r,n){var s,o,i,l;if(a(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),i=o[t]),void 0===i)i=o[t]=r,++e._eventsCount;else if("function"==typeof i?i=o[t]=n?[r,i]:[i,r]:n?i.unshift(r):i.push(r),(s=c(e))>0&&i.length>s&&!i.warned){i.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=i.length,l=u,console&&console.warn&&console.warn(l)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function m(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},s=u.bind(n);return s.listener=r,n.wrapFn=s,s}function g(e,t,r){var n=e._events;if(void 0===n)return[];var s=n[t];return void 0===s?[]:"function"==typeof s?r?[s.listener||s]:[s]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(s):p(s,s.length)}function f(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function d(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function s(o){n.once&&e.removeEventListener(t,s),r(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return i},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");i=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var s="error"===e,o=this._events;if(void 0!==o)s=s&&void 0===o.error;else if(!s)return!1;if(s){var i;if(t.length>0&&(i=t[0]),i instanceof Error)throw i;var a=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw a.context=i,a}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)n(c,this,t);else{var l=c.length,u=p(c,l);for(r=0;r<l;++r)n(u[r],this,t)}return!0},o.prototype.addListener=function(e,t){return l(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return l(this,e,t,!0)},o.prototype.once=function(e,t){return a(t),this.on(e,m(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,m(this,e,t)),this},o.prototype.removeListener=function(e,t){var r,n,s,o,i;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(s=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){i=r[o].listener,s=o;break}if(s<0)return this;0===s?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,s),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,i||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var s,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(s=o[n])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},o.prototype.listeners=function(e){return g(this,e,!0)},o.prototype.rawListeners=function(e){return g(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},o.prototype.listenerCount=f,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},625:function(e,t,r){var n,s,o=r(625);"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,n=function(e){"use strict";if(void 0===window.browser||Object.getPrototypeOf(window.browser)!==Object.prototype||Object.getPrototypeOf(o)!==Object.prototype){const t="The message port closed before a response was received.",r="Returning a Promise is the preferred way to send a reply from an onMessage/onMessageExternal listener, as the sendResponse will be removed from the specs (See https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage)",n=e=>{const n={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(n).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class s extends WeakMap{constructor(e,t){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const o=(t,r)=>(...n)=>{e.runtime.lastError?t.reject(new Error(e.runtime.lastError.message)):r.singleCallbackArg||n.length<=1&&!1!==r.singleCallbackArg?t.resolve(n[0]):t.resolve(n)},i=e=>1==e?"argument":"arguments",a=(e,t,r)=>new Proxy(t,{apply:(t,n,s)=>r.call(n,e,...s)});let c=Function.call.bind(Object.prototype.hasOwnProperty);const l=(e,t={},r={})=>{let n=Object.create(null),s={has:(t,r)=>r in e||r in n,get(s,u,m){if(u in n)return n[u];if(!(u in e))return;let g=e[u];if("function"==typeof g)if("function"==typeof t[u])g=a(e,e[u],t[u]);else if(c(r,u)){let t=((e,t)=>function(r,...n){if(n.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${i(t.minArgs)} for ${e}(), got ${n.length}`);if(n.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${i(t.maxArgs)} for ${e}(), got ${n.length}`);return new Promise(((s,i)=>{if(t.fallbackToNoCallback)try{r[e](...n,o({resolve:s,reject:i},t))}catch(o){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,o),r[e](...n),t.fallbackToNoCallback=!1,t.noCallback=!0,s()}else t.noCallback?(r[e](...n),s()):r[e](...n,o({resolve:s,reject:i},t))}))})(u,r[u]);g=a(e,e[u],t)}else g=g.bind(e);else if("object"==typeof g&&null!==g&&(c(t,u)||c(r,u)))g=l(g,t[u],r[u]);else{if(!c(r,"*"))return Object.defineProperty(n,u,{configurable:!0,enumerable:!0,get:()=>e[u],set(t){e[u]=t}}),g;g=l(g,t[u],r["*"])}return n[u]=g,g},set:(t,r,s,o)=>(r in n?n[r]=s:e[r]=s,!0),defineProperty:(e,t,r)=>Reflect.defineProperty(n,t,r),deleteProperty:(e,t)=>Reflect.deleteProperty(n,t)},u=Object.create(e);return new Proxy(u,s)},u=e=>({addListener(t,r,...n){t.addListener(e.get(r),...n)},hasListener:(t,r)=>t.hasListener(e.get(r)),removeListener(t,r){t.removeListener(e.get(r))}}),m=new s((e=>"function"!=typeof e?e:function(t){const r=l(t,{},{getContent:{minArgs:0,maxArgs:0}});e(r)}));let g=!1;const f=new s((e=>"function"!=typeof e?e:function(t,n,s){let o,i,a=!1,c=new Promise((e=>{o=function(t){g||(console.warn(r,(new Error).stack),g=!0),a=!0,e(t)}}));try{i=e(t,n,o)}catch(e){i=Promise.reject(e)}const l=!0!==i&&((u=i)&&"object"==typeof u&&"function"==typeof u.then);var u;if(!0!==i&&!l&&!a)return!1;return(l?i:c).then((e=>{s(e)}),(e=>{let t;t=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",s({__mozWebExtensionPolyfillReject__:!0,message:t})})).catch((e=>{console.error("Failed to send onMessage rejected reply",e)})),!0})),p=({reject:r,resolve:n},s)=>{e.runtime.lastError?e.runtime.lastError.message===t?n():r(new Error(e.runtime.lastError.message)):s&&s.__mozWebExtensionPolyfillReject__?r(new Error(s.message)):n(s)},d=(e,t,r,...n)=>{if(n.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${i(t.minArgs)} for ${e}(), got ${n.length}`);if(n.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${i(t.maxArgs)} for ${e}(), got ${n.length}`);return new Promise(((e,t)=>{const s=p.bind(null,{resolve:e,reject:t});n.push(s),r.sendMessage(...n)}))},h={devtools:{network:{onRequestFinished:u(m)}},runtime:{onMessage:u(f),onMessageExternal:u(f),sendMessage:d.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:d.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},A={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return n.privacy={network:{"*":A},services:{"*":A},websites:{"*":A}},l(e,h,n)};if("object"!=typeof chrome||!chrome||!chrome.runtime||!chrome.runtime.id)throw new Error("This script should only be loaded in a browser extension.");e.exports=n(chrome)}else e.exports=o},void 0===(s=n.apply(t,[e]))||(e.exports=s)},8816:e=>{e.exports=window},7274:()=>{},4224:()=>{}},t={};function r(n){var s=t[n];if(void 0!==s)return s.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=r(458),t=r.n(e),n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function o(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function i(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,s,o=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)i.push(n.value)}catch(e){s={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(s)throw s.error}}return i}function a(e,t){for(var r=0,n=t.length,s=e.length;r<n;r++,s++)e[s]=t[r];return e}function c(e){return"function"==typeof e}function l(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}Object.create,Object.create;var u=l((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function m(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var g=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._teardowns=null}return e.prototype.unsubscribe=function(){var e,t,r,n,s;if(!this.closed){this.closed=!0;var l=this._parentage;if(l)if(this._parentage=null,Array.isArray(l))try{for(var m=o(l),g=m.next();!g.done;g=m.next())g.value.remove(this)}catch(t){e={error:t}}finally{try{g&&!g.done&&(t=m.return)&&t.call(m)}finally{if(e)throw e.error}}else l.remove(this);var f=this.initialTeardown;if(c(f))try{f()}catch(e){s=e instanceof u?e.errors:[e]}var d=this._teardowns;if(d){this._teardowns=null;try{for(var h=o(d),A=h.next();!A.done;A=h.next()){var v=A.value;try{p(v)}catch(e){s=null!=s?s:[],e instanceof u?s=a(a([],i(s)),i(e.errors)):s.push(e)}}}catch(e){r={error:e}}finally{try{A&&!A.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}}if(s)throw new u(s)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)p(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._teardowns=null!==(r=this._teardowns)&&void 0!==r?r:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&m(t,e)},e.prototype.remove=function(t){var r=this._teardowns;r&&m(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e;var t}();function f(e){return e instanceof g||e&&"closed"in e&&c(e.remove)&&c(e.add)&&c(e.unsubscribe)}function p(e){c(e)?e():e.unsubscribe()}g.EMPTY;var d=null,h=null,A=void 0,v=!1,y=!1,b={setTimeout:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=b.delegate;return((null==r?void 0:r.setTimeout)||setTimeout).apply(void 0,a([],i(e)))},clearTimeout:function(e){var t=b.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function x(e){b.setTimeout((function(){if(!d)throw e;d(e)}))}function w(){}var _=k("C",void 0,void 0);function k(e,t,r){return{kind:e,value:t,error:r}}var O=null;function P(e){v&&O&&(O.errorThrown=!0,O.error=e)}var S=function(e){function t(t){var r=e.call(this)||this;return r.isStopped=!1,t?(r.destination=t,f(t)&&t.add(r)):r.destination=C,r}return s(t,e),t.create=function(e,t,r){return new j(e,t,r)},t.prototype.next=function(e){this.isStopped?T(function(e){return k("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?T(k("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?T(_,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(g),j=function(e){function t(t,r,n){var s,o=e.call(this)||this;if(c(t))s=t;else if(t){var i;s=t.next,r=t.error,n=t.complete,o&&y?(i=Object.create(t)).unsubscribe=function(){return o.unsubscribe()}:i=t,s=null==s?void 0:s.bind(i),r=null==r?void 0:r.bind(i),n=null==n?void 0:n.bind(i)}return o.destination={next:s?E(s):w,error:E(null!=r?r:L),complete:n?E(n):w},o}return s(t,e),t}(S);function E(e,t){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{e.apply(void 0,a([],i(t)))}catch(e){v?P(e):x(e)}}}function L(e){throw e}function T(e,t){var r=h;r&&b.setTimeout((function(){return r(e,t)}))}var C={closed:!0,next:w,error:L,complete:w},M="function"==typeof Symbol&&Symbol.observable||"@@observable";function I(e){return e}function N(e){return 0===e.length?I:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var F=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var n,s=this,o=(n=e)&&n instanceof S||function(e){return e&&c(e.next)&&c(e.error)&&c(e.complete)}(n)&&f(n)?e:new j(e,t,r);return function(e){if(v){var t=!O;if(t&&(O={errorThrown:!1,error:null}),e(),t){var r=O,n=r.errorThrown,s=r.error;if(O=null,n)throw s}}else e()}((function(){var e=s,t=e.operator,r=e.source;o.add(t?t.call(o,r):r?s._subscribe(o):s._trySubscribe(o))})),o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=R(t))((function(t,n){var s;s=r.subscribe((function(t){try{e(t)}catch(e){n(e),null==s||s.unsubscribe()}}),n,t)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[M]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return N(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=R(e))((function(e,r){var n;t.subscribe((function(e){return n=e}),(function(e){return r(e)}),(function(){return e(n)}))}))},e.create=function(t){return new e(t)},e}();function R(e){var t;return null!==(t=null!=e?e:A)&&void 0!==t?t:Promise}function $(e){return function(t){if(function(e){return c(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}var z=function(e){function t(t,r,n,s,o){var i=e.call(this,t)||this;return i.onFinalize=o,i._next=r?function(e){try{r(e)}catch(e){t.error(e)}}:e.prototype._next,i._error=s?function(e){try{s(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,i._complete=n?function(){try{n()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,i}return s(t,e),t.prototype.unsubscribe=function(){var t,r=this.closed;e.prototype.unsubscribe.call(this),!r&&(null===(t=this.onFinalize)||void 0===t||t.call(this))},t}(S),B=new F((function(e){return e.complete()})),D=l((function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}})),U=r(625);function W(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?W(Object(r),!0).forEach((function(t){J(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function J(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K(e){return/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u00a1-\uffff][a-z0-9\u00a1-\uffff_-]{0,62})?[a-z0-9\u00a1-\uffff]\.)+(?:[a-z\u00a1-\uffff]{2,}\.?))(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(e)}const Z=()=>{},V=e=>console.error(`Error: ${e}`);function Y(e){var t;const r=e.replace(/^.*[\\/]/,"");return{dir:(null===(t=e.match(/(.*)[/\\]/))||void 0===t?void 0:t[1])??"",out:r}}function H(e){return JSON.stringify([...e.values()].sort(((e,t)=>t.startTime.localeCompare(e.startTime))).slice(0,100))}function G(){var e,r;const n=[],s=new F((e=>n.push(e))),o=new Map;null===(e=(r=U.downloads).setShelfEnabled)||void 0===e||e.call(r,!1),(JSON.parse(localStorage.getItem("history"))??[]).forEach((e=>{"completed"!==e.status&&(e.status="unknown"),o.set(e.gid,e)})),localStorage.setItem("history",H(o)),U.downloads.onChanged.addListener((e=>{n.forEach((t=>t.next(e)))})),U.downloads.onCreated.addListener((function(e){"in_progress"===e.state&&U.storage.sync.get(["motrixAPIkey","extensionStatus","enableNotifications","enableDownloadPrompt","minFileSize","blacklist"]).then((async r=>{if(!r.extensionStatus)return;if(e.fileSize>0&&e.fileSize<1024*r.minFileSize*1024)return;if(r.blacklist.map((t=>e.url.includes(t))).reduce(((e,t)=>e||t),!1))return;if(!r.motrixAPIkey)return void alert("API key not set, please set a random API key by clicking on the extension icon. Open Motrix set the same API Key by visiting Preferences > Advanced > RPC Secret");if(!e.filename){const t=s.pipe((i=t=>t.id===e.id&&t.filename,$((function(e,t){var r=0;e.subscribe(new z(t,(function(e){return i.call(undefined,e,r++)&&t.next(e)})))}))),1<=0?function(){return B}:$((function(e,t){var r=0;e.subscribe(new z(t,(function(e){++r<=1&&(t.next(e),1<=r&&t.complete())})))}))),r=await(n=t,new Promise((function(e,t){var r,s=!1;n.subscribe({next:function(e){r=e,s=!0},error:t,complete:function(){s?e(r):t(new D)}})})));e.filename=r.filename.current}var n,i;const a=await U.downloads.getFileIcon(e.id);e.icon=a,await async function(e){await U.downloads.removeFile(e).then(Z).catch(Z),await U.downloads.cancel(e).then(Z).catch(V),await U.downloads.erase({id:e}).then(Z).catch(V)}(e.id),async function(r){const n={host:"127.0.0.1",port:16800,secure:!1,secret:r.motrixAPIkey,path:"/jsonrpc"},s=new(t())(n);await s.open();let i="";if(K(e.finalUrl))i=e.finalUrl;else{if(!K(e.url))return;i=e.url}let a={};if(e.filename&&(a=q({},Y(e.filename))),e.referrer&&(a=q(q({},a),{},{referer:e.referrer})),r.enableDownloadPrompt){const t=prompt("Do you want to download:",e.filename);if(null==t)return;a=q(q(q({},a),Y(t)),{},{"summary-interval":1})}let c=null;await s.call("addUri",[i],a).then((async t=>{if(c=setInterval((async()=>{const r=await s.call("tellStatus",t);o.set(t,{gid:t,startTime:e.startTime,icon:e.icon,name:a.out??null,path:a.dir??null,status:"downloading",size:e.totalBytes,downloaded:parseInt(r.completedLength)}),localStorage.setItem("history",H(o))}),1e3),s.on("onDownloadStart",(([t])=>{U.browserAction.setIcon({path:"images/baseline_file_download_black_24dp.png"}),o.set(t.gid,{gid:t.gid,startTime:e.startTime,icon:e.icon,name:a.out??null,path:a.dir??null,status:"downloading",size:e.totalBytes,downloaded:0}),localStorage.setItem("history",H(o))})),s.on("onDownloadComplete",(([t])=>{o.set(t.gid,{gid:t.gid,startTime:e.startTime,icon:e.icon,name:a.out??null,path:a.dir??null,status:"completed",size:e.totalBytes,downloaded:e.totalBytes}),localStorage.setItem("history",H(o)),clearInterval(c),0===[...o.values()].filter((e=>"downloading"===e.status)).length&&setTimeout((()=>{0===[...o.values()].filter((e=>"downloading"===e.status)).length&&U.browserAction.setIcon({path:"images/32.png"})}),1e3)})),r.enableNotifications){const e={type:"basic",iconUrl:"images/icon-large.png",title:"Motrix WebExtension",message:"Download started in Motrix download manger"},t=Math.round((new Date).getTime()/1e3).toString();U.notifications.create(t,e),U.notifications.onClicked.addListener((e=>{e===t&&U.tabs.create({url:"motrix://"})}))}})).catch((e=>{console.error(e),alert("Motrix not installed or configured properly, Open Motrix set a API Key by visiting Preferences > Advanced > RPC Secret")}))}(r)}),(async function(e){console.error(`Error: ${e}`)}))}))}U.runtime.onStartup.addListener((function(){G()})),U.runtime.onInstalled.addListener((function(){G()}))})()})();